Ext.define("com.coremedia.personalization.ui.editors.ConditionsEditorBaseBase",function(ConditionsEditorBaseBase){var CONDITIONS_PROPERTY$static="conditions";function ConditionsEditorBaseBase$(config){if(arguments.length<=0)config=null;this.addConditionItems(com.coremedia.ui.util.ArrayUtils.asArray(AS3.getBindable(config,"conditionItems")));this.super$JaJf(config);var conditionsPanelCfg=AS3.cast(com.coremedia.personalization.ui.editors.ConditionsPanel,{});AS3.setBindable(conditionsPanelCfg,"bindTo",
com.coremedia.ui.data.ValueExpressionFactory.create("",this.getInternalModel$JaJf()));AS3.setBindable(conditionsPanelCfg,"propertyName",CONDITIONS_PROPERTY$static);AS3.setBindable(conditionsPanelCfg,"readOnlyPropertyName","readOnly");AS3.setBindable(conditionsPanelCfg,"hidden",true);AS3.setBindable(conditionsPanelCfg,"conditionItems",this.getConditionItems());this.conditionsPanelComponent$JaJf=this.add(conditionsPanelCfg);this.conditionsPanelComponent$JaJf.addListener("modified",AS3.bind(this,"onConditionsChange$JaJf"))}
function getInternalModel(){if(!this.internalModel$JaJf)this.internalModel$JaJf=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean({"readOnly":false});return this.internalModel$JaJf}function initialized(){if(this.rendered)this.initializedAndRendered$JaJf();else this.addListener("afterrender",AS3.bind(this,"initializedAndRendered$JaJf"))}function initializedAndRendered(){this.removeListener("afterrender",AS3.bind(this,"initializedAndRendered$JaJf"));this["getValue"]=AS3.bind(this,
"getValueWhenInitialized");this["setValue"]=AS3.bind(this,"setValueWhenInitialized$JaJf");this.getComponent("loadingInfo").hide();this.conditionsPanelComponent$JaJf.show()}function onConditionsChange(pathExpression){this.fireEvent("change",this)}function getConditionItems(){if(!this.conditionItems$JaJf)this.conditionItems$JaJf=[];return this.conditionItems$JaJf}function addConditionItems(items){if(items)for(var i=0;i<items.length;i++)this.getConditionItems().push(items[i])}function setValue(val){this.setValueWhenInitialized$JaJf(val);
this.initialized$JaJf()}function setValueWhenInitialized(val){var rulesFromXML=com.coremedia.personalization.ui.util.RuleXMLCoDec.rulesFromXML(val);this.getInternalModel$JaJf().set(CONDITIONS_PROPERTY$static,rulesFromXML)}function getValue(){return"NOT_INITIALIZED"}function getValueWhenInitialized(){var conditions=this.getInternalModel$JaJf().get(CONDITIONS_PROPERTY$static);return conditions?com.coremedia.personalization.ui.util.RuleXMLCoDec.xmlFromRules(conditions):null}return{extend:"Ext.panel.Panel",
internalModel$JaJf:null,conditionsPanelComponent$JaJf:null,conditionItems$JaJf:null,constructor:ConditionsEditorBaseBase$,super$JaJf:function(){Ext.panel.Panel.prototype.constructor.apply(this,arguments)},getInternalModel$JaJf:getInternalModel,initialized$JaJf:initialized,initializedAndRendered$JaJf:initializedAndRendered,onConditionsChange$JaJf:onConditionsChange,getConditionItems:getConditionItems,addConditionItems:addConditionItems,setValue:setValue,setValueWhenInitialized$JaJf:setValueWhenInitialized,
getValue:getValue,getValueWhenInitialized:getValueWhenInitialized,requires:["Ext.panel.Panel","com.coremedia.cms.editor.sdk.editorContext","com.coremedia.ui.data.ValueExpressionFactory","com.coremedia.ui.util.ArrayUtils"],uses:["com.coremedia.personalization.ui.editors.ConditionsPanel","com.coremedia.personalization.ui.util.RuleXMLCoDec"]}});Ext.define("com.coremedia.personalization.ui.editors.Condition",function(Condition){return{}});Ext.define("com.coremedia.personalization.ui.editors.ConditionConjunctionPanelBase",function(ConditionConjunctionPanelBase){function activeConditionPanels_(){this.activeConditionPanels$l85u=[]}function activeAnds_(){this.activeAnds$l85u=[]}function ConditionConjunctionPanelBase$(config){if(arguments.length<=0)config=null;this.conditionItems$l85u=AS3.getBindable(config,"conditionItems");this.super$l85u(config);activeConditionPanels_.call(this);activeAnds_.call(this);this.addAndButton$l85u=AS3.as(this.getComponent("andBtn"),
Ext.button.Button)}function addHandler(){this.addCondition();this.fireEvent("modified")}function setDisabled(value){Ext.panel.Panel.prototype.setDisabled.call(this,value);if(this.addAndButton$l85u)this.addAndButton$l85u.setDisabled(value);for(var i=0;i<this.activeConditionPanels$l85u.length;++i)this.activeConditionPanels$l85u[i].setDisabled(value)}function addCondition(property,operator,value){var this$=this;switch(arguments.length){case 0:property=null;case 1:operator=null;case 2:value=null}var config=
AS3.cast(com.coremedia.personalization.ui.editors.ConditionFrame,{});AS3.setBindable(config,"conditionItems",this.conditionItems$l85u);var conditionFrame=new com.coremedia.personalization.ui.editors.ConditionFrame(config);conditionFrame.addListener("deleteCondition",AS3.bind(this,"deleteCondition$l85u"),this);this.activeConditionPanels$l85u.push(conditionFrame);if(this.activeConditionPanels$l85u.length>1)this.addAnd$l85u();this.add(conditionFrame);conditionFrame.setPropertyName(property);conditionFrame.setOperator(operator);
conditionFrame.setPropertyValue(value);conditionFrame.addListener("modified",function(){this$.fireEvent("modified")})}function deleteCondition(condPanel){var index=this.activeConditionPanels$l85u.indexOf(condPanel);var deletedCond=this.activeConditionPanels$l85u.splice(index,1);this.remove(deletedCond[0],true);this.deleteAnd$l85u(index-1);this.fireEvent("conditionRemoved",this)}function addAnd(){var displayFieldCfg=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(displayFieldCfg,"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_conditions_conjunction_and"));this.activeAnds$l85u.push(this.add(displayFieldCfg))}function deleteAnd(index){if(this.activeAnds$l85u.length>0){if(index<0)index=0;var andText=this.activeAnds$l85u.splice(index,1)[0];this.remove(andText,true)}}function getConditions(){var conditions=[];for(var i=0;i<this.activeConditionPanels$l85u.length;++i){var condPanel=this.activeConditionPanels$l85u[i];if(i>0)conditions.push(com.coremedia.personalization.ui.util.SelectionRuleHelper.CON_AND);conditions.push(condPanel.getPropertyName(),
condPanel.getOperator(),condPanel.getPropertyValue())}return conditions}return{extend:"Ext.panel.Panel",addAndButton$l85u:null,conditionItems$l85u:null,constructor:ConditionConjunctionPanelBase$,super$l85u:function(){Ext.panel.Panel.prototype.constructor.apply(this,arguments)},addHandler:addHandler,setDisabled:setDisabled,addCondition:addCondition,deleteCondition$l85u:deleteCondition,addAnd$l85u:addAnd,deleteAnd$l85u:deleteAnd,getConditions:getConditions,requires:["Ext.button.Button","Ext.form.field.Display",
"Ext.panel.Panel","com.coremedia.personalization.ui.Personalization_properties"],uses:["com.coremedia.personalization.ui.editors.ConditionFrame","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionsPanel",function(ConditionsPanel){function ConditionsPanel$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.ConditionsPanelBase,{});var defaults_$1=AS3.cast(ConditionsPanel,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$gdcg(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.ConditionsPanelBase",
alias:"widget.com.coremedia.personalization.ui.config.conditionsPanel",constructor:ConditionsPanel$,super$gdcg:function(){com.coremedia.personalization.ui.editors.ConditionsPanelBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,propertyName:null,readOnlyPropertyName:null,conditionItems:null,deleteHandler:null},requires:["com.coremedia.personalization.ui.editors.ConditionsPanelBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.editors.DeleteContentFromRuleActionBase",function(DeleteContentFromRuleActionBase){function DeleteContentFromRuleActionBase$(config){if(arguments.length<=0)config=null;var bindTo=config["bindTo"];var propertyName=config["propertyName"];this.propertyValueExpression$tPJv=bindTo.extendBy(propertyName);AS3.setBindable(config,"handler",AS3.bind(this,"removeProperty$tPJv"));AS3.setBindable(config,"iconCls",mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_Action_deleteContentFromRule_icon"));AS3.setBindable(config,"text",mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_Action_deleteContentFromRule_text"));AS3.setBindable(config,"tooltip",mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_Action_deleteContentFromRule_tooltip"));this.super$tPJv(config);this.setDisabled(bindTo.extendBy("readOnly").getValue());this.propertyValueExpression$tPJv.addChangeListener(AS3.bind(this,
"updateDisabled$tPJv"))}function updateDisabled(source){this.setDisabled(source.getValue()==null||AS3.as(source.getValue(),Array).length===0)}function removeProperty(){this.propertyValueExpression$tPJv.setValue([])}function removeComponent(comp){Ext.Action.prototype.removeComponent.call(this,comp);if(this.items&&this.items.length===0)this.propertyValueExpression$tPJv&&this.propertyValueExpression$tPJv.removeChangeListener(AS3.bind(this,"updateDisabled$tPJv"))}return{extend:"Ext.Action",propertyValueExpression$tPJv:null,
constructor:DeleteContentFromRuleActionBase$,super$tPJv:function(){Ext.Action.prototype.constructor.apply(this,arguments)},updateDisabled$tPJv:updateDisabled,removeProperty$tPJv:removeProperty,removeComponent:removeComponent,requires:["Ext.Action","com.coremedia.personalization.ui.Personalization_properties","mx.resources.ResourceManager"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionFrameBase",function(ConditionFrameBase){var ITEM_CONDITION_NAME$static="conditionName";var ITEM_PROPERTY_PREFIX$static="propertyPrefix";var ITEM_PROPERTY_NAME$static="propertyName";var ITEM_DEFAULT_FLAG$static="isDefault";var ITEM_ID$static="itemId";function ConditionFrameBase$(config){if(arguments.length<=0)config=null;this.conditionItems$VYh5=AS3.getBindable(config,"conditionItems");this.super$VYh5(config);this.addListener("beforerender",
AS3.bind(this,"initUI"),null,{single:true})}function initUI(){var this$=this;Ext.Component.suspendLayouts();var itemInstances=createItemInstances$static(this.conditionItems$VYh5);var selectionProperties=extractSelectionProperties$static(itemInstances);var comboCfg=AS3.cast(Ext.form.field.ComboBox,{});comboCfg.flex=40;AS3.setBindable(comboCfg,"disabled",this.disabled);comboCfg.itemId="conditionTypeSelector";comboCfg.forceSelection=true;AS3.setBindable(comboCfg,"editable",false);comboCfg.triggerAction=
"all";comboCfg.queryMode="local";comboCfg.allowBlank=false;comboCfg.listConfig={minWidth:250};var arrayStoreCfg=AS3.cast(Ext.data.ArrayStore,{});arrayStoreCfg["id"]=0;AS3.setBindable(arrayStoreCfg,"fields",[ITEM_ID$static,ITEM_CONDITION_NAME$static,ITEM_PROPERTY_PREFIX$static,ITEM_PROPERTY_NAME$static]);AS3.setBindable(arrayStoreCfg,"data",selectionProperties);var sorter=AS3.cast(Ext.util.Sorter,{});AS3.setBindable(sorter,"property",ITEM_CONDITION_NAME$static);AS3.setBindable(sorter,"direction","ASC");
AS3.setBindable(arrayStoreCfg,"sorters",[sorter]);AS3.setBindable(comboCfg,"store",new Ext.data.ArrayStore(arrayStoreCfg));comboCfg.valueField=ITEM_ID$static;AS3.setBindable(comboCfg,"displayField",ITEM_CONDITION_NAME$static);this.conditionTypeSelector$VYh5=this.add(comboCfg);this.conditionTypeSelector$VYh5.addListener("select",AS3.bind(this,"onConditionTypeSelected$VYh5"));this.conditionSwitch$VYh5=new com.coremedia.personalization.ui.editors.ConditionSwitch(itemInstances,{flex:60,height:26,margins:"1 0 0 0",
itemId:"conditionSwitch"});this.conditionSwitch$VYh5.setDisabled(this.disabled);this.add(this.conditionSwitch$VYh5);this.conditionSwitch$VYh5.addListener("modified",function(){this$.fireConditionFrameEvent$VYh5("modified")});var deleteButtonCfg=AS3.cast(com.coremedia.ui.components.IconButton,{});deleteButtonCfg.itemId="deleteFrameButton";AS3.setBindable(deleteButtonCfg,"iconCls",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_deleteCondition_icon"));AS3.setBindable(deleteButtonCfg,
"tooltip",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_deleteCondition_tooltip"));deleteButtonCfg.ariaLabel=deleteButtonCfg.tooltip;AS3.setBindable(deleteButtonCfg,"disabled",this.disabled);AS3.setBindable(deleteButtonCfg,"handler",function(){this$.fireConditionFrameEvent$VYh5("deleteCondition")});this.deleteButton$VYh5=this.add(deleteButtonCfg);for(var i=0;i<itemInstances.length;++i)if(itemInstances[i][ITEM_DEFAULT_FLAG$static]){this.switchToCondition$VYh5(itemInstances[i].id,
itemInstances[i][ITEM_PROPERTY_NAME$static]);this.conditionTypeSelector$VYh5.setValue(itemInstances[i].id)}Ext.Component.resumeLayouts(true)}function fireConditionFrameEvent(eventName){this.fireEvent(eventName,this)}function createItemInstances$static(conditionItems){var itemInstances=[];conditionItems.forEach(function(obj){var inst=Ext.ComponentManager.create(obj,null);if(inst==null)throw new AS3.Error(mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_error_ConditionsFrame_confInstance")+" "+obj.toSource()+". "+mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_ConditionsFrame_confInstance_xtype"));itemInstances.push(inst)});return itemInstances}function extractSelectionProperties$static(itemInstances){var selectionProperties=[];itemInstances.forEach(function(obj){var itemId=obj.id;var itemConditionName=obj[ITEM_CONDITION_NAME$static]||obj["initialConfig"][ITEM_CONDITION_NAME$static];
var itemPropertyPrefix=obj[ITEM_PROPERTY_PREFIX$static]||obj["initialConfig"][ITEM_PROPERTY_PREFIX$static];var itemPropertyName=obj[ITEM_PROPERTY_NAME$static]||obj["initialConfig"][ITEM_PROPERTY_NAME$static];if(itemConditionName==null)throw new AS3.Error(mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_ConditionsFrame_itemConditionName")+" "+obj.toSource());if(itemPropertyPrefix==null&&itemPropertyName==null)throw new AS3.Error(mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_error_ConditionsFrame_itemPropertyPrefix")+" "+obj.toSource());selectionProperties.push([itemId,itemConditionName,itemPropertyPrefix,itemPropertyName])});return selectionProperties}function onConditionTypeSelected(combo,record){var itemId=record.data[ITEM_ID$static];var propertyName=record.data[ITEM_PROPERTY_NAME$static];this.switchToCondition$VYh5(itemId,propertyName);this.fireConditionFrameEvent$VYh5("modified")}function switchToCondition(itemId,propertyName){this.conditionSwitch$VYh5.switchToCondition(itemId);
if(propertyName!=null&&propertyName.length>0)this.conditionSwitch$VYh5.setPropertyName(propertyName)}function setDisabled(value){Ext.container.Container.prototype.setDisabled.call(this,value);if(this.rendered){this.conditionTypeSelector$VYh5.setDisabled(value);this.conditionSwitch$VYh5.setDisabled(value);this.deleteButton$VYh5.setDisabled(value)}}function getPropertyName(){return this.rendered?this.conditionSwitch$VYh5.getPropertyName():null}function getOperator(){return this.rendered?this.conditionSwitch$VYh5.getOperator():
null}function getPropertyValue(){return this.rendered?this.conditionSwitch$VYh5.getPropertyValue():null}function setPropertyName(name){var this$=this;if(this.rendered){this.selectInConditionTypeSelector$VYh5(name);this.conditionSwitch$VYh5.setPropertyName(name)}else this.addListener("afterrender",function(){this$.selectInConditionTypeSelector$VYh5(name);this$.conditionSwitch$VYh5.setPropertyName(name)},null,{single:true})}function selectInConditionTypeSelector(name){if(name==null)return;var valueStore=
AS3.cast(Ext.data.Store,this.conditionTypeSelector$VYh5.getStore());var idx=valueStore.findBy(function(record,id){if(record.data[ITEM_PROPERTY_NAME$static])return name==record.data[ITEM_PROPERTY_NAME$static];else if(record.data[ITEM_PROPERTY_PREFIX$static])return name.match("^"+record.data[ITEM_PROPERTY_PREFIX$static]+".*$");else return false},this,0);if(idx>=0){var record=valueStore.getAt(idx);this.conditionTypeSelector$VYh5.setValue(record.data[ITEM_ID$static]);this.switchToCondition$VYh5(record.data[ITEM_ID$static],
record.data[ITEM_PROPERTY_NAME$static])}else this.conditionSwitch$VYh5.switchToInvalid(name)}function setOperator(op){var this$=this;if(this.rendered)this.conditionSwitch$VYh5.setOperator(op);else this.addListener("afterrender",function(){this$.conditionSwitch$VYh5.setOperator(op)},null,{single:true})}function setPropertyValue(value){var this$=this;if(this.rendered)this.conditionSwitch$VYh5.setPropertyValue(value);else this.addListener("afterrender",function(){this$.conditionSwitch$VYh5.setPropertyValue(value)},
null,{single:true})}return{extend:"Ext.container.Container",mixins:["com.coremedia.personalization.ui.editors.Condition"],conditionTypeSelector$VYh5:null,conditionTypeSelectorWrapper$VYh5:null,conditionSwitch$VYh5:null,deleteButton$VYh5:null,conditionItems$VYh5:null,constructor:ConditionFrameBase$,super$VYh5:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},initUI:initUI,fireConditionFrameEvent$VYh5:fireConditionFrameEvent,onConditionTypeSelected$VYh5:onConditionTypeSelected,
switchToCondition$VYh5:switchToCondition,setDisabled:setDisabled,getPropertyName:getPropertyName,getOperator:getOperator,getPropertyValue:getPropertyValue,setPropertyName:setPropertyName,selectInConditionTypeSelector$VYh5:selectInConditionTypeSelector,setOperator:setOperator,setPropertyValue:setPropertyValue,requires:["AS3.Error","Ext.Component","Ext.ComponentManager","Ext.container.Container","Ext.data.ArrayStore","Ext.data.Store","Ext.form.field.ComboBox","Ext.util.Sorter","com.coremedia.personalization.ui.Personalization_properties",
"com.coremedia.personalization.ui.editors.Condition","com.coremedia.ui.components.IconButton","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.editors.ConditionSwitch"]}});Ext.define("com.coremedia.personalization.ui.editors.RuleListPanelBase",function(RuleListPanelBase){function RuleListPanelBase$(config){if(arguments.length<=0)config=null;this.super$9J9P(config);if(!AS3.getBindable(config,"bindTo"))throw new AS3.Error("com.coremedia.personalization.ui.editors.RuleListPanel "+this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_error_beanValueExpression"));if(!AS3.getBindable(config,"propertyName"))throw new AS3.Error("com.coremedia.personalization.ui.editors.RuleListPanel "+
this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_error_propertyName"));this.readOnlyValueExpression$9J9P=com.coremedia.cms.editor.sdk.util.PropertyEditorUtil.createReadOnlyValueExpression(AS3.getBindable(config,"bindTo"),AS3.getBindable(config,"forceReadOnlyValueExpression"));if(!AS3.getBindable(config,"conditionItems"))throw new AS3.Error("com.coremedia.personalization.ui.editors.RuleListPanel "+this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_error_conditionItems"));this.conditionItems$9J9P=AS3.getBindable(config,"conditionItems");this.allowedContentType$9J9P=AS3.getBindable(config,"allowedContentType");this.showThumbnails$9J9P=AS3.getBindable(config,"showThumbnails");if(!AS3.is(this.conditionItems$9J9P,Array))this.conditionItems$9J9P=[this.conditionItems$9J9P];this.readOnlyValueExpression$9J9P.addChangeListener(AS3.bind(this,"onReadOnlyChanged$9J9P"));this.onReadOnlyChanged$9J9P(this.readOnlyValueExpression$9J9P)}function onReadOnlyChanged(expr){var value=
expr.getValue();if(joo.debug)AS3.trace("propagating readOnly state",value);if(this.itemCollection)this.itemCollection.each(function(rp){if(rp["_ruleBean"])rp["_ruleBean"].set("readOnly",value);return true});if(this.activeRuleEditingField$9J9P)this.activeRuleEditingField$9J9P.setDisabled(value)}function addRuleForContent(content){if(content){var contentId=com.coremedia.ui.util.IdUtil.parseContentId(content.getId());var rule=com.coremedia.personalization.ui.util.SelectionRuleHelper.createContentSelectionRule(contentId,
[]);var rulePanel=this.addRulePanel$9J9P(rule);rulePanel.toggleConditionsPanelCollapsed();this.fireChangeEvent$9J9P()}else if(joo.debug)AS3.trace("[INFO] ignoring rule request for null;")}function fireChangeEvent(){this.fireEvent("change")}function initComponent(){Ext.panel.Panel.prototype.initComponent.call(this)}function moveRule(startPos,endPos){var rp=this.itemCollection.removeAt(startPos);this.itemCollection.insert(endPos,rp);this.fireChangeEvent$9J9P()}function setValue(s){var this$=this;if(this.rendered)this.buildRuleListFromString$9J9P(s);
else com.coremedia.ui.util.EventUtil.invokeLater(function(){this$.buildRuleListFromString$9J9P(s)})}function getValue(){return this.activeRuleEditingField$9J9P!=null?this.activeRuleEditingField$9J9P.getValue():com.coremedia.personalization.ui.util.SelectionRuleHelper.createSelectionRuleList(this.getRules$9J9P())}function buildRuleListFromString(rules){var this$=this;if(joo.debug)AS3.trace("[INFO]: (re)building rule list from ",rules);if(rules)if(!com.coremedia.personalization.ui.util.SelectionRuleHelper.isValidRuleList(rules)){this.removeAll(true);
this.showInTextEditingField$9J9P(rules)}else{var arr=com.coremedia.personalization.ui.util.SelectionRuleHelper.splitRules(rules);Ext.each(arr,function(string,index){return this$.addRulePanel$9J9P(string,index)!=null});var toBeRemoved=this.itemCollection.getRange(arr.length);Ext.each(toBeRemoved,function(cmp){if(joo.debug)AS3.trace("removing rule panel",cmp?cmp.getId():null);return this$.remove(cmp,true)!=null})}else this.removeAll(true)}function showInTextEditingField(rules){var activeRuleEditingDisplayContainerCfg=
AS3.cast(Ext.container.Container,{});AS3.setBindable(activeRuleEditingDisplayContainerCfg,"layout","vbox");var activeRuleEditingDisplayContainer=this.add(activeRuleEditingDisplayContainerCfg);var activeRuleEditingDisplayFieldCfg=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(activeRuleEditingDisplayFieldCfg,"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_ruleParsingError"));this.activeRuleEditingDisplayField$9J9P=activeRuleEditingDisplayContainer.add(activeRuleEditingDisplayFieldCfg);
var activeRuleEditingFieldCfg=AS3.cast(Ext.form.field.TextArea,{});activeRuleEditingFieldCfg.enableKeyEvents=true;AS3.setBindable(activeRuleEditingFieldCfg,"value",rules);AS3.setBindable(activeRuleEditingFieldCfg,"width","100%");AS3.setBindable(activeRuleEditingFieldCfg,"height",200);this.activeRuleEditingField$9J9P=activeRuleEditingDisplayContainer.add(activeRuleEditingFieldCfg);this.activeRuleEditingField$9J9P.addListener("keyup",AS3.bind(this,"fireChangeEvent$9J9P"))}function addRulePanel(rule,
index){var this$=this;if(arguments.length<=1)index=-1;var rp;if(index>-1){rp=AS3.as(this.itemCollection.getAt(index),com.coremedia.personalization.ui.editors.RulePanel);if(rp&&rp["_ruleBean"].get("rule")===rule){if(joo.debug)AS3.trace("re-using rule panel for rule",rule);return rp}else{if(joo.debug)AS3.trace("discarding old rulepanel for rule",rule);this.remove(rp,true)}}if(joo.debug)AS3.trace("creating new rule panel for rule ",rule);var ruleBean=this.beanFromRule$9J9P(rule);this.addRuleBean$9J9P(ruleBean);
var ruleBeanExpr=com.coremedia.ui.data.ValueExpressionFactory.create("",ruleBean);var rulePanelCfg=AS3.cast(com.coremedia.personalization.ui.editors.RulePanel,{});AS3.setBindable(rulePanelCfg,"bindTo",ruleBeanExpr);AS3.setBindable(rulePanelCfg,"contentPropertyName","content");AS3.setBindable(rulePanelCfg,"conditionsPropertyName","conditions");AS3.setBindable(rulePanelCfg,"deleteHandler",function(){this$.deleteRule$9J9P(rp)});AS3.setBindable(rulePanelCfg,"conditionItems",this.conditionItems$9J9P);
AS3.setBindable(rulePanelCfg,"allowedContentType",this.allowedContentType$9J9P);AS3.setBindable(rulePanelCfg,"showThumbnails",this.showThumbnails$9J9P);rp=new com.coremedia.personalization.ui.editors.RulePanel(rulePanelCfg);rp["_ruleBean"]=ruleBean;ruleBean["_rulePanel"]=rp;if(index>-1&&index<this.itemCollection.length){if(joo.debug)AS3.trace("inserting panel for rule",rule,"at index",index);this.insert(index,rp)}else{if(joo.debug)AS3.trace("adding panel for rule",rule);this.add(rp)}return rp}function onRuleDrop(dropPosition,
draggedItem,dropContainer){dropContainer.insert(dropPosition,draggedItem);this.fireChangeEvent$9J9P()}function deleteRule(panel){var this$=this;Ext.MessageBox.buttonText.yes=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_confirm_yes");Ext.MessageBox.buttonText.no=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_confirm_no");Ext.MessageBox.show({title:this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_deleteRule"),msg:this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_confirmDeleteRule"),buttons:Ext.window.MessageBox.YESNO,fn:function(btn,text){if(btn==="yes"){this$.removeRuleBean$9J9P(panel["_ruleBean"]);this$.remove(panel,true);this$.fireChangeEvent$9J9P()}},icon:Ext.window.MessageBox.INFO})}function addRuleBean(bean){bean.addPropertyChangeListener("content",AS3.bind(this,"fireChangeEvent$9J9P"));bean.addPropertyChangeListener("conditions",AS3.bind(this,
"fireChangeEvent$9J9P"))}function removeRuleBean(bean){bean.removePropertyChangeListener("content",AS3.bind(this,"fireChangeEvent$9J9P"));bean.removePropertyChangeListener("conditions",AS3.bind(this,"fireChangeEvent$9J9P"))}function beanFromRule(rule){if(arguments.length<=0)rule="";var ruleBean=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean();var intId=com.coremedia.personalization.ui.util.SelectionRuleHelper.contentIdFromSelectionRule(rule);if(intId>0){var beanUri=com.coremedia.ui.util.IdUtil.formatContentBean(intId);
var bean=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().getRemoteBean(beanUri);ruleBean.set("content",[bean])}else ruleBean.set("content",[]);ruleBean.set("rule",rule);ruleBean.set("conditions",com.coremedia.personalization.ui.util.SelectionRuleHelper.conditionsExprFromSelectionRule(rule));ruleBean.set("readOnly",this.readOnlyValueExpression$9J9P.getValue());return ruleBean}function ruleFromBean(bean){var beanId=com.coremedia.ui.util.IdUtil.MISSING_CONTENT_ID;var content=bean.get("content");
if(content!=null&&content.length>0)beanId=com.coremedia.ui.util.IdUtil.parseContentId(content[0].getId());return com.coremedia.personalization.ui.util.SelectionRuleHelper.createContentSelectionRuleFromConditionsExpr(beanId,bean.get("conditions"))}function getRules(){var this$=this;var rules=[];if(this.itemCollection)this.itemCollection.each(function(rp){var ruleBean=rp["_ruleBean"];var rule=this$.ruleFromBean$9J9P(ruleBean);ruleBean.set("rule",rule);rules.push(rule);return true});return rules}return{extend:"Ext.panel.Panel",
readOnlyValueExpression$9J9P:null,activeRuleEditingField$9J9P:null,activeRuleEditingDisplayField$9J9P:null,conditionItems$9J9P:null,allowedContentType$9J9P:null,showThumbnails$9J9P:false,constructor:RuleListPanelBase$,super$9J9P:function(){Ext.panel.Panel.prototype.constructor.apply(this,arguments)},onReadOnlyChanged$9J9P:onReadOnlyChanged,addRuleForContent:addRuleForContent,fireChangeEvent$9J9P:fireChangeEvent,initComponent:initComponent,moveRule:moveRule,setValue:setValue,getValue:getValue,buildRuleListFromString$9J9P:buildRuleListFromString,
showInTextEditingField$9J9P:showInTextEditingField,addRulePanel$9J9P:addRulePanel,onRuleDrop:onRuleDrop,deleteRule$9J9P:deleteRule,addRuleBean$9J9P:addRuleBean,removeRuleBean$9J9P:removeRuleBean,beanFromRule$9J9P:beanFromRule,ruleFromBean$9J9P:ruleFromBean,getRules$9J9P:getRules,requires:["AS3.Error","AS3.trace","Ext","Ext.container.Container","Ext.form.field.Display","Ext.form.field.TextArea","Ext.panel.Panel","Ext.window.MessageBox","com.coremedia.cms.editor.sdk.editorContext","com.coremedia.cms.editor.sdk.util.PropertyEditorUtil",
"com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.data.ValueExpressionFactory","com.coremedia.ui.util.EventUtil","com.coremedia.ui.util.IdUtil"],uses:["com.coremedia.personalization.ui.editors.RulePanel","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionFrame",function(ConditionFrame){function ConditionFrame$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.ConditionFrameBase,{});var defaults_$1=AS3.cast(ConditionFrame,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var ui_HorizontalSpacingPlugin_25_5_$1=AS3.cast(com.coremedia.ui.plugins.HorizontalSpacingPlugin,{});config_$1.plugins=[ui_HorizontalSpacingPlugin_25_5_$1];
var layout_HBox_29_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_29_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$DxdK(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.ConditionFrameBase",alias:"widget.com.coremedia.personalization.ui.config.conditionFrame",constructor:ConditionFrame$,super$DxdK:function(){com.coremedia.personalization.ui.editors.ConditionFrameBase.prototype.constructor.apply(this,arguments)},config:{conditionItems:null},
requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.editors.ConditionFrameBase","com.coremedia.ui.plugins.HorizontalSpacingPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionConjunctionPanel",function(ConditionConjunctionPanel){function ConditionConjunctionPanel$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.ConditionConjunctionPanelBase,{});var defaults_$1=AS3.cast(ConditionConjunctionPanel,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);config_$1.buttonAlign="left";config_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.PanelSkin.DARK_100.getSkin());
var toolbar_33_5_$1=AS3.cast(Ext.toolbar.Toolbar,{});AS3.setBindable(toolbar_33_5_$1,"dock","bottom");toolbar_33_5_$1["focusableContainer"]=false;toolbar_33_5_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ToolbarSkin.EMBEDDED_FOOTER.getSkin());var button_37_9_$1=AS3.cast(Ext.button.Button,{});button_37_9_$1.itemId="andBtn";button_37_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.SIMPLE.getSkin());AS3.setBindable(button_37_9_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_conditions_and_icon")));AS3.setBindable(button_37_9_$1,"scale","small");AS3.setBindable(button_37_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_conditions_and")));AS3.setBindable(button_37_9_$1,"handler",AS3.bind(this,"addHandler"));toolbar_33_5_$1.items=[button_37_9_$1];config_$1.dockedItems=[toolbar_33_5_$1];var layout_VBox_47_5_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_47_5_$1,
"align","stretch");AS3.setBindable(config_$1,"layout",layout_VBox_47_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$ks87(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.ConditionConjunctionPanelBase",alias:"widget.com.coremedia.personalization.ui.config.conditionConjunctionPanel",constructor:ConditionConjunctionPanel$,super$ks87:function(){com.coremedia.personalization.ui.editors.ConditionConjunctionPanelBase.prototype.constructor.apply(this,arguments)},config:{conditionItems:null},
requires:["Ext.button.Button","Ext.layout.container.VBox","Ext.toolbar.Toolbar","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.editors.ConditionConjunctionPanelBase","com.coremedia.ui.skins.ButtonSkin","com.coremedia.ui.skins.PanelSkin","com.coremedia.ui.skins.ToolbarSkin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.editors.RulePanel",function(RulePanel){function RulePanel$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.RulePanelBase,{});var defaults_$1=AS3.cast(RulePanel,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);config_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ContainerSkin.GRID_200.getSkin());var ui_BindPropertyPlugin_64_5_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,
{});ui_BindPropertyPlugin_64_5_$1.componentProperty="disabled";ui_BindPropertyPlugin_64_5_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy("readOnly");var ui_VerticalSpacingPlugin_66_5_$1=AS3.cast(com.coremedia.ui.plugins.VerticalSpacingPlugin,{});config_$1.plugins=[ui_BindPropertyPlugin_64_5_$1,ui_VerticalSpacingPlugin_66_5_$1];var box_69_5_$1=AS3.cast(Ext.Component,{});box_69_5_$1.itemId="dragbar";box_69_5_$1.cls=net.jangaroo.ext.Exml.asString(RulePanel.DRAGBAR_BLOCK);var pui_RuleContentField_70_5_$1=
AS3.cast(com.coremedia.personalization.ui.editors.RuleContentField,{});AS3.setBindable(pui_RuleContentField_70_5_$1,"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(pui_RuleContentField_70_5_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"contentPropertyName")));AS3.setBindable(pui_RuleContentField_70_5_$1,"showThumbnails",AS3.getBindable(config,"showThumbnails"));AS3.setBindable(pui_RuleContentField_70_5_$1,"allowedContentType",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,
"allowedContentType")));var container_74_5_$1=AS3.cast(Ext.container.Container,{});container_74_5_$1.itemId="controls";AS3.setBindable(container_74_5_$1,"height",25);AS3.setBindable(container_74_5_$1,"layout","hbox");var button_78_9_$1=AS3.cast(Ext.button.Button,{});button_78_9_$1.itemId="collapseButton";AS3.setBindable(button_78_9_$1,"text",net.jangaroo.ext.Exml.asString(com.coremedia.ui.util.AriaUtils.DUMMY_TEXT));button_78_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.SIMPLE.getSkin());
var component_81_9_$1=AS3.cast(Ext.Component,{});component_81_9_$1.flex=1;AS3.setBindable(component_81_9_$1,"height",25);var button_84_9_$1=AS3.cast(Ext.button.Button,{});button_84_9_$1.itemId="deleteButton";button_84_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.LINK.getSkin());AS3.setBindable(button_84_9_$1,"handler",AS3.getBindable(config,"deleteHandler"));AS3.setBindable(button_84_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_rulePanel_deleteRule")));var ui_BindPropertyPlugin_89_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_89_13_$1.componentProperty="hidden";ui_BindPropertyPlugin_89_13_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy("readOnly");button_84_9_$1.plugins=[ui_BindPropertyPlugin_89_13_$1];container_74_5_$1.items=[button_78_9_$1,component_81_9_$1,button_84_9_$1];var pui_ConditionsPanel_95_5_$1=AS3.cast(com.coremedia.personalization.ui.editors.ConditionsPanel,
{});pui_ConditionsPanel_95_5_$1.itemId="conditionsPanel";AS3.setBindable(pui_ConditionsPanel_95_5_$1,"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(pui_ConditionsPanel_95_5_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"conditionsPropertyName")));AS3.setBindable(pui_ConditionsPanel_95_5_$1,"conditionItems",AS3.getBindable(config,"conditionItems"));AS3.setBindable(pui_ConditionsPanel_95_5_$1,"deleteHandler",AS3.getBindable(config,"deleteHandler"));AS3.setBindable(pui_ConditionsPanel_95_5_$1,
"collapsed",true);pui_ConditionsPanel_95_5_$1.header=false;config_$1.items=[box_69_5_$1,pui_RuleContentField_70_5_$1,container_74_5_$1,pui_ConditionsPanel_95_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$fffc(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.RulePanelBase",alias:"widget.com.coremedia.personalization.ui.config.rulePanel",constructor:RulePanel$,super$fffc:function(){com.coremedia.personalization.ui.editors.RulePanelBase.prototype.constructor.apply(this,
arguments)},config:{bindTo:null,showThumbnails:false,contentPropertyName:null,conditionsPropertyName:null,conditionItems:null,deleteHandler:null,allowedContentType:null},statics:{DRAGBAR_BLOCK:"cm-p13n-dragbar"},requires:["Ext.Component","Ext.button.Button","Ext.container.Container","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.editors.RulePanelBase","com.coremedia.ui.plugins.BindPropertyPlugin","com.coremedia.ui.plugins.VerticalSpacingPlugin","com.coremedia.ui.skins.ButtonSkin",
"com.coremedia.ui.skins.ContainerSkin","com.coremedia.ui.util.AriaUtils","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.editors.ConditionsPanel","com.coremedia.personalization.ui.editors.RuleContentField"]}});Ext.define("com.coremedia.personalization.ui.editors.RuleListPanel",function(RuleListPanel){function RuleListPanel$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.RuleListPanelBase,{});var defaults_$1=AS3.cast(RuleListPanel,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"title",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_selectionRuleList_description"));config_$1.header=
false;var ui_BEMPlugin_62_5_$1=AS3.cast(com.coremedia.ui.plugins.BEMPlugin,{});AS3.setBindable(ui_BEMPlugin_62_5_$1,"block",com.coremedia.ui.bem.SeparatorBEMEntities.VERTICAL_SEPARATOR_BLOCK);AS3.setBindable(ui_BEMPlugin_62_5_$1,"defaultElement",com.coremedia.ui.bem.SeparatorBEMEntities.VERTICAL_SEPARATOR_ELEMENT_ITEM);var ui_DraggableItemsPlugin_64_5_$1=AS3.cast(com.coremedia.ui.plugins.DraggableItemsPlugin,{});AS3.setBindable(ui_DraggableItemsPlugin_64_5_$1,"ddGroup",net.jangaroo.ext.Exml.asString(RuleListPanel.RULE_LIST_GROUP));
AS3.setBindable(ui_DraggableItemsPlugin_64_5_$1,"dropHandler",AS3.bind(this,"onRuleDrop"));AS3.setBindable(ui_DraggableItemsPlugin_64_5_$1,"hideGhostWrapper",true);AS3.setBindable(ui_DraggableItemsPlugin_64_5_$1,"itemSelector",net.jangaroo.ext.Exml.asString(com.coremedia.ui.bem.SeparatorBEMEntities.VERTICAL_SEPARATOR_ELEMENT_ITEM.getCSSSelector()));AS3.setBindable(ui_DraggableItemsPlugin_64_5_$1,"handleSelector",net.jangaroo.ext.Exml.asString(com.coremedia.ui.util.BEMUtils.getBlockSelector(com.coremedia.personalization.ui.editors.RulePanel.DRAGBAR_BLOCK)));
AS3.setBindable(ui_DraggableItemsPlugin_64_5_$1,"repairHighlightingColor","ignore");config_$1.plugins=[ui_BEMPlugin_62_5_$1,ui_DraggableItemsPlugin_64_5_$1];var layout_VBox_73_5_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_73_5_$1,"align","stretch");AS3.setBindable(config_$1,"layout",layout_VBox_73_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$6Qje(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.RuleListPanelBase",alias:"widget.com.coremedia.personalization.ui.config.ruleListPanel",
constructor:RuleListPanel$,super$6Qje:function(){com.coremedia.personalization.ui.editors.RuleListPanelBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,forceReadOnlyValueExpression:null,showThumbnails:false,propertyName:null,conditionItems:null,allowedContentType:null},statics:{RULE_LIST_GROUP:"p13nRuleDDGroup"},requires:["Ext.layout.container.VBox","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.editors.RuleListPanelBase","com.coremedia.ui.bem.SeparatorBEMEntities",
"com.coremedia.ui.plugins.BEMPlugin","com.coremedia.ui.plugins.DraggableItemsPlugin","com.coremedia.ui.util.BEMUtils","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.editors.RulePanel"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionsEditorBase",function(ConditionsEditorBase){function ConditionsEditorBase$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.ConditionsEditorBaseBase,{});var defaults_$1=AS3.cast(ConditionsEditorBase,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$KeNu(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.ConditionsEditorBaseBase",
alias:"widget.com.coremedia.personalization.ui.config.conditionsEditorBase",constructor:ConditionsEditorBase$,super$KeNu:function(){com.coremedia.personalization.ui.editors.ConditionsEditorBaseBase.prototype.constructor.apply(this,arguments)},config:{conditionItems:null},requires:["com.coremedia.personalization.ui.editors.ConditionsEditorBaseBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.editors.NoConditionContainer",function(NoConditionContainer){function NoConditionContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(NoConditionContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"layout","anchor");var displayField_35_5_$1=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(displayField_35_5_$1,"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_noRulesAvailable"));var container_37_5_$1=AS3.cast(Ext.container.Container,{});AS3.setBindable(container_37_5_$1,"layout","border");AS3.setBindable(container_37_5_$1,"height",30);var button_40_9_$1=AS3.cast(Ext.button.Button,{});button_40_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.SIMPLE.getSkin());AS3.setBindable(button_40_9_$1,"region","west");AS3.setBindable(button_40_9_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons",
"add")));AS3.setBindable(button_40_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_addCondition")));AS3.setBindable(button_40_9_$1,"handler",AS3.getBindable(config,"addHandler"));var ui_BindPropertyPlugin_46_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_46_13_$1.componentProperty="disabled";ui_BindPropertyPlugin_46_13_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy("readOnly");
button_40_9_$1.plugins=[ui_BindPropertyPlugin_46_13_$1];var component_50_9_$1=AS3.cast(Ext.Component,{});AS3.setBindable(component_50_9_$1,"region","center");AS3.setBindable(component_50_9_$1,"height",30);var button_53_9_$1=AS3.cast(Ext.button.Button,{});button_53_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.SIMPLE.getSkin());AS3.setBindable(button_53_9_$1,"region","east");AS3.setBindable(button_53_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_rulePanel_deleteRule")));AS3.setBindable(button_53_9_$1,"handler",AS3.getBindable(config,"deleteHandler"));AS3.setBindable(button_53_9_$1,"hidden",AS3.getBindable(config,"deleteHandler")==null);var ui_BindPropertyPlugin_59_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_59_13_$1.componentProperty="disabled";ui_BindPropertyPlugin_59_13_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy("readOnly");button_53_9_$1.plugins=[ui_BindPropertyPlugin_59_13_$1];container_37_5_$1.items=
[button_40_9_$1,component_50_9_$1,button_53_9_$1];config_$1.items=[displayField_35_5_$1,container_37_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$DYI9(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.noConditionContainer",constructor:NoConditionContainer$,super$DYI9:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{bindTo:null,addHandler:null,deleteHandler:null},requires:["Ext.Component",
"Ext.button.Button","Ext.container.Container","Ext.form.field.Display","com.coremedia.icons.CoreIcons_properties","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.plugins.BindPropertyPlugin","com.coremedia.ui.skins.ButtonSkin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionsPanelBase",function(ConditionsPanelBase){function conjunctionPanels_(){this.conjunctionPanels$GG_R=[]}function activeOrs_(){this.activeOrs$GG_R=[]}function ConditionsPanelBase$(config){var this$=this;if(arguments.length<=0)config=null;this.super$GG_R(config);conjunctionPanels_.call(this);activeOrs_.call(this);this.conditionItems$GG_R=AS3.as(config["conditionItems"],Array);if(this.conditionItems$GG_R==null)throw new AS3.Error("config.conditionItems must not be null");
this.bindTo$GG_R=AS3.as(config["bindTo"],com.coremedia.ui.data.ValueExpression);if(this.bindTo$GG_R==null)throw new AS3.Error("config.bindTo must not be null");if(config["propertyName"]==null)throw new AS3.Error("config.propertyName must not be null");this.conditionsPropertyExpression$GG_R=this.bindTo$GG_R.extendBy(config["propertyName"]);this.conditionsPropertyExpression$GG_R.addChangeListener(AS3.bind(this,"onConditionsChanged$GG_R"));var contentAreaCfg=AS3.cast(Ext.container.Container,{});AS3.setBindable(contentAreaCfg,
"layout","anchor");this.contentArea$GG_R=this.add(contentAreaCfg);var buttonAreaCfg=AS3.cast(Ext.container.Container,{});AS3.setBindable(buttonAreaCfg,"layout","border");AS3.setBindable(buttonAreaCfg,"height",30);this.buttonArea$GG_R=this.add(buttonAreaCfg);var addConjunctionButtonCfg=AS3.cast(Ext.button.Button,{});addConjunctionButtonCfg.ui=com.coremedia.ui.skins.ButtonSkin.SIMPLE.getSkin();AS3.setBindable(addConjunctionButtonCfg,"region","west");AS3.setBindable(addConjunctionButtonCfg,"iconCls",
this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_conditions_or_icon"));AS3.setBindable(addConjunctionButtonCfg,"text",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_conditions_or"));AS3.setBindable(addConjunctionButtonCfg,"handler",function(b,e){this$.addConjunctionPanel$GG_R();this$.addCondition$GG_R();this$.saveConditions$GG_R()});this.addConjunctionButton$GG_R=this.buttonArea$GG_R.add(addConjunctionButtonCfg);var spacerCfg=
AS3.cast(Ext.Component,{});AS3.setBindable(spacerCfg,"region","center");AS3.setBindable(spacerCfg,"height",30);this.buttonArea$GG_R.add(spacerCfg);this.deleteHandler$GG_R=config["deleteHandler"];if(this.deleteHandler$GG_R!=null){var deleteRuleButtonCfg=AS3.cast(Ext.button.Button,{});AS3.setBindable(deleteRuleButtonCfg,"region","east");AS3.setBindable(deleteRuleButtonCfg,"text",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_rulePanel_deleteRule"));AS3.setBindable(deleteRuleButtonCfg,
"handler",this.deleteHandler$GG_R);this.deleteRuleButton$GG_R=this.buttonArea$GG_R.add(deleteRuleButtonCfg)}var conditions=this.conditionsPropertyExpression$GG_R.getValue();this.initContent$GG_R(conditions);var readOnlyProp=config["readOnlyPropertyName"]?config["readOnlyPropertyName"]:"readOnly"}function onConditionsChanged(expr){var parentContainer=this.up();if(expr.getValue()!=this.lastSavedString$GG_R||expr.getValue()===null)this.initContent$GG_R(expr.getValue())}function initContent(conditions){var conditionsValue=
conditions!=null?conditions:"";this.contentArea$GG_R.removeAll(true);this.conjunctionPanels$GG_R=[];this.activeOrs$GG_R=[];this.noConditionContainer$GG_R=null;this.plainTextEditingField$GG_R=null;if(com.coremedia.personalization.ui.util.SelectionRuleHelper.isValidConditionsExpr(conditionsValue)){var condTokens=com.coremedia.personalization.ui.util.SelectionRuleHelper.conditionsFromConditionsExpr(conditionsValue);var tokenIndex=0;if(condTokens.length>0)this.buttonArea$GG_R.setVisible(true);while(tokenIndex<
condTokens.length)switch(condTokens[tokenIndex]){case com.coremedia.personalization.ui.util.SelectionRuleHelper.CON_AND:tokenIndex++;break;case com.coremedia.personalization.ui.util.SelectionRuleHelper.CON_OR:this.addConjunctionPanel$GG_R();tokenIndex++;break;default:this.addCondition$GG_R(condTokens[tokenIndex++],condTokens[tokenIndex++],condTokens[tokenIndex++])}if(this.conjunctionPanels$GG_R.length<=0)this.addNoConditionContainer$GG_R()}else this.showInTextEditingField$GG_R(conditionsValue)}function showInTextEditingField(conditionsExpr){var this$=
this;var displayFieldCfg=AS3.cast(Ext.form.field.Display,{});displayFieldCfg.hideLabel="true";AS3.setBindable(displayFieldCfg,"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_ruleParsingError"));this.contentArea$GG_R.add(displayFieldCfg);var plainTextEditingFieldCfg=AS3.cast(Ext.form.field.TextArea,{});plainTextEditingFieldCfg.enableKeyEvents=true;AS3.setBindable(plainTextEditingFieldCfg,"value",conditionsExpr);this.plainTextEditingField$GG_R=this.contentArea$GG_R.add(plainTextEditingFieldCfg);
this.plainTextEditingField$GG_R.addListener("keyup",function(){this$.saveConditions$GG_R()});this.buttonArea$GG_R.setVisible(false)}function addCondition(key,op,val){switch(arguments.length){case 0:key=null;case 1:op=null;case 2:val=null}if(this.noConditionContainer$GG_R!=null)this.deleteNoConditionPanel$GG_R();if(this.conjunctionPanels$GG_R.length<=0)this.addConjunctionPanel$GG_R();var conjunctionPanel=this.conjunctionPanels$GG_R[this.conjunctionPanels$GG_R.length-1];conjunctionPanel.addCondition(key,
op,val)}function addConjunctionPanel(){var this$=this;var conditionConjunctionPanelCfg=AS3.cast(com.coremedia.personalization.ui.editors.ConditionConjunctionPanel,{});AS3.setBindable(conditionConjunctionPanelCfg,"conditionItems",this.conditionItems$GG_R);var panel=new com.coremedia.personalization.ui.editors.ConditionConjunctionPanel(conditionConjunctionPanelCfg);panel.addListener("conditionRemoved",function(v){if(panel.getConditions().length<=0)this$.deleteConjunctionPanel$GG_R(v);this$.saveConditions$GG_R()});
panel.addListener("modified",function(v){this$.saveConditions$GG_R()});this.conjunctionPanels$GG_R.push(panel);if(this.conjunctionPanels$GG_R.length>1)this.addOr$GG_R();this.contentArea$GG_R.add(panel)}function deleteConjunctionPanel(panel){var index=this.conjunctionPanels$GG_R.indexOf(panel);var deletedPanel=this.conjunctionPanels$GG_R.splice(index,1);this.contentArea$GG_R.remove(deletedPanel[0],true);this.deleteOr$GG_R(index-1);if(this.conjunctionPanels$GG_R.length<=0)this.addNoConditionContainer$GG_R()}
function addOr(){var orTextCfg=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(orTextCfg,"fieldLabel",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_conditions_conjunction_or"));orTextCfg.labelWidth=20;orTextCfg.labelAlign="right";orTextCfg.labelSeparator="";this.activeOrs$GG_R.push(this.contentArea$GG_R.add(orTextCfg))}function deleteOr(index){if(this.activeOrs$GG_R.length>0){if(index<0)index=0;var orText=this.activeOrs$GG_R.splice(index,1)[0];this.contentArea$GG_R.remove(orText,
true)}}function addNoConditionContainer(){var this$=this;var noConditionContainerCfg=AS3.cast(com.coremedia.personalization.ui.editors.NoConditionContainer,{});AS3.setBindable(noConditionContainerCfg,"bindTo",this.bindTo$GG_R);AS3.setBindable(noConditionContainerCfg,"addHandler",function(){this$.addCondition$GG_R();this$.saveConditions$GG_R()});AS3.setBindable(noConditionContainerCfg,"deleteHandler",this.deleteHandler$GG_R);this.noConditionContainer$GG_R=this.contentArea$GG_R.add(noConditionContainerCfg);
this.buttonArea$GG_R.setVisible(false)}function deleteNoConditionPanel(){if(this.noConditionContainer$GG_R!=null){this.contentArea$GG_R.remove(this.noConditionContainer$GG_R,true);this.noConditionContainer$GG_R=null}this.buttonArea$GG_R.setVisible(true)}function saveConditions(){if(this.plainTextEditingField$GG_R)this.lastSavedString$GG_R=this.plainTextEditingField$GG_R.getValue();else if(this.conjunctionPanels$GG_R.length>0){var conditions=[];for(var i=0;i<this.conjunctionPanels$GG_R.length;++i){if(i>
0)conditions.push(com.coremedia.personalization.ui.util.SelectionRuleHelper.CON_OR);var conjPanel=this.conjunctionPanels$GG_R[i];conditions=conditions.concat(conjPanel.getConditions())}this.lastSavedString$GG_R=com.coremedia.personalization.ui.util.SelectionRuleHelper.createConditionsExpr(conditions)}else this.lastSavedString$GG_R="";this.conditionsPropertyExpression$GG_R.setValue(this.lastSavedString$GG_R);this.fireEvent("modified")}return{extend:"Ext.panel.Panel",bindTo$GG_R:null,conditionsPropertyExpression$GG_R:null,
lastSavedString$GG_R:null,contentArea$GG_R:null,buttonArea$GG_R:null,conditionItems$GG_R:null,noConditionContainer$GG_R:null,plainTextEditingField$GG_R:null,addConjunctionButton$GG_R:null,deleteRuleButton$GG_R:null,deleteHandler$GG_R:null,constructor:ConditionsPanelBase$,super$GG_R:function(){Ext.panel.Panel.prototype.constructor.apply(this,arguments)},onConditionsChanged$GG_R:onConditionsChanged,initContent$GG_R:initContent,showInTextEditingField$GG_R:showInTextEditingField,addCondition$GG_R:addCondition,
addConjunctionPanel$GG_R:addConjunctionPanel,deleteConjunctionPanel$GG_R:deleteConjunctionPanel,addOr$GG_R:addOr,deleteOr$GG_R:deleteOr,addNoConditionContainer$GG_R:addNoConditionContainer,deleteNoConditionPanel$GG_R:deleteNoConditionPanel,saveConditions$GG_R:saveConditions,requires:["AS3.Error","Ext.Component","Ext.button.Button","Ext.container.Container","Ext.form.field.Display","Ext.form.field.TextArea","Ext.panel.Panel","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.data.ValueExpression",
"com.coremedia.ui.skins.ButtonSkin"],uses:["com.coremedia.personalization.ui.editors.ConditionConjunctionPanel","com.coremedia.personalization.ui.editors.NoConditionContainer","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.editors.DeleteContentFromRuleAction",function(DeleteContentFromRuleAction){function DeleteContentFromRuleAction$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.DeleteContentFromRuleActionBase,{});var defaults_$1=AS3.cast(DeleteContentFromRuleAction,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$h5u8(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.DeleteContentFromRuleActionBase",
constructor:DeleteContentFromRuleAction$,super$h5u8:function(){com.coremedia.personalization.ui.editors.DeleteContentFromRuleActionBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,propertyName:null},requires:["com.coremedia.personalization.ui.editors.DeleteContentFromRuleActionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.editors.ConditionSwitch",function(ConditionSwitch){function ConditionSwitch$(conditionItems,layout){var this$=this;var config=Ext.apply({},layout);var defaultItemConfig=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(defaultItemConfig,"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_error_ConditionSwitch_editor"));AS3.setBindable(defaultItemConfig,"width",200);AS3.setBindable(defaultItemConfig,"height",
25);this.defaultItem$EBEj=new Ext.form.field.Display(defaultItemConfig);this.activeItemId$EBEj=this.defaultItem$EBEj;config.items=conditionItems!=null?[this.defaultItem$EBEj].concat(conditionItems):[this.defaultItem$EBEj];config.layout="card";config.layoutConfig=Ext.apply(config.layoutConfig||{},{deferredRender:true});this.super$EBEj(config);this.itemCollection.each(function(obj){obj.addListener("modified",function(){this$.fireEvent("modified")})},this);this.addListener("afterlayout",AS3.bind(this,
"onAfterlayout$EBEj"),this)}function setDisabled(value){Ext.container.Container.prototype.setDisabled.call(this,value);for(var i=0;i<this.itemCollection.length;++i)if(this.itemCollection[i])this.itemCollection[i].setDisabled(value)}function onAfterlayout(container,layout){this.removeListener("afterlayout",AS3.bind(this,"onAfterlayout$EBEj"),this);this.layoutInitialized$EBEj=true;if(this.activeItemId$EBEj!=null)this.setMyActiveItem$EBEj(this.activeItemId$EBEj)}function setMyActiveItem(id){this.activeItemId$EBEj=
id;if(this.layoutInitialized$EBEj){var cardLayout=AS3.as(this.getLayout(),Ext.layout.container.Card);if(cardLayout)cardLayout.setActiveItem(id)}}function switchToCondition(itemId){this.setMyActiveItem$EBEj(itemId);this.activeCondition$EBEj=AS3.as(this.itemCollection.findBy(function(obj){return obj.id==itemId},this),com.coremedia.personalization.ui.editors.Condition)}function switchToInvalid(propertyName){this.defaultItem$EBEj.setValue(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_error_ConditionSwitch_property")+" '"+propertyName+"'");this.setMyActiveItem$EBEj(this.defaultItem$EBEj.getId());this.invalidPropertyName$EBEj=propertyName;this.activeCondition$EBEj=null}function getActiveCondition(){return this.activeCondition$EBEj}function getPropertyName(){return this.activeCondition$EBEj!=null?this.activeCondition$EBEj.getPropertyName():this.invalidPropertyName$EBEj}function setPropertyName(name){if(this.activeCondition$EBEj!=null)this.activeCondition$EBEj.setPropertyName(name)}
function getOperator(){return this.activeCondition$EBEj!=null?this.activeCondition$EBEj.getOperator():com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_OPERATOR}function setOperator(op){if(this.activeCondition$EBEj!=null)this.activeCondition$EBEj.setOperator(op)}function getPropertyValue(){return this.activeCondition$EBEj!=null?this.activeCondition$EBEj.getPropertyValue():com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE}function setPropertyValue(value){if(this.activeCondition$EBEj!=
null)this.activeCondition$EBEj.setPropertyValue(value)}return{extend:"Ext.container.Container",mixins:["com.coremedia.personalization.ui.editors.Condition"],defaultItem$EBEj:null,activeItemId$EBEj:null,activeCondition$EBEj:null,invalidPropertyName$EBEj:null,layoutInitialized$EBEj:false,constructor:ConditionSwitch$,super$EBEj:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},setDisabled:setDisabled,onAfterlayout$EBEj:onAfterlayout,setMyActiveItem$EBEj:setMyActiveItem,
switchToCondition:switchToCondition,switchToInvalid:switchToInvalid,getActiveCondition:getActiveCondition,getPropertyName:getPropertyName,setPropertyName:setPropertyName,getOperator:getOperator,setOperator:setOperator,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,requires:["Ext","Ext.container.Container","Ext.form.field.Display","Ext.layout.container.Card","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.editors.Condition"],uses:["com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.editors.RulePanelBase",function(RulePanelBase){function RulePanelBase$(config){if(arguments.length<=0)config=null;this.super$Xd9N(config);this.bindTo$Xd9N=config["bindTo"];this.dragbar$Xd9N=this.getComponent("dragbar");this.controls$Xd9N=AS3.as(this.getComponent("controls"),Ext.container.Container);this.collapseButton$Xd9N=AS3.as(this.controls$Xd9N.getComponent("collapseButton"),Ext.button.Button);this.deleteButton$Xd9N=AS3.as(this.controls$Xd9N.getComponent("deleteButton"),
Ext.button.Button);this.conditionsPanel$Xd9N=AS3.as(this.getComponent("conditionsPanel"),Ext.panel.Panel);this.collapseButton$Xd9N.setHandler(AS3.bind(this,"onCollapseButtonPressed$Xd9N"),this);this.collapsedStatus$Xd9N()}function onCollapseButtonPressed(){this.toggleConditionsPanelCollapsed()}function collapseConditionsPanel(){if(!AS3.getBindable(this.conditionsPanel$Xd9N,"collapsed","DUMMY"))this.toggleConditionsPanelCollapsed()}function expandConditionsPanel(){if(AS3.getBindable(this.conditionsPanel$Xd9N,
"collapsed","DUMMY"))this.toggleConditionsPanelCollapsed()}function toggleConditionsPanelCollapsed(){this.conditionsPanel$Xd9N.toggleCollapse();this.collapseButton$Xd9N.setText(AS3.getBindable(this.conditionsPanel$Xd9N,"collapsed","DUMMY")?this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_rulePanel_expand"):this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_rulePanel_collapse"));var rulesAreReadOnly=this.bindTo$Xd9N.extendBy("readOnly").getValue();
this.deleteButton$Xd9N.setVisible(AS3.getBindable(this.conditionsPanel$Xd9N,"collapsed","DUMMY")&&!rulesAreReadOnly);this.collapsedStatus$Xd9N();var computedWidth=this.up().getWidth();this.setWidth(computedWidth)}function collapsedStatus(){if(AS3.getBindable(this.conditionsPanel$Xd9N,"collapsed","DUMMY")){this.conditionsPanel$Xd9N.up().removeCls("rule-panel-expanded");this.collapseButton$Xd9N.setIconCls(this.resourceManager.getString("com.coremedia.icons.CoreIcons","arrow_right"));this.collapseButton$Xd9N.setText(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_rulePanel_expand"))}else{this.conditionsPanel$Xd9N.up().addCls("rule-panel-expanded");this.collapseButton$Xd9N.setIconCls(this.resourceManager.getString("com.coremedia.icons.CoreIcons","arrow_down"));this.collapseButton$Xd9N.setText(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_rulePanel_collapse"))}}function beforeDestroy(){var ruleBean=AS3.as(this["_ruleBean"],Ext.util.Observable);if(ruleBean){if(joo.debug)AS3.trace("purging listeners for ruleBean of rulePanel",
this.getId());ruleBean.clearListeners()}Ext.container.Container.prototype.beforeDestroy.call(this)}return{extend:"Ext.container.Container",dragbar$Xd9N:null,controls$Xd9N:null,collapseButton$Xd9N:null,deleteButton$Xd9N:null,conditionsPanel$Xd9N:null,bindTo$Xd9N:null,constructor:RulePanelBase$,super$Xd9N:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},onCollapseButtonPressed$Xd9N:onCollapseButtonPressed,collapseConditionsPanel:collapseConditionsPanel,expandConditionsPanel:expandConditionsPanel,
toggleConditionsPanelCollapsed:toggleConditionsPanelCollapsed,collapsedStatus$Xd9N:collapsedStatus,beforeDestroy:beforeDestroy,requires:["AS3.trace","Ext.button.Button","Ext.container.Container","Ext.panel.Panel","Ext.util.Observable","com.coremedia.icons.CoreIcons_properties","com.coremedia.personalization.ui.Personalization_properties"]}});Ext.define("com.coremedia.personalization.ui.editors.RuleContentField",function(RuleContentField){function RuleContentField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(RuleContentField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var layout_HBox_43_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_43_5_$1);var ui_HorizontalSpacingPlugin_46_5_$1=AS3.cast(com.coremedia.ui.plugins.HorizontalSpacingPlugin,
{});config_$1.plugins=[ui_HorizontalSpacingPlugin_46_5_$1];var editor_SingleLinkField_49_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.SingleLinkField,{});AS3.setBindable(editor_SingleLinkField_49_5_$1,"linkContentType",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"allowedContentType")));editor_SingleLinkField_49_5_$1.flex=1;AS3.setBindable(editor_SingleLinkField_49_5_$1,"valueExpression",AS3.getBindable(config,"bindTo").extendBy(AS3.getBindable(config,"propertyName")));AS3.setBindable(editor_SingleLinkField_49_5_$1,
"showThumbnails",AS3.getBindable(config,"showThumbnails"));var ui_IconButton_54_5_$1=AS3.cast(com.coremedia.ui.components.IconButton,{});var pui_DeleteContentFromRuleAction_56_9_$1=AS3.cast(com.coremedia.personalization.ui.editors.DeleteContentFromRuleAction,{});AS3.setBindable(pui_DeleteContentFromRuleAction_56_9_$1,"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(pui_DeleteContentFromRuleAction_56_9_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));
ui_IconButton_54_5_$1.baseAction=new com.coremedia.personalization.ui.editors.DeleteContentFromRuleAction(pui_DeleteContentFromRuleAction_56_9_$1);var ui_BindPropertyPlugin_60_9_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_60_9_$1.componentProperty="hidden";ui_BindPropertyPlugin_60_9_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy("readOnly");ui_IconButton_54_5_$1.plugins=[ui_BindPropertyPlugin_60_9_$1];config_$1.items=[editor_SingleLinkField_49_5_$1,ui_IconButton_54_5_$1];
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$aVrV(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.ruleContentField",constructor:RuleContentField$,super$aVrV:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{bindTo:null,showThumbnails:false,propertyName:null,allowedContentType:null},requires:["Ext.container.Container","Ext.layout.container.HBox","com.coremedia.cms.editor.sdk.premular.fields.SingleLinkField",
"com.coremedia.ui.components.IconButton","com.coremedia.ui.plugins.BindPropertyPlugin","com.coremedia.ui.plugins.HorizontalSpacingPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.editors.DeleteContentFromRuleAction"]}});Ext.define("com.coremedia.personalization.ui.editors.RuleListEditor",function(RuleListEditor){function RuleListEditor$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.panel.Panel,{});var defaults_$1=AS3.cast(RuleListEditor,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"title",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_selectionRuleList_description"));config_$1.header=false;var layout_Anchor_133_5_$1=
AS3.cast(Ext.layout.container.Anchor,{});layout_Anchor_133_5_$1.anchor="100%";AS3.setBindable(config_$1,"layout",layout_Anchor_133_5_$1);var ui_BEMPlugin_136_5_$1=AS3.cast(com.coremedia.ui.plugins.BEMPlugin,{});AS3.setBindable(ui_BEMPlugin_136_5_$1,"block",com.coremedia.ui.bem.LinkListBEMEntities.BLOCK);AS3.setBindable(ui_BEMPlugin_136_5_$1,"modifier",this.getModifierVE$Vgo9(config));config_$1.plugins=[ui_BEMPlugin_136_5_$1];var panel_140_5_$1=AS3.cast(Ext.panel.Panel,{});panel_140_5_$1.itemId="loadingInfo";
var displayField_142_9_$1=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(displayField_142_9_$1,"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_loadingInfo"));panel_140_5_$1.items=[displayField_142_9_$1];var pui_RuleListPanel_146_5_$1=AS3.cast(com.coremedia.personalization.ui.editors.RuleListPanel,{});pui_RuleListPanel_146_5_$1.itemId=net.jangaroo.ext.Exml.asString(RuleListEditor.RULE_LIST_PANEL_ITEM_ID);AS3.setBindable(pui_RuleListPanel_146_5_$1,
"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(pui_RuleListPanel_146_5_$1,"forceReadOnlyValueExpression",AS3.getBindable(config,"forceReadOnlyValueExpression"));AS3.setBindable(pui_RuleListPanel_146_5_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));AS3.setBindable(pui_RuleListPanel_146_5_$1,"allowedContentType",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"allowedContentType")));AS3.setBindable(pui_RuleListPanel_146_5_$1,"showThumbnails",
AS3.getBindable(config,"showThumbnails"));AS3.setBindable(pui_RuleListPanel_146_5_$1,"conditionItems",AS3.getBindable(config,"conditionItems"));var ui_BEMMixin_154_9_$1=AS3.cast(com.coremedia.ui.plugins.BEMMixin,{});AS3.setBindable(ui_BEMMixin_154_9_$1,"bemElement",com.coremedia.ui.bem.LinkListBEMEntities.ELEMENT_LIST);delete ui_BEMMixin_154_9_$1["xtype"];delete ui_BEMMixin_154_9_$1["xclass"];net.jangaroo.ext.Exml.apply(pui_RuleListPanel_146_5_$1,ui_BEMMixin_154_9_$1);var ui_BindBlobPropertyPlugin_157_9_$1=
AS3.cast(com.coremedia.ui.plugins.BindBlobPropertyPlugin,{});ui_BindBlobPropertyPlugin_157_9_$1.bindTo=this.getPropertiesVE$Vgo9(config);AS3.setBindable(ui_BindBlobPropertyPlugin_157_9_$1,"transformer",com.coremedia.personalization.ui.util.RuleXMLCoDec.rulesFromXML);AS3.setBindable(ui_BindBlobPropertyPlugin_157_9_$1,"reverseTransformer",com.coremedia.personalization.ui.util.RuleXMLCoDec.xmlFromRules);pui_RuleListPanel_146_5_$1.plugins=[ui_BindBlobPropertyPlugin_157_9_$1];pui_RuleListPanel_146_5_$1["plugins$at"]=
net.jangaroo.ext.Exml.APPEND;config_$1.items=[panel_140_5_$1,pui_RuleListPanel_146_5_$1];var editor_LinkListDropArea_164_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.LinkListDropArea,{});AS3.setBindable(editor_LinkListDropArea_164_5_$1,"ddGroups",["ContentDD","ContentLinkDD"]);AS3.setBindable(editor_LinkListDropArea_164_5_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_dropZone_icon")));AS3.setBindable(editor_LinkListDropArea_164_5_$1,
"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_dropZone")));AS3.setBindable(editor_LinkListDropArea_164_5_$1,"appendOnDrop",true);AS3.setBindable(editor_LinkListDropArea_164_5_$1,"handler",function(){com.coremedia.cms.editor.sdk.editorContext.getCollectionViewManager().openRepository()});AS3.setBindable(editor_LinkListDropArea_164_5_$1,"dock","bottom");editor_LinkListDropArea_164_5_$1.itemId="ruleListDropBox";AS3.setBindable(editor_LinkListDropArea_164_5_$1,
"hidden",true);var ui_BEMMixin_173_9_$1=AS3.cast(com.coremedia.ui.plugins.BEMMixin,{});AS3.setBindable(ui_BEMMixin_173_9_$1,"bemElement",com.coremedia.ui.bem.LinkListBEMEntities.ELEMENT_TAIL);delete ui_BEMMixin_173_9_$1["xtype"];delete ui_BEMMixin_173_9_$1["xclass"];net.jangaroo.ext.Exml.apply(editor_LinkListDropArea_164_5_$1,ui_BEMMixin_173_9_$1);var editor_BindDisablePlugin_176_9_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.plugins.BindDisablePlugin,{});editor_BindDisablePlugin_176_9_$1.bindTo=
AS3.getBindable(config,"bindTo");AS3.setBindable(editor_BindDisablePlugin_176_9_$1,"forceReadOnlyValueExpression",AS3.getBindable(config,"forceReadOnlyValueExpression"));editor_LinkListDropArea_164_5_$1.plugins=[editor_BindDisablePlugin_176_9_$1];editor_LinkListDropArea_164_5_$1["plugins$at"]=net.jangaroo.ext.Exml.APPEND;var editor_MemoryLinkListWrapper_180_9_$1=AS3.cast(com.coremedia.cms.editor.sdk.util.MemoryLinkListWrapper,{});AS3.setBindable(editor_MemoryLinkListWrapper_180_9_$1,"linksVE",this.getRuleForContentVE$Vgo9());
AS3.setBindable(editor_MemoryLinkListWrapper_180_9_$1,"linkTypeName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"allowedContentType")));AS3.setBindable(editor_LinkListDropArea_164_5_$1,"linkListWrapper",new com.coremedia.cms.editor.sdk.util.MemoryLinkListWrapper(editor_MemoryLinkListWrapper_180_9_$1));config_$1.dockedItems=[editor_LinkListDropArea_164_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$Vgo9(config_$1)}function getRuleForContentVE(){var this$=this;if(!this.ruleForContentVE$Vgo9){this.ruleForContentVE$Vgo9=
com.coremedia.ui.data.ValueExpressionFactory.createFromValue([]);this.ruleForContentVE$Vgo9.addChangeListener(function(){var contentsToAdd=AS3.as(this$.ruleForContentVE$Vgo9.getValue(),Array);if(contentsToAdd&&contentsToAdd.length>0){var ruleListPanel=AS3.as(this$.queryById(RuleListEditor.RULE_LIST_PANEL_ITEM_ID),com.coremedia.personalization.ui.editors.RuleListPanel);contentsToAdd.forEach(function(content){ruleListPanel.addRuleForContent(content)});this$.ruleForContentVE$Vgo9.setValue([])}})}return this.ruleForContentVE$Vgo9}
function getPropertiesVE(config){if(!this.propertiesVE$Vgo9)this.propertiesVE$Vgo9=AS3.getBindable(config,"bindTo").extendBy("properties",AS3.getBindable(config,"propertyName"));return this.propertiesVE$Vgo9}function getModifierVE(config){var this$=this;if(!this.modifierVE$Vgo9)this.modifierVE$Vgo9=com.coremedia.ui.data.ValueExpressionFactory.createFromFunction(function(){var ve=this$.getPropertiesVE$Vgo9(config);if(ve.getValue()===undefined)return undefined;var blob=AS3.as(ve.getValue(),com.coremedia.ui.data.impl.BlobImpl);
if(!blob)return[com.coremedia.ui.bem.LinkListBEMEntities.MODIFIER_EMPTY];if(!blob.isLoaded()){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(blob,"data");blob.loadData();return[com.coremedia.ui.bem.LinkListBEMEntities.MODIFIER_EMPTY]}else{var rulesString=com.coremedia.personalization.ui.util.RuleXMLCoDec.rulesFromXML(AS3.as(blob.getData(),String));if(!rulesString)return[com.coremedia.ui.bem.LinkListBEMEntities.MODIFIER_EMPTY]}return[]});return this.modifierVE$Vgo9}return{extend:"Ext.panel.Panel",
alias:"widget.com.coremedia.personalization.ui.config.ruleListEditor",ruleForContentVE$Vgo9:null,propertiesVE$Vgo9:null,modifierVE$Vgo9:null,constructor:RuleListEditor$,super$Vgo9:function(){Ext.panel.Panel.prototype.constructor.apply(this,arguments)},getRuleForContentVE$Vgo9:getRuleForContentVE,getPropertiesVE$Vgo9:getPropertiesVE,getModifierVE$Vgo9:getModifierVE,config:{bindTo:null,forceReadOnlyValueExpression:null,showThumbnails:false,propertyName:null,conditionItems:null,allowedContentType:null},
statics:{RULE_LIST_PANEL_ITEM_ID:"ruleListPanel"},requires:["Ext.form.field.Display","Ext.layout.container.Anchor","Ext.panel.Panel","com.coremedia.cms.editor.sdk.editorContext","com.coremedia.cms.editor.sdk.premular.fields.LinkListDropArea","com.coremedia.cms.editor.sdk.premular.fields.plugins.BindDisablePlugin","com.coremedia.cms.editor.sdk.util.MemoryLinkListWrapper","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.bem.LinkListBEMEntities","com.coremedia.ui.data.ValueExpressionFactory",
"com.coremedia.ui.data.dependencies.DependencyTracker","com.coremedia.ui.data.impl.BlobImpl","com.coremedia.ui.plugins.BEMMixin","com.coremedia.ui.plugins.BEMPlugin","com.coremedia.ui.plugins.BindBlobPropertyPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.editors.RuleListPanel","com.coremedia.personalization.ui.util.RuleXMLCoDec"]}});Ext.define("com.coremedia.personalization.ui.condition.EnumConditionBase",function(EnumConditionBase){var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN_OR_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN,
com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN_OR_EQUAL]}function EnumConditionBase$(config){var this$=this;if(arguments.length<=0)config=null;if(AS3.getBindable(config,"value")==null||AS3.getBindable(config,"value").length<=0)throw new AS3.Error(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_error_EnumCondition_configValue"));var operators=config["operators"];var operator=config["operator"];var opSelector=this.initOpSelector(operators,
config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,com.coremedia.personalization.ui.condition.AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES);this.super$Qcw_(config);this.addOpSelector$Qcw_(opSelector,operators,operator);var values=config["value"];var valueSelectorCfg=AS3.cast(com.coremedia.ui.components.LocalComboBox,{});valueSelectorCfg.itemId="valueSelector";valueSelectorCfg.flex=30;valueSelectorCfg.listConfig={minWidth:100};AS3.setBindable(valueSelectorCfg,"emptyText",
AS3.getBindable(config,"valueEmptyText")!=null?AS3.getBindable(config,"valueEmptyText"):com.coremedia.personalization.ui.condition.AbstractConditionBase.VALUE_EMPTY_TEXT);valueSelectorCfg.forceSelection=true;valueSelectorCfg.allowBlank=false;valueSelectorCfg.validator=function(v){for(var i=0;i<values.length;i++)if(values[i][1]==v)return true;return this$.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_error_EnumCondition_validValue")};var arrayStoreCfg=AS3.cast(Ext.data.ArrayStore,
{});arrayStoreCfg["id"]=0;AS3.setBindable(arrayStoreCfg,"fields",["myId","displayText"]);AS3.setBindable(arrayStoreCfg,"data",values);AS3.setBindable(valueSelectorCfg,"store",new Ext.data.ArrayStore(arrayStoreCfg));valueSelectorCfg.valueField="myId";AS3.setBindable(valueSelectorCfg,"displayField","displayText");this.valueSelector$Qcw_=this.add(valueSelectorCfg);this.valueSelector$Qcw_.addListener("change",function(){this$.fireEvent("modified")});this.valueSelector$Qcw_.addListener("select",function(){this$.fireEvent("modified")});
this.setPropertyValue(values[0][0]);if(AS3.getBindable(config,"suffixText")!=null){var suffixTextCfg=AS3.cast(Ext.form.field.Display,{});suffixTextCfg.itemId="suffixText";AS3.setBindable(suffixTextCfg,"value",config["suffixText"]);this.add(suffixTextCfg)}}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):OPERATORS$static;this.on("afterrender",
function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function getPropertyValue(){var v=this.valueSelector$Qcw_.getValue();return v!=null&&v.toString().length>0?v:com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE}function setPropertyValue(v){this.valueSelector$Qcw_.setValue(v==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE?
null:v)}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",valueSelector$Qcw_:null,constructor:EnumConditionBase$,super$Qcw_:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$Qcw_:addOpSelector,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{OPERATORS:undefined,__initStatics__:function(){OPERATORS$static_()}},requires:["AS3.Error","Ext.data.ArrayStore","Ext.form.field.Display",
"com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.LocalComboBox"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.FloatConditionBase",function(FloatConditionBase){function static$0(){Ext.form.field.VTypes["floatConditionValueVal"]=/^\d+(\.\d+)?$/;Ext.form.field.VTypes["floatConditionValueMask"]=/[0-9.]/;Ext.form.field.VTypes["floatConditionValueText"]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_valueText");Ext.form.field.VTypes["floatConditionValue"]=function(v){return Ext.form.field.VTypes["floatConditionValueVal"].test(v)}}
var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN_OR_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN_OR_EQUAL]}function FloatConditionBase$(config){var this$=this;if(arguments.length<=
0)config=null;var operators=config["operators"];var operator=config["operator"];var opSelector=this.initOpSelector(operators,config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,com.coremedia.personalization.ui.condition.AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES);this.super$zfGz(config);this.addOpSelector$zfGz(opSelector,operators,operator);var valueFieldConf=AS3.cast(com.coremedia.ui.components.StatefulTextField,{});valueFieldConf.itemId="valueField";valueFieldConf.flex=
30;AS3.setBindable(valueFieldConf,"emptyText",config["valueEmptyText"]!=null?config["valueEmptyText"]:com.coremedia.personalization.ui.condition.AbstractConditionBase.VALUE_EMPTY_TEXT);valueFieldConf.allowBlank=false;valueFieldConf.vtype=config["valueVType"]!=null?config["valueVType"]:"floatConditionValue";valueFieldConf.enableKeyEvents=true;this.valueField$zfGz=new com.coremedia.ui.components.StatefulTextField(valueFieldConf);this.add(this.valueField$zfGz);this.valueField$zfGz.addListener("keyup",
function(){this$.fireEvent("modified")});this.setPropertyValue(config["valueText"]);if(config["suffixText"]!=null){var displayfieldConf;displayfieldConf.itemId="suffixText";AS3.setBindable(displayfieldConf,"value",config["suffixText"]);this.add(new Ext.form.field.Display(displayfieldConf))}}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):
OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function getPropertyValue(){var v=this.valueField$zfGz.getValue();return v?v:com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE}function setPropertyValue(v){this.valueField$zfGz.setValue(v==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE?
null:v)}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",valueField$zfGz:null,constructor:FloatConditionBase$,super$zfGz:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$zfGz:addOpSelector,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{OPERATORS:undefined,__initStatics__:function(){static$0();OPERATORS$static_()}},requires:["Ext.form.field.Display","Ext.form.field.VTypes",
"com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.StatefulTextField","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.BooleanCondition",function(BooleanCondition){function BooleanCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.BooleanConditionBase,{});var defaults_$1=AS3.cast(BooleanCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_41_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_41_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$ZWF0(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.BooleanConditionBase",alias:"widget.com.coremedia.personalization.ui.config.booleanCondition",constructor:BooleanCondition$,super$ZWF0:function(){com.coremedia.personalization.ui.condition.BooleanConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,checkedByDefault:null,text:null},requires:["Ext.layout.container.HBox",
"com.coremedia.personalization.ui.condition.BooleanConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.DateCondition",function(DateCondition){function DateCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.DateConditionBase,{});var defaults_$1=AS3.cast(DateCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_67_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_67_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$bZf0(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.DateConditionBase",alias:"widget.com.coremedia.personalization.ui.config.dateCondition",constructor:DateCondition$,super$bZf0:function(){com.coremedia.personalization.ui.condition.DateConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,isDefault:false,operatorEmptyText:null,operatorNames:null,operator:null,valueText:null,
dateEmptyText:null,dateVType:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.DateConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.AbstractCondition",function(AbstractCondition){function AbstractCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.AbstractConditionBase,{});var defaults_$1=AS3.cast(AbstractCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var ui_HorizontalSpacingPlugin_15_5_$1=AS3.cast(com.coremedia.ui.plugins.HorizontalSpacingPlugin,{});config_$1.plugins=[ui_HorizontalSpacingPlugin_15_5_$1];
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$NAhC(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.AbstractConditionBase",alias:"widget.com.coremedia.personalization.ui.config.abstractCondition",constructor:AbstractCondition$,super$NAhC:function(){com.coremedia.personalization.ui.condition.AbstractConditionBase.prototype.constructor.apply(this,arguments)},requires:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.ui.plugins.HorizontalSpacingPlugin",
"net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.DateTimeCondition",function(DateTimeCondition){function DateTimeCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.DateTimeConditionBase,{});var defaults_$1=AS3.cast(DateTimeCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_76_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",
layout_HBox_76_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$UCDp(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.DateTimeConditionBase",alias:"widget.com.coremedia.personalization.ui.config.dateTimeCondition",constructor:DateTimeCondition$,super$UCDp:function(){com.coremedia.personalization.ui.condition.DateTimeConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,isDefault:false,operatorEmptyText:null,operatorNames:null,
operator:null,valueText:null,dateEmptyText:null,dateVType:null,timeEmptyText:null,timeVType:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.DateTimeConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.StringConditionBase",function(StringConditionBase){var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_CONTAINS]}function StringConditionBase$(config){var this$=this;if(arguments.length<=0)config=null;var operators=config["operators"];
var operator=config["operator"];var opSelector=this.initOpSelector(operators,config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,com.coremedia.personalization.ui.condition.AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES);this.super$l$pk(config);this.addOpSelector$l$pk(opSelector,operators,operator);var valueFieldCfg=AS3.cast(com.coremedia.ui.components.StatefulTextField,{});valueFieldCfg.itemId="valueField";valueFieldCfg.flex=30;AS3.setBindable(valueFieldCfg,"emptyText",
AS3.getBindable(config,"valueEmptyText")!=null?AS3.getBindable(config,"valueEmptyText"):com.coremedia.personalization.ui.condition.AbstractConditionBase.VALUE_EMPTY_TEXT);valueFieldCfg.allowBlank=false;valueFieldCfg.vtype=config["valueVType"];valueFieldCfg.enableKeyEvents=true;this.valueField$l$pk=this.add(valueFieldCfg);this.valueField$l$pk.addListener("keyup",function(){this$.fireEvent("modified")});this.valueField$l$pk.setValue(config["valueText"]);if(AS3.getBindable(config,"suffixText")!=null){var suffixTextCfg=
AS3.cast(Ext.form.field.Display,{});suffixTextCfg.itemId="suffixText";AS3.setBindable(suffixTextCfg,"value",AS3.getBindable(config,"suffixText"));this.add(suffixTextCfg)}}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});
opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function getPropertyValue(){return'"'+this.valueField$l$pk.getValue()+'"'}function setPropertyValue(v){if(v!=null&&v.length>=2)this.valueField$l$pk.setValue(v.substr(1,v.length-2))}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",valueField$l$pk:null,constructor:StringConditionBase$,super$l$pk:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,
arguments)},addOpSelector$l$pk:addOpSelector,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{OPERATORS:undefined,__initStatics__:function(){OPERATORS$static_()}},requires:["Ext.form.field.Display","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.StatefulTextField"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.IntegerConditionBase",function(IntegerConditionBase){function static$0(){Ext.form.field.VTypes["integerConditionValueVal"]=/^\d+$/;Ext.form.field.VTypes["integerConditionValueMask"]=/[0-9]/;Ext.form.field.VTypes["integerConditionValueText"]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_valueText_int");Ext.form.field.VTypes["integerConditionValue"]=function(v){return Ext.form.field.VTypes["integerConditionValueVal"].test(v)}}
function IntegerConditionBase$(config){if(arguments.length<=0)config=null;if(config["valueVType"]==null)config["valueVType"]="integerConditionValue";this.super$XFrR(config)}return{extend:"com.coremedia.personalization.ui.condition.FloatCondition",constructor:IntegerConditionBase$,super$XFrR:function(){com.coremedia.personalization.ui.condition.FloatCondition.prototype.constructor.apply(this,arguments)},statics:{__initStatics__:function(){static$0()}},requires:["Ext.form.field.VTypes","com.coremedia.personalization.ui.Personalization_properties",
"com.coremedia.personalization.ui.condition.FloatCondition","mx.resources.ResourceManager"]}});Ext.define("com.coremedia.personalization.ui.condition.PercentageKeywordCondition",function(PercentageKeywordCondition){function PercentageKeywordCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.PercentageKeywordConditionBase,{});var defaults_$1=AS3.cast(PercentageKeywordCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$8hcP(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.PercentageKeywordConditionBase",
alias:"widget.com.coremedia.personalization.ui.config.percentageKeywordCondition",constructor:PercentageKeywordCondition$,super$8hcP:function(){com.coremedia.personalization.ui.condition.PercentageKeywordConditionBase.prototype.constructor.apply(this,arguments)},config:{operators:null},requires:["com.coremedia.personalization.ui.condition.PercentageKeywordConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.OperatorSelector",function(OperatorSelector){var OPERATOR_NAMES$static;function OPERATOR_NAMES$static_(){OPERATOR_NAMES$static={}}function static$0(){OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_less");OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN_OR_EQUAL]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_less_equal");OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_equal");OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_op_not_equal");OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN_OR_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_greater_equal");OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_greater");OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_CONTAINS]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_contains")}function OperatorSelector$(usedOperators,operatorNames,operatorEmptyText){var this$=this;operatorNames=operatorNames!==undefined?operatorNames:{};var operatorArray=createOperators$static(usedOperators,operatorNames);var superConfig=AS3.cast(com.coremedia.ui.components.LocalComboBox,{});superConfig.itemId="operatorSelector";superConfig.flex=30;superConfig.listConfig={minWidth:130};
AS3.setBindable(superConfig,"emptyText",operatorEmptyText!=null?operatorEmptyText:this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_op_operator"));superConfig.forceSelection=true;superConfig.allowBlank=false;superConfig.validator=function(v){for(var i=0;i<operatorArray.length;i++)if(operatorArray[i][1]==v)return true;return this$.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_op_invalid")};var arrayStoreCfg=AS3.cast(Ext.data.ArrayStore,
{});arrayStoreCfg["id"]=0;AS3.setBindable(arrayStoreCfg,"fields",["myId","displayText"]);AS3.setBindable(arrayStoreCfg,"data",operatorArray);AS3.setBindable(superConfig,"store",new Ext.data.ArrayStore(arrayStoreCfg));superConfig.valueField="myId";AS3.setBindable(superConfig,"displayField","displayText");AS3.setBindable(superConfig,"encodeItems",true);this.super$z5AG(superConfig);if(operatorArray.length>0)this.setValue(operatorArray[0]);this.addListener("change",AS3.bind(this,"onModified$z5AG"));this.addListener("select",
AS3.bind(this,"onModified$z5AG"))}function onModified(){this.fireEvent("modified")}function createOperators$static(usedOperators,operatorNames){operatorNames=operatorNames!==undefined?operatorNames:{};var operatorArray=new Array;for(var i=0;i<usedOperators.length;i++){var op=usedOperators[i];var opName=OPERATOR_NAMES$static[op];if(operatorNames!=null&&operatorNames[op]!=null)opName=operatorNames[op];var entry=[op,opName];operatorArray.push(entry)}return operatorArray}return{extend:"com.coremedia.ui.components.LocalComboBox",
constructor:OperatorSelector$,super$z5AG:function(){com.coremedia.ui.components.LocalComboBox.prototype.constructor.apply(this,arguments)},onModified$z5AG:onModified,statics:{OPERATOR_NAMES:undefined,__initStatics__:function(){OPERATOR_NAMES$static_();static$0()}},requires:["Ext.data.ArrayStore","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.components.LocalComboBox","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.BooleanPropertiesCondition",function(BooleanPropertiesCondition){function BooleanPropertiesCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.BooleanPropertiesConditionBase,{});var defaults_$1=AS3.cast(BooleanPropertiesCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_69_5_$1=AS3.cast(Ext.layout.container.HBox,
{});AS3.setBindable(config_$1,"layout",layout_HBox_69_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$vdMD(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.BooleanPropertiesConditionBase",alias:"widget.com.coremedia.personalization.ui.config.booleanPropertiesCondition",constructor:BooleanPropertiesCondition$,super$vdMD:function(){com.coremedia.personalization.ui.condition.BooleanPropertiesConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,
propertyPrefix:null,isDefault:false,operatorEmptyText:null,operatorNames:null,operator:null,propertyEmptyText:null,properties:null,suffixText:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.BooleanPropertiesConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.SegmentCondition",function(SegmentCondition){function SegmentCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.SegmentConditionBase,{});var defaults_$1=AS3.cast(SegmentCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_73_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_73_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$bWqL(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.SegmentConditionBase",alias:"widget.com.coremedia.personalization.ui.config.segmentCondition",constructor:SegmentCondition$,super$bWqL:function(){com.coremedia.personalization.ui.condition.SegmentConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyPrefix:null,isDefault:false,operatorEmptyText:null,operatorNames:null,operator:null,
segmentEmptyText:null,suffixText:null,paths:null,docType:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.SegmentConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.IntegerCondition",function(IntegerCondition){function IntegerCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.IntegerConditionBase,{});var defaults_$1=AS3.cast(IntegerCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$YqTg(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.IntegerConditionBase",
alias:"widget.com.coremedia.personalization.ui.config.integerCondition",constructor:IntegerCondition$,super$YqTg:function(){com.coremedia.personalization.ui.condition.IntegerConditionBase.prototype.constructor.apply(this,arguments)},requires:["com.coremedia.personalization.ui.condition.IntegerConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.TimeConditionBase",function(TimeConditionBase){var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]}var TIME_OPERATOR_NAMES$static;function TIME_OPERATOR_NAMES$static_(){TIME_OPERATOR_NAMES$static={}}function static$0(){TIME_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_time_less");TIME_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_time_greater")}function TimeConditionBase$(config){var this$=this;if(arguments.length<=0)config=null;var operators=config["operators"];var operator=config["operator"];
var opSelector=this.initOpSelector(null,AS3.getBindable(config,"operatorNames"),AS3.getBindable(config,"operatorEmptyText"),operator,OPERATORS$static,TIME_OPERATOR_NAMES$static);this.super$ktno(config);this.addOpSelector$ktno(opSelector,operators,operator);var timeFieldCfg=AS3.cast(com.coremedia.ui.components.StatefulTimeField,{});timeFieldCfg.itemId="timeField";timeFieldCfg.flex=30;timeFieldCfg.listConfig={minWidth:90};AS3.setBindable(timeFieldCfg,"minValue",Ext.Date.parse("0:00 AM","g:i A"));AS3.setBindable(timeFieldCfg,
"maxValue",Ext.Date.parse("11:59 PM","g:i A"));timeFieldCfg.increment=30;timeFieldCfg.format=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_time_format");this.timeField$ktno=this.add(timeFieldCfg);this.timeField$ktno.addListener("change",function(){this$.fireEvent("modified")});this.timeField$ktno.addListener("select",function(){this$.fireEvent("modified")});if(AS3.getBindable(config,"suffixText")!=null){var displayFieldCfg=AS3.cast(Ext.form.field.Display,
{});displayFieldCfg.itemId="suffixText";AS3.setBindable(displayFieldCfg,"value",AS3.getBindable(config,"suffixText"));this.add(displayFieldCfg)}this.setPropertyValue(config["valueText"])}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});
opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function getPropertyValue(){var t=this.timeField$ktno.getValue();return Ext.Date.format(t,"H:i:s")}function setPropertyValue(v){var d=Ext.Date.parse(v,"H:i:s");if(d==null)d=new Date;this.timeField$ktno.setValue(d)}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",timeField$ktno:null,constructor:TimeConditionBase$,
super$ktno:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$ktno:addOpSelector,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{OPERATORS:undefined,TIME_OPERATOR_NAMES:undefined,__initStatics__:function(){OPERATORS$static_();TIME_OPERATOR_NAMES$static_();static$0()}},requires:["Ext.Date","Ext.form.field.Display","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition",
"com.coremedia.ui.components.StatefulTimeField","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.EnumCondition",function(EnumCondition){function EnumCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.EnumConditionBase,{});var defaults_$1=AS3.cast(EnumCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_76_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_76_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$Jk9D(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.EnumConditionBase",alias:"widget.com.coremedia.personalization.ui.config.enumCondition",constructor:EnumCondition$,super$Jk9D:function(){com.coremedia.personalization.ui.condition.EnumConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,isDefault:false,operatorEmptyText:null,operatorNames:null,operators:null,operator:null,
valueEmptyText:null,valueText:null,value:null,suffixText:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.EnumConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.SegmentConditionBase",function(SegmentConditionBase){var DEFAULT_DOCTYPE$static="CMSegment";var DEFAULT_PATH$static="/System/personalization/segments";var SEGMENTS_EMPTY_TEXT$static="segment";var KEY_PATTERN$static;function KEY_PATTERN$static_(){KEY_PATTERN$static=new RegExp("^([a-zA-Z_][a-zA-Z_0-9]*\\.)?"+com.coremedia.personalization.ui.util.RuleXMLCoDec.INTERNAL_CONTENT_ID_PREFIX+"(\\d+)$")}var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=
[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL]}var SEGMENT_OPERATOR_NAMES$static;function SEGMENT_OPERATOR_NAMES$static_(){SEGMENT_OPERATOR_NAMES$static={}}function static$0(){SEGMENT_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_segment_is");SEGMENT_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_segment_is_not")}function SegmentConditionBase$(config){if(arguments.length<=0)config=null;if(AS3.getBindable(config,"propertyPrefix")==null)throw new AS3.Error("config.propertyPrefix must not be null");this.propertyPrefix$3lM6=AS3.getBindable(config,"propertyPrefix").length>0?AS3.getBindable(config,"propertyPrefix")+".":"";this.initSegmentSelector$3lM6(AS3.getBindable(config,"segmentEmptyText"),
AS3.getBindable(config,"paths"),AS3.getBindable(config,"docType"));var operators=config["operators"];var operator=config["operator"];var opSelector=this.initOpSelector(null,AS3.getBindable(config,"operatorNames"),AS3.getBindable(config,"operatorEmptyText"),operator,OPERATORS$static,com.coremedia.personalization.ui.condition.AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES);this.super$3lM6(config);this.addOpSelector$3lM6(opSelector,operators,operator);this.add(this.segmentSelector$3lM6);if(config["suffixText"]!=
null){var suffixTextCfg=AS3.cast(Ext.form.field.Display,{});suffixTextCfg.itemId="suffixText";AS3.setBindable(suffixTextCfg,"value",AS3.getBindable(config,"suffixText"));this.add(suffixTextCfg)}}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",
function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function addPath(path,suffix){if(arguments.length<=1)suffix="";this.segmentSelector$3lM6.addPath(path,suffix)}function removePath(path){this.segmentSelector$3lM6.removePath(path)}function clearPaths(){this.segmentSelector$3lM6.clearPaths()}function initSegmentSelector(emptyText,paths,docType){var this$=
this;var contentSelectorCfg=AS3.cast(com.coremedia.personalization.ui.plugin.ContentSelector,{});contentSelectorCfg.itemId="segmentSelector";contentSelectorCfg.flex=30;contentSelectorCfg.listConfig={minWidth:200};AS3.setBindable(contentSelectorCfg,"emptyText",emptyText!=null?emptyText:SEGMENTS_EMPTY_TEXT$static);contentSelectorCfg.forceSelection=true;contentSelectorCfg.typeAhead=true;contentSelectorCfg.allowBlank=false;contentSelectorCfg.triggerAction="all";contentSelectorCfg.queryMode="local";AS3.setBindable(contentSelectorCfg,
"paths",paths||DEFAULT_PATH$static);AS3.setBindable(contentSelectorCfg,"docType",docType||DEFAULT_DOCTYPE$static);this.segmentSelector$3lM6=new com.coremedia.personalization.ui.plugin.ContentSelector(contentSelectorCfg);this.segmentSelector$3lM6.addListener("change",function(){this$.fireEvent("modified")});this.segmentSelector$3lM6.addListener("select",function(combo,record,index){this$.fireEvent("modified")});this.segmentSelector$3lM6.getStore().addListener("datachanged",AS3.bind(this,"validateStore$3lM6"));
this.segmentSelector$3lM6.addListener("blur",AS3.bind(this,"validateStore$3lM6"));this.segmentSelector$3lM6.addListener("afterrender",AS3.bind(this,"validateStore$3lM6"))}function validateStore(){var this$=this;var value=this.segmentSelector$3lM6.getValue();var numericId=com.coremedia.ui.util.IdUtil.parseContentId(value);if(numericId>0){var bean=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().getRemoteBean(com.coremedia.ui.util.IdUtil.formatContentBean(numericId));bean.load(function(){if(this$.segmentSelector$3lM6.getStore().find(this$.segmentSelector$3lM6.valueField,
value)==-1){this$.segmentSelector$3lM6.setRawValue(Ext.util.Format.htmlDecode(bean.get("name")));this$.segmentSelector$3lM6.markInvalid(this$.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_warning_invalid_removed"))}})}}function getPropertyName(){var v=this.segmentSelector$3lM6.getValue();var result=this.propertyPrefix$3lM6+com.coremedia.personalization.ui.util.RuleXMLCoDec.INTERNAL_CONTENT_ID_PREFIX;if(v)return result+com.coremedia.ui.util.IdUtil.parseContentId(v);
return result+com.coremedia.ui.util.IdUtil.MISSING_CONTENT_ID}function setPropertyName(name){var match=KEY_PATTERN$static.exec(name);if(match&&match[1]==this.propertyPrefix$3lM6&&match[2]!=com.coremedia.ui.util.IdUtil.MISSING_CONTENT_ID)this.segmentSelector$3lM6.setValue(com.coremedia.ui.util.IdUtil.formatContentId(match[2]));else this.segmentSelector$3lM6.clearValue()}function getPropertyValue(){return"true"}function setPropertyValue(v){if(v!==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE&&
v!=="true")throw AS3.cast(AS3.Error,"SegmentCondition does not support 'false' as a value. Instead, use '!\x3d true' in your conditions.");}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",propertyPrefix$3lM6:"",segmentSelector$3lM6:null,constructor:SegmentConditionBase$,super$3lM6:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$3lM6:addOpSelector,addPath:addPath,removePath:removePath,clearPaths:clearPaths,
initSegmentSelector$3lM6:initSegmentSelector,validateStore$3lM6:validateStore,getPropertyName:getPropertyName,setPropertyName:setPropertyName,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{KEY_PATTERN:undefined,OPERATORS:undefined,SEGMENT_OPERATOR_NAMES:undefined,__initStatics__:function(){KEY_PATTERN$static_();OPERATORS$static_();SEGMENT_OPERATOR_NAMES$static_();static$0()}},requires:["AS3.Error","Ext.form.field.Display","Ext.util.Format","com.coremedia.cms.editor.sdk.editorContext",
"com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.util.IdUtil","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.plugin.ContentSelector","com.coremedia.personalization.ui.util.RuleXMLCoDec","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.TimeCondition",function(TimeCondition){function TimeCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.TimeConditionBase,{});var defaults_$1=AS3.cast(TimeCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_71_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_71_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$4ke1(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.TimeConditionBase",alias:"widget.com.coremedia.personalization.ui.config.timeCondition",constructor:TimeCondition$,super$4ke1:function(){com.coremedia.personalization.ui.condition.TimeConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,isDefault:false,operatorEmptyText:null,operatorNames:null,operator:null,valueText:null,
timeEmptyText:null,timeVType:null,suffixText:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.TimeConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.BooleanPropertiesConditionBase",function(BooleanPropertiesConditionBase){var PROPERTY_EMPTY_TEXT$static="property";var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL]}var OPERATOR_DISPLAY_NAMES$static;function OPERATOR_DISPLAY_NAMES$static_(){OPERATOR_DISPLAY_NAMES$static={}}function static$0(){OPERATOR_DISPLAY_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_booleanProperties_is");OPERATOR_DISPLAY_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_booleanProperties_isnot")}function BooleanPropertiesConditionBase$(config){if(arguments.length<=0)config=null;var operators=config["operators"];var operator=
config["operator"];var opSelector=this.initOpSelector(null,config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,OPERATOR_DISPLAY_NAMES$static);this.super$Xc7_(config);this.addOpSelector$Xc7_(opSelector,operators,operator);this.propertyPrefix$Xc7_=config["propertyPrefix"];if(this.propertyPrefix$Xc7_==null)throw new AS3.Error("config.propertyPrefix must not be null");if(this.propertyPrefix$Xc7_!=null&&this.propertyPrefix$Xc7_.charAt(this.propertyPrefix$Xc7_.length-1)==".")this.propertyPrefix$Xc7_=
this.propertyPrefix$Xc7_.substring(0,this.propertyPrefix$Xc7_.length-1);this.initValueCombo$Xc7_(config["properties"],config["propertyEmptyText"]);if(config["suffixText"]!=null){var displayFieldCfg=AS3.cast(Ext.form.field.Display,{});displayFieldCfg.itemId="suffixText";AS3.setBindable(displayFieldCfg,"value",config["suffixText"]);this.add(displayFieldCfg)}}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):
OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function initValueCombo(values,valueEmptyText){var this$=this;var valueSelectorConf=AS3.cast(com.coremedia.ui.components.StatefulComboBox,{});valueSelectorConf.flex=30;valueSelectorConf.listConfig={minWidth:150};AS3.setBindable(valueSelectorConf,
"emptyText",valueEmptyText!=null?valueEmptyText:PROPERTY_EMPTY_TEXT$static);valueSelectorConf.forceSelection=false;valueSelectorConf.typeAhead=true;valueSelectorConf.triggerAction="all";valueSelectorConf.queryMode="local";valueSelectorConf.allowBlank=false;var arrayStoreCfg=AS3.cast(Ext.data.ArrayStore,{});arrayStoreCfg["id"]=0;AS3.setBindable(arrayStoreCfg,"fields",["myId","displayText"]);AS3.setBindable(arrayStoreCfg,"data",values);AS3.setBindable(valueSelectorConf,"store",new Ext.data.ArrayStore(arrayStoreCfg));
valueSelectorConf.valueField="myId";AS3.setBindable(valueSelectorConf,"displayField","displayText");valueSelectorConf.itemId="valueSelector";this.valueSelector$Xc7_=new com.coremedia.ui.components.StatefulComboBox(valueSelectorConf);this.add(this.valueSelector$Xc7_);this.valueSelector$Xc7_.addListener("change",function(){this$.fireEvent("modified")});this.valueSelector$Xc7_.addListener("select",function(){this$.fireEvent("modified")});this.valueSelector$Xc7_.setValue(values[0][0])}function stripPrefix(s){if(this.propertyPrefix$Xc7_==
null||s==null)return s;return s.indexOf(this.propertyPrefix$Xc7_)==0?s.substring(this.propertyPrefix$Xc7_.length+1):s}function prependPrefix(s){return this.propertyPrefix$Xc7_+"."+(s?s:"")}function getPropertyName(){return this.prependPrefix$Xc7_(this.valueSelector$Xc7_.getValue())}function setPropertyName(name){this.valueSelector$Xc7_.setValue(this.stripPrefix$Xc7_(name))}function getPropertyValue(){return"true"}function setPropertyValue(value){if(value!==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE&&
value!=="true")throw AS3.cast(AS3.Error,"BooleanPropertiesCondition does not support 'false' as a value. Instead, use '!\x3d true' in your conditions.");}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",propertyPrefix$Xc7_:"",valueSelector$Xc7_:null,constructor:BooleanPropertiesConditionBase$,super$Xc7_:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$Xc7_:addOpSelector,initValueCombo$Xc7_:initValueCombo,
stripPrefix$Xc7_:stripPrefix,prependPrefix$Xc7_:prependPrefix,getPropertyName:getPropertyName,setPropertyName:setPropertyName,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{OPERATORS:undefined,OPERATOR_DISPLAY_NAMES:undefined,__initStatics__:function(){OPERATORS$static_();OPERATOR_DISPLAY_NAMES$static_();static$0()}},requires:["AS3.Error","Ext.data.ArrayStore","Ext.form.field.Display","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition",
"com.coremedia.ui.components.StatefulComboBox","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.StringCondition",function(StringCondition){function StringCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.StringConditionBase,{});var defaults_$1=AS3.cast(StringCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_71_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_71_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$WmXz(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.StringConditionBase",alias:"widget.com.coremedia.personalization.ui.config.stringCondition",constructor:StringCondition$,super$WmXz:function(){com.coremedia.personalization.ui.condition.StringConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,isDefault:false,operatorEmptyText:null,operators:null,operatorNames:null,operator:null,
valueEmptyText:null,valueText:null,suffixText:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.StringConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.KeywordCondition",function(KeywordCondition){function KeywordCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.KeywordConditionBase,{});var defaults_$1=AS3.cast(KeywordCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"width",400);AS3.setBindable(config_$1,"height",25);var layout_HBox_88_5_$1=AS3.cast(Ext.layout.container.HBox,{});
AS3.setBindable(config_$1,"layout",layout_HBox_88_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$gRiV(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.KeywordConditionBase",alias:"widget.com.coremedia.personalization.ui.config.keywordCondition",constructor:KeywordCondition$,super$gRiV:function(){com.coremedia.personalization.ui.condition.KeywordConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyPrefix:null,isDefault:false,
keywordEmptyText:null,keywordText:null,keywordVType:null,operatorEmptyText:null,operatorNames:null,operator:null,valueEmptyText:null,valueText:null,valueVType:null,suffixText:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.KeywordConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.FloatCondition",function(FloatCondition){function FloatCondition$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.condition.FloatConditionBase,{});var defaults_$1=AS3.cast(FloatCondition,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"height",25);var layout_HBox_89_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_89_5_$1);
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$ZvzC(config_$1)}return{extend:"com.coremedia.personalization.ui.condition.FloatConditionBase",alias:"widget.com.coremedia.personalization.ui.config.floatCondition",constructor:FloatCondition$,super$ZvzC:function(){com.coremedia.personalization.ui.condition.FloatConditionBase.prototype.constructor.apply(this,arguments)},config:{conditionName:null,propertyName:null,isDefault:false,operatorEmptyText:null,operatorNames:null,operators:null,operator:null,
valueEmptyText:null,valueText:null,valueVType:null,suffixText:null},requires:["Ext.layout.container.HBox","com.coremedia.personalization.ui.condition.FloatConditionBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.condition.BooleanConditionBase",function(BooleanConditionBase){function BooleanConditionBase$(config){if(arguments.length<=0)config=null;this.super$XPwn(config);if(config["propertyName"]==null)throw AS3.cast(AS3.Error,"BooleanCondition: Config field 'propertyName' must be null or undefined!");this.setPropertyName(config["propertyName"]);if(config["checkedByDefault"]==null)throw AS3.cast(AS3.Error,"BooleanCondition: Config field 'checkedByDefault' must be defined with a boolean value!");
this.checkedByDefault$XPwn=String(config["checkedByDefault"]).toLowerCase()=="true";if(config["text"]!=null){var displayFieldCfg=AS3.cast(Ext.form.field.Display,{});displayFieldCfg.itemId="text";AS3.setBindable(displayFieldCfg,"value",config["text"]);this.add(displayFieldCfg)}this.initPropertyCheckbox$XPwn()}function initPropertyCheckbox(){var this$=this;var checkBoxConf=AS3.cast(com.coremedia.ui.components.StatefulCheckbox,{});checkBoxConf.checked=this.checkedByDefault$XPwn;checkBoxConf.inputType=
"checkbox";checkBoxConf.flex=30;checkBoxConf.itemId="checkbox";this.checkbox$XPwn=new com.coremedia.ui.components.StatefulCheckbox(checkBoxConf);this.add(this.checkbox$XPwn);this.checkbox$XPwn.addListener("change",function(){this$.fireEvent("modified")})}function getPropertyValue(){return"true"}function setPropertyValue(value){if(value!==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE&&value!=="true")throw AS3.cast(AS3.Error,"BooleanCondition does not support 'false' as a value. Instead, use '!\x3d true' in your conditions.");
}function setOperator(op){if(op==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_OPERATOR)this.checkbox$XPwn.setValue(this.checkedByDefault$XPwn);else this.checkbox$XPwn.setValue(com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL==op)}function getOperator(){return this.checkbox$XPwn.checked?com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL:com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",
checkbox$XPwn:null,checkedByDefault$XPwn:false,constructor:BooleanConditionBase$,super$XPwn:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},initPropertyCheckbox$XPwn:initPropertyCheckbox,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,setOperator:setOperator,getOperator:getOperator,requires:["AS3.Error","Ext.form.field.Display","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.StatefulCheckbox"],
uses:["com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.PercentageKeywordConditionBase",function(PercentageKeywordConditionBase){function static$0(){Ext.form.field.VTypes["PercentageKeywordConditionValueVal"]=/^((100)|(\d{1,2}))$/;Ext.form.field.VTypes["PercentageKeywordConditionValueMask"]=/[0-9]/;Ext.form.field.VTypes["PercentageKeywordConditionValueText"]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_percentage_value");Ext.form.field.VTypes["PercentageKeywordConditionValue"]=
function(v){return Ext.form.field.VTypes["PercentageKeywordConditionValueVal"].test(v)}}function PercentageKeywordConditionBase$(config){if(arguments.length<=0)config=null;AS3.setBindable(config,"valueVType","PercentageKeywordConditionValue");AS3.setBindable(config,"suffixText","%");this.super$gS0A(config)}function getPropertyValue(){var v=com.coremedia.personalization.ui.condition.KeywordCondition.prototype.getPropertyValue.call(this);if(v!=com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE){var floatNumber=
Number(com.coremedia.personalization.ui.condition.KeywordCondition.prototype.getPropertyValue.call(this))*.01;return floatNumber.toFixed(2)}else return v}function setPropertyValue(value){if(value!=com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE){var percentage=Number(value)*100;com.coremedia.personalization.ui.condition.KeywordCondition.prototype.setPropertyValue.call(this,percentage.toFixed(0))}else com.coremedia.personalization.ui.condition.KeywordCondition.prototype.setPropertyValue.call(this,
value)}return{extend:"com.coremedia.personalization.ui.condition.KeywordCondition",constructor:PercentageKeywordConditionBase$,super$gS0A:function(){com.coremedia.personalization.ui.condition.KeywordCondition.prototype.constructor.apply(this,arguments)},getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{__initStatics__:function(){static$0()}},requires:["Ext.form.field.VTypes","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.KeywordCondition",
"mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.KeywordConditionBase",function(KeywordConditionBase){function static$0(){Ext.form.field.VTypes["keywordConditionKeywordVal"]=/^[a-zA-Z_][a-zA-Z_0-9.]*$/;Ext.form.field.VTypes["keywordConditionKeywordMask"]=/[a-zA-Z_0-9.]/;Ext.form.field.VTypes["keywordConditionKeywordText"]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_keywordText");Ext.form.field.VTypes["keywordConditionKeyword"]=
function(v){return Ext.form.field.VTypes["keywordConditionKeywordVal"].test(v)};Ext.form.field.VTypes["keywordConditionValueVal"]=/^\d+(\.\d+)?$/;Ext.form.field.VTypes["keywordConditionValueMask"]=/[0-9.]/;Ext.form.field.VTypes["keywordConditionValueText"]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_error_valueText");Ext.form.field.VTypes["keywordConditionValue"]=function(v){return Ext.form.field.VTypes["keywordConditionValueVal"].test(v)}}
var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN_OR_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN_OR_EQUAL]}var KEYWORD_EMPTY_TEXT$static;function KEYWORD_EMPTY_TEXT$static_(){KEYWORD_EMPTY_TEXT$static=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_keyword")}var VALUE_EMPTY_TEXT$static;function VALUE_EMPTY_TEXT$static_(){VALUE_EMPTY_TEXT$static=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_value")}function KeywordConditionBase$(config){var this$=this;if(arguments.length<=0)config=null;var operators=config["operators"];var operator=config["operator"];var opSelector=
this.initOpSelector(null,config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,com.coremedia.personalization.ui.condition.AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES);this.super$A8wG(config);this.propertyPrefix$A8wG=config["propertyPrefix"];if(this.propertyPrefix$A8wG==null)throw new AS3.Error(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_error_propertyPrefix"));if(this.propertyPrefix$A8wG!=null&&this.propertyPrefix$A8wG.charAt(this.propertyPrefix$A8wG.length-
1)==".")this.propertyPrefix$A8wG=this.propertyPrefix$A8wG.substring(0,this.propertyPrefix$A8wG.length-1);var keywordFieldCfg=AS3.cast(com.coremedia.ui.components.StatefulTextField,{});keywordFieldCfg.itemId="keywordField";keywordFieldCfg.flex=30;AS3.setBindable(keywordFieldCfg,"emptyText",AS3.getBindable(config,"keywordEmptyText")!=null?AS3.getBindable(config,"keywordEmptyText"):KEYWORD_EMPTY_TEXT$static);keywordFieldCfg.allowBlank=false;keywordFieldCfg.vtype=AS3.getBindable(config,"keywordVType")!=
null?AS3.getBindable(config,"keywordVType"):"keywordConditionKeyword";keywordFieldCfg.enableKeyEvents=true;this.keywordField$A8wG=this.add(keywordFieldCfg);this.keywordField$A8wG.addListener("keyup",function(){this$.fireEvent("modified")});this.keywordField$A8wG.setValue(this.stripPrefix$A8wG(config["keywordText"]));this.addOpSelector$A8wG(opSelector,operators,operator);var valueFieldCfg=AS3.cast(com.coremedia.ui.components.StatefulNumberField,{});AS3.setBindable(valueFieldCfg,"minValue",0);AS3.setBindable(valueFieldCfg,
"maxValue",100);valueFieldCfg.itemId="valueField";valueFieldCfg.flex=20;AS3.setBindable(valueFieldCfg,"emptyText",AS3.getBindable(config,"valueEmptyText")!=null?AS3.getBindable(config,"valueEmptyText"):VALUE_EMPTY_TEXT$static);valueFieldCfg.allowBlank=false;valueFieldCfg.vtype=AS3.getBindable(config,"valueVType")!=null?AS3.getBindable(config,"valueVType"):"keywordConditionValue";valueFieldCfg.enableKeyEvents=true;this.valueField$A8wG=this.add(valueFieldCfg);this.valueField$A8wG.addListener("keyup",
function(){this$.fireEvent("modified")});this.valueField$A8wG.setValue(config["valueText"]);if(AS3.getBindable(config,"suffixText")!=null){var suffixTextCfg=AS3.cast(Ext.form.field.Display,{});suffixTextCfg.itemId="suffixText";AS3.setBindable(suffixTextCfg,"value",AS3.getBindable(config,"suffixText"));this.add(suffixTextCfg)}}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):
OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function stripPrefix(s){if(this.propertyPrefix$A8wG==null||s==null)return s;return s.indexOf(this.propertyPrefix$A8wG)==0?s.substring(this.propertyPrefix$A8wG.length+1):s}function prependPrefix(s){return this.propertyPrefix$A8wG+
"."+(s?s:"")}function getPropertyName(){return this.prependPrefix$A8wG(this.keywordField$A8wG.getValue())}function setPropertyName(name){this.keywordField$A8wG.setValue(this.stripPrefix$A8wG(name))}function getPropertyValue(){var v=this.valueField$A8wG.getValue();return v?v:com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE}function setPropertyValue(value){this.valueField$A8wG.setValue(value==com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE?null:value)}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",
keywordField$A8wG:null,valueField$A8wG:null,propertyPrefix$A8wG:null,constructor:KeywordConditionBase$,super$A8wG:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$A8wG:addOpSelector,stripPrefix$A8wG:stripPrefix,prependPrefix$A8wG:prependPrefix,getPropertyName:getPropertyName,setPropertyName:setPropertyName,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{OPERATORS:undefined,KEYWORD_EMPTY_TEXT:undefined,
VALUE_EMPTY_TEXT:undefined,__initStatics__:function(){static$0();OPERATORS$static_();KEYWORD_EMPTY_TEXT$static_();VALUE_EMPTY_TEXT$static_()}},requires:["AS3.Error","Ext.form.field.Display","Ext.form.field.VTypes","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.StatefulNumberField","com.coremedia.ui.components.StatefulTextField","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase",
"com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.AbstractConditionBase",function(AbstractConditionBase){function KEYWORD_EMPTY_TEXT$static_(){AbstractConditionBase.KEYWORD_EMPTY_TEXT=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_keyword")}function OPERATOR_EMPTY_TEXT$static_(){AbstractConditionBase.OPERATOR_EMPTY_TEXT=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_operator")}
function VALUE_EMPTY_TEXT$static_(){AbstractConditionBase.VALUE_EMPTY_TEXT=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_value")}function DEFAULT_OPERATOR_DISPLAY_NAMES$static_(){AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES={}}function static$0(){AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_op_less");AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN_OR_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_less_equal");AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_op_equal");AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_not_equal");AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN_OR_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_op_greater_equal");AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_greater");AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_CONTAINS]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_op_contains")}var OPERATOR_EXTERNAL_INTERNAL$static;function OPERATOR_EXTERNAL_INTERNAL$static_(){OPERATOR_EXTERNAL_INTERNAL$static={"lt":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,"le":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN_OR_EQUAL,"eq":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,"ne":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_NOTEQUAL,"ge":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN_OR_EQUAL,
"gt":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN,"ct":com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_CONTAINS}}function AbstractConditionBase$(config){config=config!==undefined?config:{};this.super$KT_z(config)}function internalFromExternalOperatorName$static(externalName){return OPERATOR_EXTERNAL_INTERNAL$static[externalName]}function convertToInternalNames$static(externalOperatorNames){var internalOperatorNames=[];for(var i=0;i<externalOperatorNames.length;++i)internalOperatorNames[i]=
AbstractConditionBase.internalFromExternalOperatorName(externalOperatorNames[i]);return internalOperatorNames}function convertToInternalToDisplayNames$static(externalToDisplayNames){var internalToDisplayNames={};for(var external in externalToDisplayNames)internalToDisplayNames[AbstractConditionBase.internalFromExternalOperatorName(external)]=externalToDisplayNames[external];return internalToDisplayNames}function createOperators$static(usedOperators,operatorNames){operatorNames=operatorNames!==undefined?
operatorNames:{};var operatorArray=new Array;for(var i=0;i<usedOperators.length;i++){var op=usedOperators[i];var opName=AbstractConditionBase.DEFAULT_OPERATOR_DISPLAY_NAMES[op];if(operatorNames!=null&&operatorNames[op]!=null)opName=operatorNames[op];var entry=[op,opName];operatorArray.push(entry)}return operatorArray}function initOpSelector(operators,operatorNames,operatorEmptyText,operator,defaultOperators,defaultOperatorNames){var internalOperators=operators!=null?AbstractConditionBase.convertToInternalNames(operators):
defaultOperators;this.opSelector$KT_z=new com.coremedia.personalization.ui.condition.OperatorSelector(internalOperators,Ext.apply({},AbstractConditionBase.convertToInternalToDisplayNames(operatorNames),defaultOperatorNames),operatorEmptyText);return this.opSelector$KT_z}function getPropertyName(){return this.propertyName$KT_z}function setPropertyName(name){this.propertyName$KT_z=name}function getOperator(){var op=this.opSelector$KT_z.getValue();return op?op:com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_OPERATOR}
function setOperator(op){op!=com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_OPERATOR?this.opSelector$KT_z.setValue(op):this.opSelector$KT_z.setValue(null)}function getPropertyValue(){throw new AS3.Error("not implemented!");}function setPropertyValue(value){throw new AS3.Error("not implemented!");}return{extend:"Ext.container.Container",mixins:["com.coremedia.personalization.ui.editors.Condition"],propertyName$KT_z:null,opSelector$KT_z:null,constructor:AbstractConditionBase$,super$KT_z:function(){Ext.container.Container.prototype.constructor.apply(this,
arguments)},initOpSelector:initOpSelector,getPropertyName:getPropertyName,setPropertyName:setPropertyName,getOperator:getOperator,setOperator:setOperator,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,statics:{KEYWORD_EMPTY_TEXT:undefined,OPERATOR_EMPTY_TEXT:undefined,VALUE_EMPTY_TEXT:undefined,DEFAULT_OPERATOR_DISPLAY_NAMES:undefined,OPERATOR_EXTERNAL_INTERNAL:undefined,internalFromExternalOperatorName:internalFromExternalOperatorName$static,convertToInternalNames:convertToInternalNames$static,
convertToInternalToDisplayNames:convertToInternalToDisplayNames$static,createOperators:createOperators$static,__initStatics__:function(){KEYWORD_EMPTY_TEXT$static_();OPERATOR_EMPTY_TEXT$static_();VALUE_EMPTY_TEXT$static_();DEFAULT_OPERATOR_DISPLAY_NAMES$static_();static$0();OPERATOR_EXTERNAL_INTERNAL$static_()}},requires:["AS3.Error","Ext","Ext.container.Container","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.editors.Condition","mx.resources.ResourceManager"],
uses:["com.coremedia.personalization.ui.condition.OperatorSelector","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.DateConditionBase",function(DateConditionBase){var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]}var DATE_OPERATOR_NAMES$static;function DATE_OPERATOR_NAMES$static_(){DATE_OPERATOR_NAMES$static={}}function static$0(){DATE_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_time_less");DATE_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_EQUAL]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_date_time_equal");DATE_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization",
"p13n_op_time_greater")}function DateConditionBase$(config){if(arguments.length<=0)config=null;var operators=config["operators"];var operator=config["operator"];var opSelector=this.initOpSelector(null,config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,DATE_OPERATOR_NAMES$static);this.super$ZfKn(config);this.addOpSelector$ZfKn(opSelector,operators,operator);this.initDateChooser$ZfKn(config["dateEmptyText"],config["dateVType"],config["dateText"])}function addOpSelector(opSelector,
operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function initDateChooser(dateEmptyText,
dateVType,dateText){var this$=this;var valueFieldConf=AS3.cast(com.coremedia.ui.components.StatefulDateField,{});valueFieldConf.itemId="valueField";valueFieldConf.flex=30;AS3.setBindable(valueFieldConf,"emptyText",dateEmptyText!=null?dateEmptyText:"date");valueFieldConf.allowBlank=false;valueFieldConf.vtype=dateVType;valueFieldConf.format=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_date_format");this.valueField$ZfKn=new com.coremedia.ui.components.StatefulDateField(valueFieldConf);
this.add(this.valueField$ZfKn);this.valueField$ZfKn.addListener("change",function(){this$.fireEvent("modified")});this.valueField$ZfKn.addListener("select",function(){this$.fireEvent("modified")});this.setPropertyValue(dateText)}function getPropertyValue(){var d=this.valueField$ZfKn.getValue();return d?Ext.Date.format(d,"Y-m-d\\TH:i:s"):com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE}function setPropertyValue(v){if(v!=com.coremedia.personalization.ui.util.SelectionRuleHelper.EMPTY_VALUE){var d=
Ext.Date.parse(v,"Y-m-d\\TH:i:s");if(d==null)d=new Date;this.valueField$ZfKn.setValue(d)}else this.valueField$ZfKn.setValue(null)}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",valueField$ZfKn:null,constructor:DateConditionBase$,super$ZfKn:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$ZfKn:addOpSelector,initDateChooser$ZfKn:initDateChooser,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,
statics:{OPERATORS:undefined,DATE_OPERATOR_NAMES:undefined,__initStatics__:function(){OPERATORS$static_();DATE_OPERATOR_NAMES$static_();static$0()}},requires:["Ext.Date","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.StatefulDateField","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.condition.DateTimeConditionBase",function(DateTimeConditionBase){var OPERATORS$static;function OPERATORS$static_(){OPERATORS$static=[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN,com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]}var DATETIME_OPERATOR_NAMES$static;function DATETIME_OPERATOR_NAMES$static_(){DATETIME_OPERATOR_NAMES$static={}}function static$0(){DATETIME_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_LESS_THAN]=
mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_time_less");DATETIME_OPERATOR_NAMES$static[com.coremedia.personalization.ui.util.SelectionRuleHelper.OP_GREATER_THAN]=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_op_time_greater")}function DateTimeConditionBase$(config){var this$=this;if(arguments.length<=0)config=null;var operators=config["operators"];var operator=config["operator"];
var opSelector=this.initOpSelector(null,config["operatorNames"],config["operatorEmptyText"],operator,OPERATORS$static,DATETIME_OPERATOR_NAMES$static);this.super$qqpa(config);this.addOpSelector$qqpa(opSelector,operators,operator);var dateFieldCfg=AS3.cast(com.coremedia.ui.components.StatefulDateField,{});dateFieldCfg.itemId="dateField";dateFieldCfg.flex=30;AS3.setBindable(dateFieldCfg,"emptyText",AS3.getBindable(config,"dateEmptyText")!=null?AS3.getBindable(config,"dateEmptyText"):"date");dateFieldCfg.allowBlank=
false;dateFieldCfg.vtype=AS3.getBindable(config,"dateVType");dateFieldCfg.format=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_date_format");this.dateField$qqpa=this.add(dateFieldCfg);this.dateField$qqpa.addListener("change",function(){this$.fireEvent("modified")});this.dateField$qqpa.addListener("select",function(){this$.fireEvent("modified")});var timeFieldCfg=AS3.cast(com.coremedia.ui.components.StatefulTimeField,{});timeFieldCfg.itemId="timeField";timeFieldCfg.flex=
30;AS3.setBindable(timeFieldCfg,"emptyText",AS3.getBindable(config,"timeEmptyText")!=null?AS3.getBindable(config,"timeEmptyText"):"time");timeFieldCfg.allowBlank=false;AS3.setBindable(timeFieldCfg,"minValue",Ext.Date.parse("0:00 AM","g:i A"));AS3.setBindable(timeFieldCfg,"maxValue",Ext.Date.parse("11:59 PM","g:i A"));timeFieldCfg.increment=30;timeFieldCfg.format=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_time_format");this.timeField$qqpa=this.add(timeFieldCfg);
this.timeField$qqpa.addListener("change",function(){this$.fireEvent("modified")});this.timeField$qqpa.addListener("select",function(){this$.fireEvent("modified")});this.setPropertyValue(config["dateText"])}function addOpSelector(opSelector,operators,operator){var this$=this;this.add(opSelector);var internalOperators=operators!=null?com.coremedia.personalization.ui.condition.AbstractConditionBase.convertToInternalNames(operators):OPERATORS$static;this.on("afterrender",function(){opSelector.addListener("modified",
function(){this$.fireEvent("modified")});opSelector.setValue(operator?com.coremedia.personalization.ui.condition.AbstractConditionBase.internalFromExternalOperatorName(operator):internalOperators[0])})}function getPropertyValue(){var d=this.dateField$qqpa.getValue();var t=this.timeField$qqpa.getValue();d=Ext.Date.add(d,Ext.Date.HOUR,Number(Ext.Date.format(t,"G")));d=Ext.Date.add(d,Ext.Date.MINUTE,Number(Ext.Date.format(t,"i")));return Ext.Date.format(d,"Y-m-d\\TH:i:s")}function setPropertyValue(v){var d=
Ext.Date.parse(v,"Y-m-d\\TH:i:s");if(d==null)d=new Date;this.dateField$qqpa.setValue(d);this.timeField$qqpa.setValue(d)}return{extend:"com.coremedia.personalization.ui.condition.AbstractCondition",dateField$qqpa:null,timeField$qqpa:null,constructor:DateTimeConditionBase$,super$qqpa:function(){com.coremedia.personalization.ui.condition.AbstractCondition.prototype.constructor.apply(this,arguments)},addOpSelector$qqpa:addOpSelector,getPropertyValue:getPropertyValue,setPropertyValue:setPropertyValue,
statics:{OPERATORS:undefined,DATETIME_OPERATOR_NAMES:undefined,__initStatics__:function(){OPERATORS$static_();DATETIME_OPERATOR_NAMES$static_();static$0()}},requires:["Ext.Date","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.condition.AbstractCondition","com.coremedia.ui.components.StatefulDateField","com.coremedia.ui.components.StatefulTimeField","mx.resources.ResourceManager"],uses:["com.coremedia.personalization.ui.condition.AbstractConditionBase",
"com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.util.SelectionRuleHelper",function(SelectionRuleHelper){var SYNTAX_KEYWORD$static="([a-zA-Z_][a-zA-Z_0-9\\.\\:]*)";var SYNTAX_BOOL$static="true|false";var SYNTAX_SEPARATOR$static="\\s*(?:;|\\r?\\s*\\n)+\\s*";var SYNTAX_OPERATOR$static;function SYNTAX_OPERATOR$static_(){SYNTAX_OPERATOR$static="(\x3c|\x3c\x3d|\x3d|\x3e\x3d|!\x3d|#|\x3e|"+SelectionRuleHelper.EMPTY_OPERATOR+")"}var SYNTAX_NUMBER$static="\\d+(\\.\\d+)?";var SYNTAX_STRING$static='"[^"]*"';var SYNTAX_DATE$static=
"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}";var SYNTAX_TIME$static="\\d{2}:\\d{2}:\\d{2}";var SYNTAX_VALUE$static;function SYNTAX_VALUE$static_(){SYNTAX_VALUE$static="("+SYNTAX_TIME$static+"|"+SYNTAX_DATE$static+"|"+SYNTAX_STRING$static+"|"+SYNTAX_KEYWORD$static+"|"+SYNTAX_NUMBER$static+"|"+SYNTAX_BOOL$static+"|"+SelectionRuleHelper.EMPTY_VALUE+")"}var SYNTAX_CONDITION$static;function SYNTAX_CONDITION$static_(){SYNTAX_CONDITION$static=SYNTAX_KEYWORD$static+"\\s*"+SYNTAX_OPERATOR$static+"\\s*"+SYNTAX_VALUE$static}
var SYNTAX_CONTENTID$static;function SYNTAX_CONTENTID$static_(){SYNTAX_CONTENTID$static=com.coremedia.personalization.ui.util.RuleXMLCoDec.INTERNAL_CONTENT_ID_PREFIX+"(\\d+)"}var SYNTAX_RULE$static;function SYNTAX_RULE$static_(){SYNTAX_RULE$static="^("+"\\s*select\\s+("+SYNTAX_CONTENTID$static+")(\\s+if\\s+"+SYNTAX_CONDITION$static+"(\\s+(and|or)\\s+"+SYNTAX_CONDITION$static+")*)?\\s*"+")?$"}var RULE_SYNTAX_PATTERN$static;function RULE_SYNTAX_PATTERN$static_(){RULE_SYNTAX_PATTERN$static=new RegExp(SYNTAX_RULE$static)}
var RULE_SEPARATOR_PATTERN$static;function RULE_SEPARATOR_PATTERN$static_(){RULE_SEPARATOR_PATTERN$static=new RegExp(SYNTAX_SEPARATOR$static)}var CONDITIONS_SYNTAX_PATTERN$static;function CONDITIONS_SYNTAX_PATTERN$static_(){CONDITIONS_SYNTAX_PATTERN$static=new RegExp("^(\\s*"+SYNTAX_CONDITION$static+"(\\s+(and|or)\\s+"+SYNTAX_CONDITION$static+")*)?\\s*$")}var CONTENTID_PATTERN$static;function CONTENTID_PATTERN$static_(){CONTENTID_PATTERN$static=new RegExp("^\\s*select\\s+"+SYNTAX_CONTENTID$static)}
var CONDITIONS_PATTERN$static;function CONDITIONS_PATTERN$static_(){CONDITIONS_PATTERN$static=new RegExp("\\s*select\\s+(.+)\\s+if\\s+(.+)")}var PRED_PATTERN$static;function PRED_PATTERN$static_(){PRED_PATTERN$static=new RegExp("^\\s*"+SYNTAX_KEYWORD$static+"\\s*"+SYNTAX_OPERATOR$static+"\\s*"+SYNTAX_VALUE$static+"\\s*$")}function isValidRuleList$static(rules){var rulesArray=SelectionRuleHelper.splitRules(rules);for(var i=0;i<rulesArray.length;i++){var rule=rulesArray[i];if(RULE_SYNTAX_PATTERN$static.exec(rule)==
null)return false}return true}function isValidConditionsExpr$static(conditionsExpr){return CONDITIONS_SYNTAX_PATTERN$static.exec(conditionsExpr)!=null}function parseSelectionRules$static(rules){var result=[];if(rules==null||rules.length==0)return result;var singleRules=SelectionRuleHelper.splitRules(rules);for(var i=0;i<singleRules.length;++i){var rule=singleRules[i];var contentId=SelectionRuleHelper.contentIdFromSelectionRule(rule);var conditions=SelectionRuleHelper.conditionsFromConditionsExpr(SelectionRuleHelper.conditionsExprFromSelectionRule(rule));
result.push([contentId,conditions])}return result}function splitRules$static(rules){return rules.split(RULE_SEPARATOR_PATTERN$static)}function contentIdFromSelectionRule$static(rule){var match=CONTENTID_PATTERN$static.exec(rule);return match!=null?match[1]:0}function conditionsFromConditionsExpr$static(conditionsExpr){var result=[];var conditions=[];if(conditionsExpr==null||conditionsExpr=="")return result;conditionsExpr=conditionsExpr.replace(/\s+/g," ");while(true){var match=conditionsExpr.match(/^(.+)\s+(and|or)\s+(.+)$/);
if(match){conditionsExpr=match[1];var opMatch=match[match.length-2];var opSuffix=match[match.length-1];conditions.unshift(opMatch,opSuffix)}else{conditions.unshift(conditionsExpr);break}}var op=null;for(var i=0;i<conditions.length;++i){var pred=conditions[i];if(pred=="and")op=SelectionRuleHelper.CON_AND;else if(pred=="or")op=SelectionRuleHelper.CON_OR;else{var predMatch=PRED_PATTERN$static.exec(pred);if(joo.debug)AS3.trace("found predicate",pred,"with fragments",predMatch);if(predMatch!=null){if(op!=
null)result.push(op);result.push(predMatch[1],predMatch[2],predMatch[3]);op=null}else{if(joo.debug)AS3.trace("[WARN]: unable to parse conditions",conditionsExpr,"unknown predicate detected",pred);return[]}}}return result}function conditionsExprFromSelectionRule$static(rule){if(rule==null||rule=="")return"";var condMatch=CONDITIONS_PATTERN$static.exec(rule);return condMatch!=null?condMatch[2]:""}function createContentSelectionRule$static(contentId,conditions){return"select content:"+contentId+conditionString$static(conditions)}
function createContentSelectionRuleFromConditionsExpr$static(contentId,conditionsExpr){return"select content:"+contentId+(conditionsExpr!=null&&conditionsExpr.length>0?" if "+conditionsExpr:"")}function conditionString$static(conditions){var result="";if(conditions!=null&&conditions.length>0){result+=" if ";result+=SelectionRuleHelper.createConditionsExpr(conditions)}return result}function createConditionsExpr$static(conditions){var result="";for(var i=0;i<conditions.length;++i){var token=conditions[i];
switch(token){case SelectionRuleHelper.CON_AND:result+=" and ";break;case SelectionRuleHelper.CON_OR:result+=" or ";break;default:result+=token}}return result}function createSegmentSelectionRule$static(segmentName,conditions){return"select segment:"+segmentName+conditionString$static(conditions)}function createSelectionRuleList$static(rules){var ruleList="";for(var i=0;i<rules.length;++i){if(rules[i]==null||rules[i]=="")continue;if(ruleList!="")ruleList+="; ";ruleList+=rules[i]}return ruleList}function SelectionRuleHelper$(){}
return{constructor:SelectionRuleHelper$,statics:{CON_AND:"_and_",CON_OR:"_or_",OP_LESS_THAN:"\x3c",OP_LESS_THAN_OR_EQUAL:"\x3c\x3d",OP_EQUAL:"\x3d",OP_NOTEQUAL:"!\x3d",OP_GREATER_THAN_OR_EQUAL:"\x3e\x3d",OP_GREATER_THAN:"\x3e",OP_CONTAINS:"#",EMPTY_VALUE:"/v/",EMPTY_OPERATOR:"/o/",SYNTAX_OPERATOR:undefined,SYNTAX_VALUE:undefined,SYNTAX_CONDITION:undefined,SYNTAX_CONTENTID:undefined,SYNTAX_RULE:undefined,RULE_SYNTAX_PATTERN:undefined,RULE_SEPARATOR_PATTERN:undefined,CONDITIONS_SYNTAX_PATTERN:undefined,
CONTENTID_PATTERN:undefined,CONDITIONS_PATTERN:undefined,PRED_PATTERN:undefined,isValidRuleList:isValidRuleList$static,isValidConditionsExpr:isValidConditionsExpr$static,parseSelectionRules:parseSelectionRules$static,splitRules:splitRules$static,contentIdFromSelectionRule:contentIdFromSelectionRule$static,conditionsFromConditionsExpr:conditionsFromConditionsExpr$static,conditionsExprFromSelectionRule:conditionsExprFromSelectionRule$static,createContentSelectionRule:createContentSelectionRule$static,
createContentSelectionRuleFromConditionsExpr:createContentSelectionRuleFromConditionsExpr$static,createConditionsExpr:createConditionsExpr$static,createSegmentSelectionRule:createSegmentSelectionRule$static,createSelectionRuleList:createSelectionRuleList$static,__initStatics__:function(){SYNTAX_OPERATOR$static_();SYNTAX_VALUE$static_();SYNTAX_CONDITION$static_();SYNTAX_CONTENTID$static_();SYNTAX_RULE$static_();RULE_SYNTAX_PATTERN$static_();RULE_SEPARATOR_PATTERN$static_();CONDITIONS_SYNTAX_PATTERN$static_();
CONTENTID_PATTERN$static_();CONDITIONS_PATTERN$static_();PRED_PATTERN$static_()}},requires:["AS3.trace"],uses:["com.coremedia.personalization.ui.util.RuleXMLCoDec"]}});Ext.define("com.coremedia.personalization.ui.util.PersonaContextHelper",function(PersonaContextHelper){function INVALID_VALUE$static_(){PersonaContextHelper.INVALID_VALUE=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean({profileSettings:"invalid"})}var CONTEXT$static="([a-zA-Z_][a-zA-Z_0-9]*)";var KEY$static="([a-zA-Z_0-9]+)";var VALUE$static="(.*\\S)?";var COMMENT$static="(#.*)";var PROPERTY$static;function PROPERTY$static_(){PROPERTY$static="(?:\\s*(?:"+COMMENT$static+
"|"+CONTEXT$static+"\\."+KEY$static+"\\s*\x3d\\s*"+VALUE$static+")\\s*?)"}var PROPERTIES$static;function PROPERTIES$static_(){PROPERTIES$static="^"+PROPERTY$static+"(?:\\n"+PROPERTY$static+")*$"}var validationRegExp$static;function validationRegExp$static_(){validationRegExp$static=new RegExp(PROPERTIES$static)}function isValidPropertiesString$static(str){return str==null||str.length==0||validationRegExp$static.exec(str)!=null}function beanFromPropertiesString$static(str){if(!PersonaContextHelper.isValidPropertiesString(str))return PersonaContextHelper.INVALID_VALUE;
var result=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean({});var tokenizer=new RegExp(PROPERTY$static,"g");var match=tokenizer.exec(str);while(match!=null){if(match[1]==undefined||match[1]==""){var context=match[2];var key=match[3];var value=match[4];result.set(context+PersonaContextHelper.CONTEXT_NAME_SEPARATOR+key,value)}match=tokenizer.exec(str)}return result}function groupArrayFromPropertiesString$static(str){if(!PersonaContextHelper.isValidPropertiesString(str))return[];
var result=new Array;var tokenizer=new RegExp(PROPERTY$static,"g");var match=tokenizer.exec(str);while(match!=null){if(match[1]==undefined||match[1]==""){var context=match[2];var key=match[3];var value=match[4];result.push([context,key,value])}match=tokenizer.exec(str)}return result}function propertiesStringFromBean$static(bean){var result="";for(var property in bean.toObject())if(property!=PersonaContextHelper.HIDDEN_PROPERTY_NAME){var value=bean.get(property);if(value!="")result+=property.replace(PersonaContextHelper.CONTEXT_NAME_SEPARATOR,
".")+"\x3d"+(value!=null?value:"")+"\n"}return result}function PersonaContextHelper$(){}return{constructor:PersonaContextHelper$,statics:{CONTEXT_NAME_SEPARATOR:"!",HIDDEN_PROPERTY_NAME:"blobPropertiesLoaded",INVALID_VALUE:undefined,PROPERTY:undefined,PROPERTIES:undefined,validationRegExp:undefined,isValidPropertiesString:isValidPropertiesString$static,beanFromPropertiesString:beanFromPropertiesString$static,groupArrayFromPropertiesString:groupArrayFromPropertiesString$static,propertiesStringFromBean:propertiesStringFromBean$static,
__initStatics__:function(){INVALID_VALUE$static_();PROPERTY$static_();PROPERTIES$static_();validationRegExp$static_()}},requires:["com.coremedia.cms.editor.sdk.editorContext"]}});Ext.define("com.coremedia.personalization.ui.util.RuleXMLCoDec",function(RuleXMLCoDec){var contentRegExpString$static='\x3ccontent\\s+xlink:href\x3d"(?:[^"]*?(?:content|resources)/(\\d+))?"\\s*/\x3e';var contentRegExp$static;function contentRegExp$static_(){contentRegExp$static=new RegExp(contentRegExpString$static)}var contentRegExpGlobal$static;function contentRegExpGlobal$static_(){contentRegExpGlobal$static=new RegExp(contentRegExpString$static,"g")}function xmlFromRules$static(rules){var result=
'\x3c?xml version\x3d"1.0"?\x3e\x3crules version\x3d"1.0" xmlns\x3d"http://www.coremedia.com/2010/selectionrules" '+'xmlns:xlink\x3d"http://www.w3.org/1999/xlink"\x3e';if(rules!=null&&rules.length>0){var rulesXML=xmlEncode$static(rules);rulesXML=replaceContents$static(rulesXML);result+=rulesXML}result+="\x3c/rules\x3e";return result}function xmlEncode$static(str){return str.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;")}function replaceContents$static(rulesXML){return rulesXML.replace(/content:(-?\d+)/g,
function(str){var match=str.match(/content:(-?\d+)/);var link=com.coremedia.ui.util.IdUtil.formatContentId(match[1]>0?match[1]:0);return'\x3ccontent xlink:href\x3d"'+link+'"/\x3e'})}function rulesFromXML$static(xml){var result=xml;if(xml){result=replaceContentTags$static(result);result=removeXMLTags$static(result);result=xmlDecode$static(result);result=trim$static(result)}return result}function trim$static(str){return str.replace(/^\s+/,"").replace(/\s+$/,"")}function removeXMLTags$static(str){return str.replace(/<.*?>/g,
"")}function replaceContentTags$static(str){return str.replace(contentRegExpGlobal$static,function(str){var match=contentRegExp$static.exec(str);return RuleXMLCoDec.INTERNAL_CONTENT_ID_PREFIX+(match[1]>0?match[1]:String(com.coremedia.ui.util.IdUtil.MISSING_CONTENT_ID))})}function xmlDecode$static(str){return str.replace(/&amp;/g,"\x26").replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e")}function RuleXMLCoDec$(){}return{constructor:RuleXMLCoDec$,statics:{contentRegExp:undefined,contentRegExpGlobal:undefined,
INTERNAL_CONTENT_ID_PREFIX:"content:",xmlFromRules:xmlFromRules$static,rulesFromXML:rulesFromXML$static,__initStatics__:function(){contentRegExp$static_();contentRegExpGlobal$static_()}},requires:["com.coremedia.ui.util.IdUtil"]}});Ext.define("com.coremedia.personalization.ui.DateFieldBase",function(DateFieldBase){function DateFieldBase$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.DateFieldBaseBase,{});var defaults_$1=AS3.cast(DateFieldBase,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$8eSZ(config_$1)}return{extend:"com.coremedia.personalization.ui.DateFieldBaseBase",alias:"widget.com.coremedia.personalization.ui.config.dateFieldBase",
constructor:DateFieldBase$,super$8eSZ:function(){com.coremedia.personalization.ui.DateFieldBaseBase.prototype.constructor.apply(this,arguments)},requires:["com.coremedia.personalization.ui.DateFieldBaseBase","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase",function(PersonaPopupOverviewPanelBase){function EMPTY_PERSONA_PIC_BIG_SRC$static_(){PersonaPopupOverviewPanelBase.EMPTY_PERSONA_PIC_BIG_SRC=Ext.getResourcePath(PersonaPopupOverviewPanelBase.EMPTY_PERSONA_PIC_SRC,null,PersonaPopupOverviewPanelBase.EMPTY_PERSONA_PIC_PACKAGE_NAME)}function PersonaPopupOverviewPanelBase$(config){if(arguments.length<=0)config=null;this.super$lGU_(config);this.addAllImplicitInterestItemContainers$lGU_(AS3.getBindable(config,
"personaModel").getImplicitInterestValueExpression());this.personaActivator$lGU_=AS3.getBindable(config,"personaActivator");this.personaContent$lGU_=AS3.getBindable(config,"personaContent");this.personaButton$lGU_=AS3.as(this.queryById(PersonaPopupOverviewPanelBase.PERSONA_USE_IN_PREVIEW_BUTTON_ITEM_ID),com.coremedia.ui.components.IconButton)}function togglePersonaButton(event){this.setPersonaButtonState$lGU_(event.newValue===AS3.as(this.personaContent$lGU_,Object).getNumericId())}function setPersonaButtonState(personaActivated){this.personaButton$lGU_.setPressed(personaActivated);
this.personaButton$lGU_.setDisabled(personaActivated)}function addAllImplicitInterestItemContainers(valueExp){if(valueExp&&valueExp.getValue()){var implicitInterestHelper=AS3.as(valueExp.getValue(),com.coremedia.personalization.ui.persona.helper.PersonaImplicitInterestHelper);var implicitNames=implicitInterestHelper.getNameArray();this.getImplicitContainer$lGU_().remove(PersonaPopupOverviewPanelBase.PERSONA_IMPLICIT_INTEREST_EMPTY_FIELD_ITEM_ID);for(var i=0;i<implicitNames.length;i++){var personaPopupImplicitContainerCfg=
AS3.cast(com.coremedia.personalization.ui.persona.popup.PersonaPopupImplicitContainer,{});AS3.setBindable(personaPopupImplicitContainerCfg,"implicitName",implicitNames[i]);AS3.setBindable(personaPopupImplicitContainerCfg,"implicitValue",implicitInterestHelper.getValueForName(implicitNames[i]));this.addImplicitInterestItemContainer$lGU_(personaPopupImplicitContainerCfg)}}}function getImplicitContainer(){if(!this.implicitContainer$lGU_)this.implicitContainer$lGU_=AS3.as(this.queryById(PersonaPopupOverviewPanelBase.IMPLICIT_ITEM_CONTAINER_ITEM_ID),
Ext.container.Container);return this.implicitContainer$lGU_}function addImplicitInterestItemContainer(implicitInterestContainer){this.getImplicitContainer$lGU_().add(implicitInterestContainer)}function replaceQuotesAndEncode$static(value){if(value)return com.coremedia.ui.util.EncodingUtil.encodeForHTML(value.replace(/"/g,""));return value}function afterRender(){Ext.panel.Panel.prototype.afterRender.call(this);this.setPersonaButtonState$lGU_(this.personaActivator$lGU_.isActive(this.personaContent$lGU_));
this.personaActivator$lGU_.getUrlParameterBean().addPropertyChangeListener(com.coremedia.personalization.ui.persona.helper.PersonaActivator.P13N_TESTCONTEXT_PARAM,AS3.bind(this,"togglePersonaButton$lGU_"))}function onDestroy(){this.personaActivator$lGU_.getUrlParameterBean().removePropertyChangeListener(com.coremedia.personalization.ui.persona.helper.PersonaActivator.P13N_TESTCONTEXT_PARAM,AS3.bind(this,"togglePersonaButton$lGU_"));Ext.panel.Panel.prototype.onDestroy.call(this)}return{extend:"Ext.panel.Panel",
implicitContainer$lGU_:null,personaActivator$lGU_:null,personaContent$lGU_:null,personaButton$lGU_:null,constructor:PersonaPopupOverviewPanelBase$,super$lGU_:function(){Ext.panel.Panel.prototype.constructor.apply(this,arguments)},togglePersonaButton$lGU_:togglePersonaButton,setPersonaButtonState$lGU_:setPersonaButtonState,addAllImplicitInterestItemContainers$lGU_:addAllImplicitInterestItemContainers,getImplicitContainer$lGU_:getImplicitContainer,addImplicitInterestItemContainer$lGU_:addImplicitInterestItemContainer,
afterRender:afterRender,onDestroy:onDestroy,statics:{EMPTY_PERSONA_PIC_SRC:"persona_empty_icon_neutral_50.png",EMPTY_PERSONA_PIC_PACKAGE_NAME:"com.coremedia.personalization__cap-personalization-ui",EMPTY_PERSONA_PIC_BIG_SRC:undefined,IMPLICIT_ITEM_CONTAINER_ITEM_ID:"implicitContainer",PERSONA_IMPLICIT_INTEREST_EMPTY_FIELD_ITEM_ID:"personaImplicitInterestEmptyField",PERSONA_USE_IN_PREVIEW_BUTTON_ITEM_ID:"personaUseInPreviewButton",replaceQuotesAndEncode:replaceQuotesAndEncode$static,__initStatics__:function(){EMPTY_PERSONA_PIC_BIG_SRC$static_()}},
requires:["Ext","Ext.container.Container","Ext.panel.Panel","com.coremedia.ui.components.IconButton","com.coremedia.ui.util.EncodingUtil"],uses:["com.coremedia.personalization.ui.persona.helper.PersonaActivator","com.coremedia.personalization.ui.persona.helper.PersonaImplicitInterestHelper","com.coremedia.personalization.ui.persona.popup.PersonaPopupImplicitContainer"]}});Ext.define("com.coremedia.personalization.ui.persona.popup.PersonaPopup",function(PersonaPopup){function PersonaPopup$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.popup.PersonaPopupBase,{});var defaults_$1=AS3.cast(PersonaPopup,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);config_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopup.WINDOW_ITEM_ID+"-"+AS3.as(AS3.getBindable(config,"personaContent"),Object).getNumericId());
config_$1["id"]=PersonaPopup.WINDOW_ITEM_ID+"-"+AS3.as(AS3.getBindable(config,"personaContent"),Object).getNumericId()+"-"+this.getMyId(config);config_$1.constrain=true;config_$1.closeAction="close";AS3.setBindable(config_$1,"height",500);AS3.setBindable(config_$1,"width",530);config_$1.stateId="personaPopupWindowState";AS3.setBindable(config_$1,"stateful",true);AS3.setBindable(config_$1,"minWidth",430);AS3.setBindable(config_$1,"layout","fit");var ui_BindPropertyPlugin_67_5_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,
{});ui_BindPropertyPlugin_67_5_$1.componentProperty="title";ui_BindPropertyPlugin_67_5_$1.transformer=com.coremedia.ui.util.EncodingUtil.encodeForHTML;var ui_ValueExpression_70_9_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_70_9_$1,"context",AS3.getBindable(config,"personaModel"));AS3.setBindable(ui_ValueExpression_70_9_$1,"expression","personaProfileBean.displayName");ui_BindPropertyPlugin_67_5_$1.bindTo=new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_70_9_$1);
config_$1.plugins=[ui_BindPropertyPlugin_67_5_$1];var tabPanel_76_5_$1=AS3.cast(Ext.tab.Panel,{});AS3.setBindable(tabPanel_76_5_$1,"activeItem",0);tabPanel_76_5_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.TabBarSkin.WORKAREA_PANEL.getSkin());var perso_PersonaPopupOverviewPanel_80_9_$1=AS3.cast(com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanel,{});AS3.setBindable(perso_PersonaPopupOverviewPanel_80_9_$1,"personaContent",AS3.getBindable(config,"personaContent"));
AS3.setBindable(perso_PersonaPopupOverviewPanel_80_9_$1,"personaModel",AS3.getBindable(config,"personaModel"));AS3.setBindable(perso_PersonaPopupOverviewPanel_80_9_$1,"personaActivator",AS3.getBindable(config,"personaActivator"));AS3.setBindable(perso_PersonaPopupOverviewPanel_80_9_$1,"title",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_info_tab_label"));var panel_85_9_$1=AS3.cast(Ext.panel.Panel,{});AS3.setBindable(panel_85_9_$1,"layout","fit");
AS3.setBindable(panel_85_9_$1,"title",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_settings_tab_label"));AS3.setBindable(panel_85_9_$1,"autoScroll",false);var grid_89_13_$1=AS3.cast(Ext.grid.Panel,{});grid_89_13_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.popup.PersonaPopupBase.GRID_ITEM_ID);grid_89_13_$1.header=false;var gridColumn_92_17_$1=AS3.cast(Ext.grid.column.Column,{});gridColumn_92_17_$1.stateId=
"property";gridColumn_92_17_$1.header=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_grid_property_title"));gridColumn_92_17_$1.flex=1;gridColumn_92_17_$1.dataIndex="property";gridColumn_92_17_$1.renderer=function(value){return Ext.util.Format.htmlEncode(value)};var gridColumn_97_17_$1=AS3.cast(Ext.grid.column.Column,{});gridColumn_97_17_$1.stateId="value";gridColumn_97_17_$1.header=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_persona_popup_grid_value_title"));gridColumn_97_17_$1.flex=1;gridColumn_97_17_$1.dataIndex="value";gridColumn_97_17_$1.renderer=function(value){return Ext.util.Format.htmlEncode(value)};var gridColumn_102_17_$1=AS3.cast(Ext.grid.column.Column,{});gridColumn_102_17_$1.stateId="profiles";gridColumn_102_17_$1.header=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_grid_grouping_title"));gridColumn_102_17_$1.dataIndex=
"profiles";grid_89_13_$1.columns=[gridColumn_92_17_$1,gridColumn_97_17_$1,gridColumn_102_17_$1];var store_Store_107_17_$1=AS3.cast(Ext.data.Store,{});AS3.setBindable(store_Store_107_17_$1,"data",[]);AS3.setBindable(store_Store_107_17_$1,"fields",["profiles","property","value"]);AS3.setBindable(grid_89_13_$1,"store",new Ext.data.Store(store_Store_107_17_$1));var gridView_111_17_$1=AS3.cast(Ext.view.Table,{});AS3.setBindable(gridView_111_17_$1,"emptyText",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_persona_popup_grid_nodata")));gridView_111_17_$1.stripeRows=false;gridView_111_17_$1.deferEmptyText=false;grid_89_13_$1["viewConfig"]=gridView_111_17_$1;panel_85_9_$1.items=[grid_89_13_$1];tabPanel_76_5_$1.items=[perso_PersonaPopupOverviewPanel_80_9_$1,panel_85_9_$1];config_$1.items=[tabPanel_76_5_$1];var button_122_5_$1=AS3.cast(Ext.button.Button,{});button_122_5_$1.itemId="closeBtn";button_122_5_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.FOOTER_SECONDARY.getSkin());
AS3.setBindable(button_122_5_$1,"scale","small");AS3.setBindable(button_122_5_$1,"handler",AS3.bind(this,"close"));AS3.setBindable(button_122_5_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.cms.editor.Editor","dialog_defaultCloseButton_text")));config_$1.buttons=[button_122_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$6GrU(config_$1)}return{extend:"com.coremedia.personalization.ui.persona.popup.PersonaPopupBase",alias:"widget.com.coremedia.personalization.ui.config.personaPopup",
constructor:PersonaPopup$,super$6GrU:function(){com.coremedia.personalization.ui.persona.popup.PersonaPopupBase.prototype.constructor.apply(this,arguments)},config:{entityExpression:null,personaContent:null,personaModel:null,personaActivator:null},statics:{WINDOW_ITEM_ID:"personaPopupWindow"},requires:["Ext.button.Button","Ext.data.Store","Ext.grid.Panel","Ext.grid.column.Column","Ext.panel.Panel","Ext.tab.Panel","Ext.util.Format","Ext.view.Table","com.coremedia.personalization.ui.Personalization_properties",
"com.coremedia.personalization.ui.persona.popup.PersonaPopupBase","com.coremedia.ui.exml.ValueExpression","com.coremedia.ui.plugins.BindPropertyPlugin","com.coremedia.ui.skins.ButtonSkin","com.coremedia.ui.skins.TabBarSkin","com.coremedia.ui.util.EncodingUtil","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanel"]}});Ext.define("com.coremedia.personalization.ui.persona.popup.PersonaPopupBase",function(PersonaPopupBase){function PersonaPopupBase$(config){if(arguments.length<=0)config=null;this.super$5gbF(config);this.personaModel$5gbF=AS3.getBindable(config,"personaModel");this.updateGridStoreValueExpression$5gbF();this.personaModel$5gbF.getPersonaProfileBean().addValueChangeListener(AS3.bind(this,"updateGridStoreValueExpression$5gbF"))}function onDestroy(){this.personaModel$5gbF.getPersonaProfileBean().removeValueChangeListener(AS3.bind(this,
"updateGridStoreValueExpression$5gbF"));com.coremedia.cms.editor.sdk.components.StudioDialog.prototype.onDestroy.call(this)}function getMyId(config){return com.coremedia.personalization.ui.persona.popup.PersonaPopupManager.getEntityId(AS3.getBindable(config,"entityExpression").getValue())}function updateGridStoreValueExpression(){var grid=AS3.as(this.queryById(PersonaPopupBase.GRID_ITEM_ID),Ext.grid.Panel);var data=this.personaModel$5gbF.getProfileSettingsAsGroupArray()?this.personaModel$5gbF.getProfileSettingsAsGroupArray():
null;if(data&&grid)grid.getStore().loadData(data)}return{extend:"com.coremedia.cms.editor.sdk.components.StudioDialog",personaModel$5gbF:null,constructor:PersonaPopupBase$,super$5gbF:function(){com.coremedia.cms.editor.sdk.components.StudioDialog.prototype.constructor.apply(this,arguments)},onDestroy:onDestroy,getMyId:getMyId,updateGridStoreValueExpression$5gbF:updateGridStoreValueExpression,statics:{GRID_ITEM_ID:"grid"},requires:["Ext.grid.Panel","com.coremedia.cms.editor.sdk.components.StudioDialog"],
uses:["com.coremedia.personalization.ui.persona.popup.PersonaPopupManager"]}});Ext.define("com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanel",function(PersonaPopupOverviewPanel){function PersonaPopupOverviewPanel$(config){var this$=this;if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase,{});var defaults_$1=AS3.cast(PersonaPopupOverviewPanel,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"scrollable",true);config_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.PanelSkin.GRID_200.getSkin());
var layout_VBox_65_5_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_65_5_$1,"align","stretch");AS3.setBindable(config_$1,"layout",layout_VBox_65_5_$1);var container_68_5_$1=AS3.cast(Ext.container.Container,{});var layout_HBox_70_9_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(container_68_5_$1,"layout",layout_HBox_70_9_$1);var ui_HorizontalSpacingPlugin_73_9_$1=AS3.cast(com.coremedia.ui.plugins.HorizontalSpacingPlugin,{});AS3.setBindable(ui_HorizontalSpacingPlugin_73_9_$1,
"modifier",com.coremedia.ui.bem.SpacingBEMEntities.HORIZONTAL_SPACING_MODIFIER_200);container_68_5_$1.plugins=[ui_HorizontalSpacingPlugin_73_9_$1];var ui_Image_76_9_$1=AS3.cast(com.coremedia.ui.components.Image,{});ui_Image_76_9_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_IMAGE_ITEM_ID);AS3.setBindable(ui_Image_76_9_$1,"height",50);AS3.setBindable(ui_Image_76_9_$1,"width",50);var ui_BindPropertyPlugin_80_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});
ui_BindPropertyPlugin_80_13_$1.componentProperty="src";ui_BindPropertyPlugin_80_13_$1.ifUndefined=com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase.EMPTY_PERSONA_PIC_BIG_SRC;var ui_ValueExpression_83_17_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_83_17_$1,"context",AS3.getBindable(config,"personaModel"));AS3.setBindable(ui_ValueExpression_83_17_$1,"expression","personaProfileBean.image");ui_BindPropertyPlugin_80_13_$1.bindTo=
new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_83_17_$1);ui_Image_76_9_$1.plugins=[ui_BindPropertyPlugin_80_13_$1];var container_89_9_$1=AS3.cast(Ext.container.Container,{});container_89_9_$1.flex=1;var layout_VBox_91_13_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(container_89_9_$1,"layout",layout_VBox_91_13_$1);var displayField_95_13_$1=AS3.cast(Ext.form.field.Display,{});displayField_95_13_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_FULLNAME_FIELD_ITEM_ID);
var ui_BindPropertyPlugin_97_17_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_97_17_$1.transformer=com.coremedia.ui.util.EncodingUtil.encodeForHTML;var ui_ValueExpression_99_21_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_99_21_$1,"context",AS3.getBindable(config,"personaModel"));AS3.setBindable(ui_ValueExpression_99_21_$1,"expression","personaProfileBean.displayName");ui_BindPropertyPlugin_97_17_$1.bindTo=new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_99_21_$1);
displayField_95_13_$1.plugins=[ui_BindPropertyPlugin_97_17_$1];var displayField_106_13_$1=AS3.cast(Ext.form.field.Display,{});displayField_106_13_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_AGE_FIELD_ITEM_ID);var ui_BindPropertyPlugin_108_17_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_108_17_$1.transformer=function(value){return Ext.String.format(this$.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_persona_popup_age"),Number(value))};ui_BindPropertyPlugin_108_17_$1.ifUndefined=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_empty_age");var ui_ValueExpression_114_21_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_114_21_$1,"context",AS3.getBindable(config,"personaModel"));AS3.setBindable(ui_ValueExpression_114_21_$1,"expression","personaProfileBean.age");ui_BindPropertyPlugin_108_17_$1.bindTo=
new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_114_21_$1);var ui_BindPropertyPlugin_118_17_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_118_17_$1.componentProperty="disabled";ui_BindPropertyPlugin_118_17_$1.transformer=function(value){return!value};ui_BindPropertyPlugin_118_17_$1.ifUndefined=true;var ui_ValueExpression_122_21_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_122_21_$1,"context",AS3.getBindable(config,
"personaModel"));AS3.setBindable(ui_ValueExpression_122_21_$1,"expression","personaProfileBean.age");ui_BindPropertyPlugin_118_17_$1.bindTo=new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_122_21_$1);displayField_106_13_$1.plugins=[ui_BindPropertyPlugin_108_17_$1,ui_BindPropertyPlugin_118_17_$1];var displayField_129_13_$1=AS3.cast(Ext.form.field.Display,{});displayField_129_13_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_LOCATION_FIELD_ITEM_ID);var ui_BindPropertyPlugin_131_17_$1=
AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_131_17_$1.ifUndefined=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_empty_location");ui_BindPropertyPlugin_131_17_$1.transformer=com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase.replaceQuotesAndEncode;var ui_ValueExpression_135_21_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_135_21_$1,"context",
AS3.getBindable(config,"personaModel"));AS3.setBindable(ui_ValueExpression_135_21_$1,"expression","personaProfileBean.location!city");ui_BindPropertyPlugin_131_17_$1.bindTo=new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_135_21_$1);var ui_BindPropertyPlugin_139_17_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_139_17_$1.componentProperty="disabled";ui_BindPropertyPlugin_139_17_$1.transformer=function(value){return!value};ui_BindPropertyPlugin_139_17_$1.ifUndefined=
true;var ui_ValueExpression_143_21_$1=AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_143_21_$1,"context",AS3.getBindable(config,"personaModel"));AS3.setBindable(ui_ValueExpression_143_21_$1,"expression","personaProfileBean.location!city");ui_BindPropertyPlugin_139_17_$1.bindTo=new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_143_21_$1);displayField_129_13_$1.plugins=[ui_BindPropertyPlugin_131_17_$1,ui_BindPropertyPlugin_139_17_$1];container_89_9_$1.items=
[displayField_95_13_$1,displayField_106_13_$1,displayField_129_13_$1];var container_151_9_$1=AS3.cast(Ext.container.Container,{});var layout_HBox_153_13_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(container_151_9_$1,"layout",layout_HBox_153_13_$1);var ui_IconButton_156_13_$1=AS3.cast(com.coremedia.ui.components.IconButton,{});ui_IconButton_156_13_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase.PERSONA_USE_IN_PREVIEW_BUTTON_ITEM_ID);
AS3.setBindable(ui_IconButton_156_13_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_use_in_preview_button_text")));AS3.setBindable(ui_IconButton_156_13_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons","persona_in_preview")));AS3.setBindable(ui_IconButton_156_13_$1,"handler",function(){AS3.getBindable(config,"personaActivator").getUrlParameterBean().set(com.coremedia.personalization.ui.persona.helper.PersonaActivator.P13N_TESTCONTEXT_PARAM,
AS3.as(AS3.getBindable(config,"personaContent"),Object).getNumericId())});AS3.setBindable(ui_IconButton_156_13_$1,"tooltip",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_use_in_preview_button_text"));var ui_IconButton_163_13_$1=AS3.cast(com.coremedia.ui.components.IconButton,{});ui_IconButton_163_13_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_EDIT_BUTTON_ITEM_ID);AS3.setBindable(ui_IconButton_163_13_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_persona_popup_edit_button_text")));AS3.setBindable(ui_IconButton_163_13_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons","pencil")));AS3.setBindable(ui_IconButton_163_13_$1,"handler",function(){com.coremedia.cms.editor.sdk.editorContext.getContentTabManager().openDocument(AS3.getBindable(config,"personaContent"))});AS3.setBindable(ui_IconButton_163_13_$1,"tooltip",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_persona_popup_edit_button_text"));container_151_9_$1.items=[ui_IconButton_156_13_$1,ui_IconButton_163_13_$1];container_68_5_$1.items=[ui_Image_76_9_$1,container_89_9_$1,container_151_9_$1];var container_175_5_$1=AS3.cast(Ext.container.Container,{});container_175_5_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_PANEL_ITEM_ID);var layout_VBox_177_9_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_177_9_$1,"align","stretch");AS3.setBindable(container_175_5_$1,
"layout",layout_VBox_177_9_$1);var field_181_9_$1=AS3.cast(Ext.form.field.Base,{});field_181_9_$1["personaModel"]=AS3.getBindable(config,"personaModel");field_181_9_$1["personaContent"]=AS3.getBindable(config,"personaContent");field_181_9_$1.labelAlign="top";field_181_9_$1.labelSeparator="";container_175_5_$1["defaultType"]=field_181_9_$1["xtype"];delete field_181_9_$1["xtype"];delete field_181_9_$1["xclass"];container_175_5_$1.defaults=field_181_9_$1;var fieldContainer_188_9_$1=AS3.cast(Ext.form.FieldContainer,
{});fieldContainer_188_9_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase.IMPLICIT_ITEM_CONTAINER_ITEM_ID);AS3.setBindable(fieldContainer_188_9_$1,"fieldLabel",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_implicit_interest_label")));var layout_VBox_191_13_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_191_13_$1,"align",
"stretch");AS3.setBindable(fieldContainer_188_9_$1,"layout",layout_VBox_191_13_$1);var ui_VerticalSpacingPlugin_194_13_$1=AS3.cast(com.coremedia.ui.plugins.VerticalSpacingPlugin,{});fieldContainer_188_9_$1.plugins=[ui_VerticalSpacingPlugin_194_13_$1];var displayField_198_13_$1=AS3.cast(Ext.form.field.Display,{});displayField_198_13_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase.PERSONA_IMPLICIT_INTEREST_EMPTY_FIELD_ITEM_ID);AS3.setBindable(displayField_198_13_$1,
"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_empty_implicit"));fieldContainer_188_9_$1.items=[displayField_198_13_$1];var displayField_204_9_$1=AS3.cast(Ext.form.field.Display,{});displayField_204_9_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaPopupOverviewPanel.PERSONA_EXPLICIT_INTEREST_LABEL_ITEM_ID);displayField_204_9_$1.htmlEncode=true;AS3.setBindable(displayField_204_9_$1,"fieldLabel",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_persona_popup_explicit_interest_label")));var ui_BindPropertyPlugin_208_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_208_13_$1.componentProperty="value";ui_BindPropertyPlugin_208_13_$1.ifUndefined=this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_empty_explicit");ui_BindPropertyPlugin_208_13_$1.bindTo=AS3.getBindable(config,"personaModel").getExplicitInterestValueExpression();var ui_BindPropertyPlugin_211_13_$1=
AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_211_13_$1.componentProperty="disabled";ui_BindPropertyPlugin_211_13_$1.transformer=function(value){return!value};ui_BindPropertyPlugin_211_13_$1.ifUndefined=true;ui_BindPropertyPlugin_211_13_$1.bindTo=AS3.getBindable(config,"personaModel").getExplicitInterestValueExpression();displayField_204_9_$1.plugins=[ui_BindPropertyPlugin_208_13_$1,ui_BindPropertyPlugin_211_13_$1];container_175_5_$1.items=[fieldContainer_188_9_$1,
displayField_204_9_$1];config_$1.items=[container_68_5_$1,container_175_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$rVjD(config_$1)}return{extend:"com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase",alias:"widget.com.coremedia.personalization.ui.config.personaPopupOverviewPanel",constructor:PersonaPopupOverviewPanel$,super$rVjD:function(){com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase.prototype.constructor.apply(this,arguments)},
config:{personaContent:null,personaModel:null,personaActivator:null},statics:{PERSONA_IMAGE_ITEM_ID:"personaImage",PERSONA_FULLNAME_FIELD_ITEM_ID:"personaFullnameField",PERSONA_AGE_FIELD_ITEM_ID:"personaAgeField",PERSONA_LOCATION_FIELD_ITEM_ID:"personaLocationField",PERSONA_EDIT_BUTTON_ITEM_ID:"personaEditButton",PERSONA_PANEL_ITEM_ID:"personaPanel",PERSONA_EXPLICIT_INTEREST_LABEL_ITEM_ID:"personaExplicitInterestLabel"},requires:["Ext.String","Ext.container.Container","Ext.form.FieldContainer","Ext.form.field.Base",
"Ext.form.field.Display","Ext.layout.container.HBox","Ext.layout.container.VBox","com.coremedia.cms.editor.sdk.editorContext","com.coremedia.icons.CoreIcons_properties","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.persona.popup.PersonaPopupOverviewPanelBase","com.coremedia.ui.bem.SpacingBEMEntities","com.coremedia.ui.components.IconButton","com.coremedia.ui.components.Image","com.coremedia.ui.exml.ValueExpression","com.coremedia.ui.plugins.BindPropertyPlugin",
"com.coremedia.ui.plugins.HorizontalSpacingPlugin","com.coremedia.ui.plugins.VerticalSpacingPlugin","com.coremedia.ui.skins.PanelSkin","com.coremedia.ui.util.EncodingUtil","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.persona.helper.PersonaActivator"]}});Ext.define("com.coremedia.personalization.ui.persona.popup.PersonaPopupImplicitContainer",function(PersonaPopupImplicitContainer){function PersonaPopupImplicitContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.form.FieldContainer,{});var defaults_$1=AS3.cast(PersonaPopupImplicitContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"fieldLabel",net.jangaroo.ext.Exml.asString(com.coremedia.ui.util.EncodingUtil.encodeForHTML(AS3.getBindable(config,
"implicitName"))));config_$1.labelWidth=120;config_$1.labelSeparator="";config_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.LabelableSkin.SUB.getSkin());var layout_Fit_27_5_$1=AS3.cast(Ext.layout.container.Fit,{});AS3.setBindable(config_$1,"layout",layout_Fit_27_5_$1);var progressBar_30_5_$1=AS3.cast(Ext.ProgressBar,{});AS3.setBindable(progressBar_30_5_$1,"value",AS3.getBindable(config,"implicitValue")/100);config_$1.items=[progressBar_30_5_$1];net.jangaroo.ext.Exml.apply(config_$1,
config);this.super$fufU(config_$1)}return{extend:"Ext.form.FieldContainer",alias:"widget.com.coremedia.personalization.ui.config.personaPopupImplicitContainer",constructor:PersonaPopupImplicitContainer$,super$fufU:function(){Ext.form.FieldContainer.prototype.constructor.apply(this,arguments)},config:{implicitName:null,implicitValue:NaN},requires:["Ext.ProgressBar","Ext.form.FieldContainer","Ext.layout.container.Fit","com.coremedia.ui.skins.LabelableSkin","com.coremedia.ui.util.EncodingUtil","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.popup.PersonaPopupManager",function(PersonaPopupManager){function PersonaPopupManager$(){this.popupMap$ldHl={}}function showPersonaPopupForPersonaContent(entityExpression,personaContent,personaModel,trigger,personaActivator){var this$=this;var entity=entityExpression.getValue();var popupIdentifier=personaContent.getId()+"#"+PersonaPopupManager.getEntityId(entity);if(!this.popupMap$ldHl[popupIdentifier]){var workAreaTab=AS3.as(trigger.findParentByType(com.coremedia.cms.editor.sdk.desktop.WorkAreaTab.xtype),
com.coremedia.cms.editor.sdk.desktop.WorkAreaTab);var personaPopupConfig=AS3.cast(com.coremedia.personalization.ui.persona.popup.PersonaPopup,{});AS3.setBindable(personaPopupConfig,"entityExpression",entityExpression);AS3.setBindable(personaPopupConfig,"personaContent",personaContent);AS3.setBindable(personaPopupConfig,"personaModel",personaModel);AS3.setBindable(personaPopupConfig,"personaActivator",personaActivator);personaPopupConfig.renderTo=workAreaTab.getLayout().getTarget();personaPopupConfig.animateTarget=
trigger.getEl();var personaDetailWindow=new com.coremedia.personalization.ui.persona.popup.PersonaPopup(personaPopupConfig);personaDetailWindow.show();personaDetailWindow.addListener("destroy",function(){delete this$.popupMap$ldHl[popupIdentifier]});workAreaTab.on("deactivate",function(){personaDetailWindow.hide()});this.popupMap$ldHl[popupIdentifier]=personaDetailWindow}else AS3.as(this.popupMap$ldHl[popupIdentifier],com.coremedia.personalization.ui.persona.popup.PersonaPopup).show()}function getEntityId$static(entity){var entityId;
if(AS3.is(entity,com.coremedia.cap.content.Content))entityId=String(com.coremedia.cap.common.IdHelper.parseContentId(AS3.cast(com.coremedia.cap.content.Content,entity)));else if(AS3.is(entity,com.coremedia.ui.data.RemoteBean))entityId=AS3.cast(com.coremedia.ui.data.RemoteBean,entity).getUriPath().replace(/[^\w\-\:\.]/g,"-");return entityId}function destroy(){for(var id in this.popupMap$ldHl)if(this.popupMap$ldHl.hasOwnProperty(id))Ext.destroy(this.popupMap$ldHl[id])}return{popupMap$ldHl:null,constructor:PersonaPopupManager$,
showPersonaPopupForPersonaContent:showPersonaPopupForPersonaContent,destroy:destroy,statics:{getEntityId:getEntityId$static},requires:["Ext","com.coremedia.cap.common.IdHelper","com.coremedia.cap.content.Content","com.coremedia.cms.editor.sdk.desktop.WorkAreaTab","com.coremedia.ui.data.RemoteBean"],uses:["com.coremedia.personalization.ui.persona.popup.PersonaPopup"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase",function(PersonaSelectorBase){function PersonaSelectorBase$(config){if(arguments.length<=0)config=null;this.currentContentValueExpression$yWn9=AS3.getBindable(config,"contentValueExpression");this.super$yWn9(config);this.initValidationStateMixin();this.activePersonaValueExpression$yWn9=com.coremedia.ui.data.ValueExpressionFactory.create(com.coremedia.personalization.ui.persona.helper.PersonaActivator.P13N_TESTCONTEXT_PARAM,
this.getPersonaActivator().getUrlParameterBean());this.activePersonaValueExpression$yWn9.addChangeListener(AS3.bind(this,"personaChanged$yWn9"))}function personaChanged(){this.fireEvent(PersonaSelectorBase.PERSONA_CHANGED_EVENT)}function afterRender(){Ext.button.Button.prototype.afterRender.call(this);this.listenToEvents$yWn9()}function showMenu(clickEvent){Ext.button.Button.prototype.showMenu.call(this,clickEvent);this.getPersonaSelectorMenu$yWn9().fireEvent(PersonaSelectorBase.MENU_ACTIVATED_EVENT)}
function onFocusLeave(e){}function onDestroy(){this.activePersonaValueExpression$yWn9.removeChangeListener(AS3.bind(this,"personaChanged$yWn9"));this.getPersonaActivator()&&this.getPersonaActivator().getUrlValueExpression()&&this.getPersonaActivator().getUrlValueExpression().removeChangeListener(AS3.bind(this,"handlePreviewUrlChange$yWn9"));Ext.button.Button.prototype.onDestroy.call(this)}function listenToEvents(){var this$=this;this.mon(this.getPersonaSelectorMenu$yWn9(),"hide",function(){this$.indicateActiveContextButton$yWn9(this$.getPersonaActivator().isAnyPersonaActive());
this$.getPersonaSelectorMenu$yWn9().fireEvent(PersonaSelectorBase.MENU_DEACTIVATED_EVENT)});this.getPersonaActivator().getUrlValueExpression().addChangeListener(AS3.bind(this,"handlePreviewUrlChange$yWn9"))}function handlePreviewUrlChange(){this.indicateActiveContextButton$yWn9(this.getPersonaActivator().isAnyPersonaActive())}function setContent(content){this.currentContent$yWn9=content;this.getCurrentContentValueExpression$yWn9().setValue(this.currentContent$yWn9)}function getCurrentContentValueExpression(){if(!this.currentContentValueExpression$yWn9)this.currentContentValueExpression$yWn9=
com.coremedia.ui.data.ValueExpressionFactory.createFromValue(this.currentContent$yWn9);return this.currentContentValueExpression$yWn9}function getDisabledValueExpression(){var this$=this;if(!this.disabledValueExpression$yWn9)this.disabledValueExpression$yWn9=com.coremedia.ui.data.ValueExpressionFactory.createFromFunction(function(){var value=this$.getCurrentContentValueExpression$yWn9().getValue();return value?false:true});return this.disabledValueExpression$yWn9}function indicateActiveContextButton(isActive){if(isActive){AS3.setBindable(this,
"validationState",com.coremedia.ui.mixins.ValidationState.SUCCESS);this.setPressed(true)}else{this.setPressed(false);AS3.setBindable(this,"validationState",undefined)}}function getPersonaSelectorMenu(){if(!this.myPersonaSelector$yWn9)this.myPersonaSelector$yWn9=AS3.as(AS3.getBindable(this,"menu","DUMMY"),com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu);return this.myPersonaSelector$yWn9}function getPersonaActivator(){if(!this.personaActivator$yWn9){var previewPanelToolbarComp=
AS3.cast(com.coremedia.cms.editor.sdk.preview.PreviewPanelToolbar,this.findParentByType(com.coremedia.cms.editor.sdk.preview.PreviewPanelToolbar.xtype));if(previewPanelToolbarComp){var urlValueExpression=AS3.getBindable(previewPanelToolbarComp,"urlValueExpression","DUMMY");var urlParameterBean=AS3.cast(com.coremedia.cms.editor.sdk.preview.PreviewPanelBase,this.findParentByType(com.coremedia.cms.editor.sdk.preview.PreviewPanel.xtype)).getUrlParameterBean();this.personaActivator$yWn9=new com.coremedia.personalization.ui.persona.helper.PersonaActivator(urlValueExpression,
urlParameterBean)}}return this.personaActivator$yWn9}function addPath(path,groupHeaderLabel){if(arguments.length<=1)groupHeaderLabel="";this.getPersonaSelectorMenu$yWn9().addAdditionalPath(path,groupHeaderLabel)}function clearPath(){this.getPersonaSelectorMenu$yWn9().clearPaths()}function applyReusabilityState(state){this.activePersonaValueExpression$yWn9.setValue(state.persona)}function saveReusabilityState(){return{persona:this.activePersonaValueExpression$yWn9.getValue()}}return{extend:"Ext.button.Button",
mixins:["com.coremedia.ui.mixins.ValidationStateMixin"],metadata:{setContent:["InjectFromExtParent",["variableNameConfig","contentVariableName"]]},myPersonaSelector$yWn9:null,personaActivator$yWn9:null,currentContent$yWn9:null,currentContentValueExpression$yWn9:null,disabledValueExpression$yWn9:null,activePersonaValueExpression$yWn9:null,constructor:PersonaSelectorBase$,super$yWn9:function(){Ext.button.Button.prototype.constructor.apply(this,arguments)},personaChanged$yWn9:personaChanged,afterRender:afterRender,
showMenu:showMenu,onFocusLeave:onFocusLeave,onDestroy:onDestroy,listenToEvents$yWn9:listenToEvents,handlePreviewUrlChange$yWn9:handlePreviewUrlChange,setContent:setContent,getCurrentContentValueExpression$yWn9:getCurrentContentValueExpression,getDisabledValueExpression:getDisabledValueExpression,indicateActiveContextButton$yWn9:indicateActiveContextButton,getPersonaSelectorMenu$yWn9:getPersonaSelectorMenu,getPersonaActivator:getPersonaActivator,addPath:addPath,clearPath:clearPath,applyReusabilityState:applyReusabilityState,
saveReusabilityState:saveReusabilityState,statics:{MENU_ACTIVATED_EVENT:"menuActivated",MENU_DEACTIVATED_EVENT:"menuDeactivated",PERSONA_CHANGED_EVENT:"personaChanged"},requires:["Ext.button.Button","com.coremedia.cms.editor.sdk.preview.PreviewPanel","com.coremedia.cms.editor.sdk.preview.PreviewPanelBase","com.coremedia.cms.editor.sdk.preview.PreviewPanelToolbar","com.coremedia.ui.data.ValueExpressionFactory","com.coremedia.ui.mixins.ValidationState","com.coremedia.ui.mixins.ValidationStateMixin"],
uses:["com.coremedia.personalization.ui.persona.helper.PersonaActivator","com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItem",function(PersonaSelectorMenuItem){function PersonaSelectorMenuItem$(config){var this$=this;if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase,{});var defaults_$1=AS3.cast(PersonaSelectorMenuItem,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var layout_VBox_63_5_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_63_5_$1,
"align","stretch");AS3.setBindable(config_$1,"layout",layout_VBox_63_5_$1);var menuSeparator_66_5_$1=AS3.cast(Ext.menu.Separator,{});var container_67_5_$1=AS3.cast(Ext.container.Container,{});var ui_HorizontalSpacingPlugin_69_9_$1=AS3.cast(com.coremedia.ui.plugins.HorizontalSpacingPlugin,{});container_67_5_$1.plugins=[ui_HorizontalSpacingPlugin_69_9_$1];var layout_HBox_72_9_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(layout_HBox_72_9_$1,"align","middle");AS3.setBindable(container_67_5_$1,
"layout",layout_HBox_72_9_$1);var radio_75_9_$1=AS3.cast(Ext.form.field.Radio,{});radio_75_9_$1.name=net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"previewDocumentId")+com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.RADIO_BUTTON_NAME_SUFFIX);radio_75_9_$1.ariaLabel=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.selector.PersonaModels.forContent(AS3.getBindable(config,"personaContent")).getDisplayName());radio_75_9_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.RADIO_BUTTON_ITEM_ID_PREFIX+
AS3.as(AS3.getBindable(config,"personaContent"),Object).getNumericId());radio_75_9_$1.inputValue=net.jangaroo.ext.Exml.asString(AS3.as(AS3.getBindable(config,"personaContent"),Object).getNumericId()+com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.RADIO_BUTTON_VALUE_SUFFIX);var ui_Image_80_9_$1=AS3.cast(com.coremedia.ui.components.Image,{});AS3.setBindable(ui_Image_80_9_$1,"height",50);ui_Image_80_9_$1.itemId=net.jangaroo.ext.Exml.asString(PersonaSelectorMenuItem.PERSONA_IMAGE_ITEM_ID);
AS3.setBindable(ui_Image_80_9_$1,"width",50);AS3.setBindable(ui_Image_80_9_$1,"handler",AS3.bind(this,"selectRadioButton"));var ui_BindPropertyPlugin_85_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_85_13_$1.componentProperty="src";ui_BindPropertyPlugin_85_13_$1.bindTo=com.coremedia.personalization.ui.persona.selector.PersonaModels.forContent(AS3.getBindable(config,"personaContent")).getPersonaImageValueExpression();ui_BindPropertyPlugin_85_13_$1.ifUndefined=
Ext.getResourcePath(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.EMPTY_PERSONA_PIC_SRC,null,com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.EMPTY_PERSONA_PIC_PACKAGE_NAME);ui_Image_80_9_$1.plugins=[ui_BindPropertyPlugin_85_13_$1];var container_91_9_$1=AS3.cast(Ext.container.Container,{});container_91_9_$1.flex=1;container_91_9_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.PERSONA_INFO_ITEM_ID);
var layout_Anchor_93_13_$1=AS3.cast(Ext.layout.container.Anchor,{});AS3.setBindable(container_91_9_$1,"layout",layout_Anchor_93_13_$1);var displayField_97_13_$1=AS3.cast(Ext.form.field.Display,{});displayField_97_13_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.DisplayFieldSkin.BOLD.getSkin());var ui_BindPropertyPlugin_99_17_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_99_17_$1.componentProperty="value";ui_BindPropertyPlugin_99_17_$1.transformer=
com.coremedia.ui.util.EncodingUtil.encodeForHTML;ui_BindPropertyPlugin_99_17_$1.bindTo=this.getDisplayNameAndAgeValueExpression(config);displayField_97_13_$1.plugins=[ui_BindPropertyPlugin_99_17_$1];var ui_ExtendedDisplayField_105_13_$1=AS3.cast(com.coremedia.ui.components.ExtendedDisplayField,{});ui_ExtendedDisplayField_105_13_$1.htmlEncode=true;AS3.setBindable(ui_ExtendedDisplayField_105_13_$1,"overflowBehaviour",com.coremedia.ui.mixins.OverflowBehaviour.ELLIPSIS);AS3.setBindable(ui_ExtendedDisplayField_105_13_$1,
"width",160);var ui_BindPropertyPlugin_109_17_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_109_17_$1.componentProperty="value";ui_BindPropertyPlugin_109_17_$1.bindTo=com.coremedia.personalization.ui.persona.selector.PersonaModels.forContent(AS3.getBindable(config,"personaContent")).getExplicitInterestValueExpression();ui_ExtendedDisplayField_105_13_$1.plugins=[ui_BindPropertyPlugin_109_17_$1];container_91_9_$1.items=[displayField_97_13_$1,ui_ExtendedDisplayField_105_13_$1];
var ui_IconButton_116_9_$1=AS3.cast(com.coremedia.ui.components.IconButton,{});AS3.setBindable(ui_IconButton_116_9_$1,"scale","small");ui_IconButton_116_9_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.EDIT_BUTTON_ITEM_ID);AS3.setBindable(ui_IconButton_116_9_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons","information")));AS3.setBindable(ui_IconButton_116_9_$1,"handler",
function(b){AS3.getBindable(config,"personaPopupManager").showPersonaPopupForPersonaContent(AS3.getBindable(config,"entityExpression"),AS3.getBindable(config,"personaContent"),this$.getPersonaModel(),AS3.as(b.findParentByType(AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelector,{}).xtype),com.coremedia.personalization.ui.persona.selector.PersonaSelector),AS3.getBindable(config,"personaActivator"));this$.getParentMenu().hide()});var ui_BindPropertyPlugin_124_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,
{});ui_BindPropertyPlugin_124_13_$1.componentProperty="tooltip";ui_BindPropertyPlugin_124_13_$1.transformer=function(value){return Ext.String.format(this$.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_selector_open_info_button_tooltip"),value)};ui_BindPropertyPlugin_124_13_$1.bindTo=this.getDisplayNameAndAgeValueExpression(config);var ui_BindPropertyPlugin_129_13_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_129_13_$1.componentProperty=
"ariaLabel";ui_BindPropertyPlugin_129_13_$1.transformer=function(value){return Ext.String.format(this$.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_selector_open_info_button_tooltip"),value)};ui_BindPropertyPlugin_129_13_$1.bindTo=this.getDisplayNameAndAgeValueExpression(config);ui_IconButton_116_9_$1.plugins=[ui_BindPropertyPlugin_124_13_$1,ui_BindPropertyPlugin_129_13_$1];container_67_5_$1.items=[radio_75_9_$1,ui_Image_80_9_$1,container_91_9_$1,ui_IconButton_116_9_$1];
config_$1.items=[menuSeparator_66_5_$1,container_67_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$qiQA(config_$1)}return{extend:"com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase",alias:"widget.com.coremedia.personalization.ui.config.personaSelectorMenuItem",constructor:PersonaSelectorMenuItem$,super$qiQA:function(){com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.prototype.constructor.apply(this,arguments)},config:{entityExpression:null,
personaContent:null,personaActivator:null,previewDocumentId:null,personaPopupManager:null},statics:{PERSONA_IMAGE_ITEM_ID:"personaImage"},requires:["Ext","Ext.String","Ext.container.Container","Ext.form.field.Display","Ext.form.field.Radio","Ext.layout.container.Anchor","Ext.layout.container.HBox","Ext.layout.container.VBox","Ext.menu.Separator","com.coremedia.icons.CoreIcons_properties","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase",
"com.coremedia.ui.components.ExtendedDisplayField","com.coremedia.ui.components.IconButton","com.coremedia.ui.components.Image","com.coremedia.ui.mixins.OverflowBehaviour","com.coremedia.ui.plugins.BindPropertyPlugin","com.coremedia.ui.plugins.HorizontalSpacingPlugin","com.coremedia.ui.skins.DisplayFieldSkin","com.coremedia.ui.util.EncodingUtil","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.persona.selector.PersonaModels","com.coremedia.personalization.ui.persona.selector.PersonaSelector"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainer",function(PersonaSelectorGroupContainer){function PersonaSelectorGroupContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainerBase,{});var defaults_$1=AS3.cast(PersonaSelectorGroupContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var layout_VBox_37_5_$1=AS3.cast(Ext.layout.container.VBox,{});
AS3.setBindable(layout_VBox_37_5_$1,"pack","center");AS3.setBindable(layout_VBox_37_5_$1,"align","stretch");AS3.setBindable(config_$1,"layout",layout_VBox_37_5_$1);var container_40_5_$1=AS3.cast(Ext.container.Container,{});var layout_HBox_42_9_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(layout_HBox_42_9_$1,"align","middle");AS3.setBindable(container_40_5_$1,"layout",layout_HBox_42_9_$1);var displayField_45_9_$1=AS3.cast(Ext.form.field.Display,{});displayField_45_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.DisplayFieldSkin.BOLD.getSkin());
AS3.setBindable(displayField_45_9_$1,"value",AS3.getBindable(config,"groupLabel"));var ui_IconButton_48_9_$1=AS3.cast(com.coremedia.ui.components.IconButton,{});AS3.setBindable(ui_IconButton_48_9_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons","search")));AS3.setBindable(ui_IconButton_48_9_$1,"text",net.jangaroo.ext.Exml.asString(Ext.String.format(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_selector_group_button_tooltip"),
AS3.getBindable(config,"groupLabel"))));AS3.setBindable(ui_IconButton_48_9_$1,"tooltip",Ext.String.format(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_selector_group_button_tooltip"),AS3.getBindable(config,"groupLabel")));var editor_ShowRepositoryAction_52_13_$1=AS3.cast(com.coremedia.cms.editor.sdk.actions.ShowRepositoryAction,{});AS3.setBindable(editor_ShowRepositoryAction_52_13_$1,"preserveFolder",true);AS3.setBindable(editor_ShowRepositoryAction_52_13_$1,
"folder",AS3.getBindable(config,"folder"));ui_IconButton_48_9_$1.baseAction=new com.coremedia.cms.editor.sdk.actions.ShowRepositoryAction(editor_ShowRepositoryAction_52_13_$1);var component_56_9_$1=AS3.cast(Ext.Component,{});AS3.setBindable(component_56_9_$1,"width",10);container_40_5_$1.items=[displayField_45_9_$1,ui_IconButton_48_9_$1,component_56_9_$1];config_$1.items=[container_40_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$g_Gw(config_$1)}return{extend:"com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainerBase",
alias:"widget.com.coremedia.personalization.ui.config.personaSelectorGroupContainer",constructor:PersonaSelectorGroupContainer$,super$g_Gw:function(){com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainerBase.prototype.constructor.apply(this,arguments)},config:{folder:null,groupLabel:null},requires:["Ext.Component","Ext.String","Ext.container.Container","Ext.form.field.Display","Ext.layout.container.HBox","Ext.layout.container.VBox","com.coremedia.cms.editor.sdk.actions.ShowRepositoryAction",
"com.coremedia.icons.CoreIcons_properties","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainerBase","com.coremedia.ui.components.IconButton","com.coremedia.ui.skins.DisplayFieldSkin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaFolderObserver",function(PersonaFolderObserver){function PersonaFolderObserver$(path,contentType){this.super$xD0T();this.path$xD0T=path;this.contentType$xD0T=contentType}function find(callback){this.addPersonasFromFolder$xD0T(callback)}function addPersonasFromFolder(callback){var this$=this;com.coremedia.cap.common.SESSION.getConnection().getContentRepository().getChild(this.path$xD0T,function getFolderChildren(folder){if(folder!=
null){var searchParams=AS3.cast(com.coremedia.cap.content.search.SearchParameters,{});searchParams.folder=folder.getUriPath();searchParams.includeSubfolders=false;searchParams.contentType=[this$.contentType$xD0T];searchParams.filterQuery=["isdeleted:false"];this$.doFolderSearch$xD0T(folder,searchParams,callback)}else callback()})}function doFolderSearch(folder,searchParams,callback){var searchService=folder.getRepository().getSearchService();var searchResult=searchService.search(searchParams);searchResult.load(function(result){callback(result,
folder)})}return{extend:"Ext.util.Observable",path$xD0T:null,contentType$xD0T:null,constructor:PersonaFolderObserver$,super$xD0T:function(){Ext.util.Observable.prototype.constructor.apply(this,arguments)},find:find,addPersonasFromFolder$xD0T:addPersonasFromFolder,doFolderSearch$xD0T:doFolderSearch,requires:["Ext.util.Observable","com.coremedia.cap.common.SESSION","com.coremedia.cap.content.search.SearchParameters"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu",function(PersonaSelectorMenu){function PersonaSelectorMenu$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase,{});var defaults_$1=AS3.cast(PersonaSelectorMenu,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);config_$1.ignoreParentClicks=true;config_$1.itemId="personaSelectorMenu";AS3.setBindable(config_$1,"width",300);
config_$1.plain=true;config_$1.ignoreInputFields=false;config_$1.tabNavigationMode=ext.mixin.AdvancedFocusableContainerMixin.TAB_NAVIGATION_MODE_ONLY;var layout_VBox_49_5_$1=AS3.cast(Ext.layout.container.VBox,{});AS3.setBindable(layout_VBox_49_5_$1,"align","stretch");AS3.setBindable(config_$1,"layout",layout_VBox_49_5_$1);var radio_52_5_$1=AS3.cast(Ext.form.field.Radio,{});radio_52_5_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase.NO_PERSONA_RADIO_BUTTON_ITEM_ID);
AS3.setBindable(radio_52_5_$1,"boxLabel",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_selector_nothing_selected_label")));var ui_BindPropertyPlugin_55_9_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_55_9_$1.componentProperty="name";ui_BindPropertyPlugin_55_9_$1.transformer=com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase.transformToNumericId;ui_BindPropertyPlugin_55_9_$1.bindTo=
AS3.getBindable(config,"contentValueExpression");radio_52_5_$1.plugins=[ui_BindPropertyPlugin_55_9_$1];var container_61_5_$1=AS3.cast(Ext.container.Container,{});container_61_5_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase.ITEMS_CONTAINER_ITEM_ID);config_$1.items=[radio_52_5_$1,container_61_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$znhN(config_$1)}return{extend:"com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase",
alias:"widget.com.coremedia.personalization.ui.config.personaSelectorMenu",constructor:PersonaSelectorMenu$,super$znhN:function(){com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase.prototype.constructor.apply(this,arguments)},config:{contentValueExpression:null,docType:null,paths:null,defaultGroupHeaderLabel:null,personaActivatorFn:null},requires:["Ext.container.Container","Ext.form.field.Radio","Ext.layout.container.VBox","com.coremedia.personalization.ui.Personalization_properties",
"com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase","com.coremedia.ui.plugins.BindPropertyPlugin","ext.mixin.AdvancedFocusableContainerMixin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaModels",function(PersonaModels){var byUriPath$static;function byUriPath$static_(){byUriPath$static={}}function forContent$static(content){var uriPath=content.getUriPath();if(!byUriPath$static[uriPath])byUriPath$static[uriPath]=new com.coremedia.personalization.ui.persona.selector.PersonaModel(content);return byUriPath$static[uriPath]}function PersonaModels$(){}return{constructor:PersonaModels$,statics:{byUriPath:undefined,forContent:forContent$static,
__initStatics__:function(){byUriPath$static_()}},uses:["com.coremedia.personalization.ui.persona.selector.PersonaModel"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainerBase",function(PersonaSelectorGroupContainerBase){function menuItems_(){this.menuItems$Qh8h=[]}function PersonaSelectorGroupContainerBase$(config){if(arguments.length<=0)config=null;this.super$Qh8h(config);menuItems_.call(this);this.itemCount$Qh8h=0}function addPersonaMenuItemByOrder(menuItem,maxItemsInFolder){this.menuItems$Qh8h.push(menuItem);this.itemCount$Qh8h++;if(this.itemCount$Qh8h===maxItemsInFolder){this.menuItems$Qh8h.sort(AS3.bind(this,
"sortByDisplayName$Qh8h"));this.add(this.menuItems$Qh8h)}}function addNoPersonaItems(){this.hide()}function sortByDisplayName(a,b){var nameA=a.getPersonaModel().getDisplayName().toLowerCase();var nameB=b.getPersonaModel().getDisplayName().toLowerCase();return nameA.localeCompare(nameB)}return{extend:"Ext.container.Container",itemCount$Qh8h:NaN,constructor:PersonaSelectorGroupContainerBase$,super$Qh8h:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},addPersonaMenuItemByOrder:addPersonaMenuItemByOrder,
addNoPersonaItems:addNoPersonaItems,sortByDisplayName$Qh8h:sortByDisplayName,statics:{PERSONA_LOADING_ITEM_ID:"personaLoading"},requires:["Ext.container.Container"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase",function(PersonaSelectorMenuBase){function additionalPaths_(){this.additionalPaths$pr98={}}var PERSONA_MENU_ITEM_PREFIX$static="menuItem-";function PersonaSelectorMenuBase$(config){var this$=this;if(arguments.length<=0)config=null;this.super$pr98(config);additionalPaths_.call(this);this.contentValueExpression$pr98=AS3.getBindable(config,"contentValueExpression");this.personaActivatorFn$pr98=AS3.getBindable(config,
"personaActivatorFn");this.defaultGroupHeaderLabel$pr98=AS3.getBindable(config,"defaultGroupHeaderLabel")||"System";this.contentType$pr98=AS3.getBindable(config,"docType");this.initialSystemPaths$pr98=AS3.getBindable(config,"paths");this.on(com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase.MENU_ACTIVATED_EVENT,AS3.bind(this,"menuActivated$pr98"));this.mon(this.getNoPersonaRadioBtn$pr98(),"change",function(radio,newValue){if(newValue)this$.personaActivatorFn$pr98().setNoPersonaActive()})}
function transformToNumericId$static(value){var myId=getMyId$static(value);return myId?myId+com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase.RADIO_BUTTON_NAME_SUFFIX:""}function collapseMenu(){this.hide()}function onFocusLeave(e){}function menuActivated(){this.getNoPersonaRadioBtn$pr98().hide();this.getItemsContainer$pr98().hide();this.removeAllMenuItems$pr98();var exeEvt=new com.coremedia.ui.util.ExecuteEventually(AS3.bind(this,"fillMenu$pr98"));this.addInitialSystemPathPersonas$pr98(exeEvt);
this.addPluggedInSiteSpecificPersonas$pr98(exeEvt);exeEvt.proceed()}function fillMenu(){this.on("afterlayout",AS3.bind(this,"onAfterLayout$pr98"));this.getNoPersonaRadioBtn$pr98().show();this.getItemsContainer$pr98().show()}function onAfterLayout(){var personaActivator=this.personaActivatorFn$pr98.call();if(!personaActivator.isAnyPersonaActive()){this.getNoPersonaRadioBtn$pr98().setValue(true);if(!this.getNoPersonaRadioBtn$pr98().isHidden())this.getNoPersonaRadioBtn$pr98().focus()}}function addInitialSystemPathPersonas(exeEvt){var this$=
this;this.initialSystemPaths$pr98.forEach(function(path){exeEvt.delay();(new com.coremedia.personalization.ui.persona.selector.PersonaFolderObserver(path,this$.contentType$pr98)).find(function(searchResult,folder){if(searchResult&&folder)this$.addAllItemsFromSearchResult$pr98(searchResult,folder,this$.defaultGroupHeaderLabel$pr98,0,exeEvt);exeEvt.proceed()})})}function addPluggedInSiteSpecificPersonas(exeEvt){var this$=this;for(var path in this.additionalPaths$pr98)if(this.additionalPaths$pr98.hasOwnProperty(path)){var groupLabel=
this.additionalPaths$pr98[path];exeEvt.delay();(new com.coremedia.personalization.ui.persona.selector.PersonaFolderObserver(path,this.contentType$pr98)).find(function(searchResult,folder){if(searchResult&&folder)this$.addAllItemsFromSearchResult$pr98(searchResult,folder,groupLabel,undefined,exeEvt);exeEvt.proceed()})}}function addAllItemsFromSearchResult(result,folder,groupHeaderLabel,positionInMenu,exeEvt){var this$=this;var groupContainer=this.addGroupContainer$pr98(folder,groupHeaderLabel,positionInMenu);
var maxItemsInFolder=result.getHits().length;if(maxItemsInFolder>0)result.getHits().forEach(function(personaContent){exeEvt.delay();personaContent.load(function(bean){this$.addProfileMenuItem$pr98(personaContent,groupContainer,maxItemsInFolder,exeEvt);exeEvt.proceed()})});else groupContainer.addNoPersonaItems()}function addProfileMenuItem(personaContent,groupContainer,maxItemsInFolder,exeEvt){var createItemWithItemId=PERSONA_MENU_ITEM_PREFIX$static+com.coremedia.ui.util.IdUtil.parseContentId(personaContent.getId());
if(!this.queryById(createItemWithItemId)){var menuItemConfig=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItem,{});menuItemConfig.itemId=createItemWithItemId;AS3.setBindable(menuItemConfig,"entityExpression",this.contentValueExpression$pr98);AS3.setBindable(menuItemConfig,"personaContent",personaContent);AS3.setBindable(menuItemConfig,"previewDocumentId",this.getNumericPreviewDocumentId$pr98());AS3.setBindable(menuItemConfig,"personaPopupManager",this.getPersonaPopupManager());
AS3.setBindable(menuItemConfig,"personaActivator",this.personaActivatorFn$pr98());var menuItem=new com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItem(menuItemConfig);exeEvt.delay();menuItem.getPersonaModel().load(function(){groupContainer.addPersonaMenuItemByOrder(menuItem,maxItemsInFolder);exeEvt.proceed()})}}function getPersonaPopupManager(){if(!this.personaPopupManagerInstance$pr98)this.personaPopupManagerInstance$pr98=new com.coremedia.personalization.ui.persona.popup.PersonaPopupManager;
return this.personaPopupManagerInstance$pr98}function addGroupContainer(folder,groupHeaderLabel,positionInMenu){var menuGroupContainerConfig=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainer,{});menuGroupContainerConfig.itemId=PersonaSelectorMenuBase.GROUP_CONTAINER_ITEM_ID_PREFIX+folder["getNumericId"]();AS3.setBindable(menuGroupContainerConfig,"groupLabel",groupHeaderLabel);AS3.setBindable(menuGroupContainerConfig,"folder",folder);var menuGroupContainer;var itemsContainer=
this.getItemsContainer$pr98();menuGroupContainer=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainer,positionInMenu!=undefined?itemsContainer.insert(positionInMenu,menuGroupContainerConfig):itemsContainer.add(menuGroupContainerConfig));return menuGroupContainer}function getNumericPreviewDocumentId(){return getMyId$static(this.contentValueExpression$pr98.getValue())}function getMyId$static(value){if(AS3.is(value,com.coremedia.cap.content.Content))return""+com.coremedia.cap.common.IdHelper.parseContentId(value);
else if(AS3.is(value,com.coremedia.ui.data.RemoteBean))return AS3.cast(com.coremedia.ui.data.RemoteBean,value).getUriPath()}function removeAllMenuItems(){var this$=this;this.query(com.coremedia.ui.util.createComponentSelector()._xtype(com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainer.xtype).build()).forEach(function(item){this$.getItemsContainer$pr98().remove(item,true)})}function addAdditionalPath(path,groupHeaderLabel){if(arguments.length<=1)groupHeaderLabel="";this.additionalPaths$pr98[path]=
groupHeaderLabel||"site"}function clearPaths(){this.additionalPaths$pr98={};this.initialSystemPaths$pr98=[]}function getItemsContainer(){if(!this.itemsContainer$pr98)this.itemsContainer$pr98=AS3.as(this.queryById(PersonaSelectorMenuBase.ITEMS_CONTAINER_ITEM_ID),Ext.container.Container);return this.itemsContainer$pr98}function getNoPersonaRadioBtn(){if(!this.radioBtn$pr98)this.radioBtn$pr98=AS3.as(this.queryById(PersonaSelectorMenuBase.NO_PERSONA_RADIO_BUTTON_ITEM_ID),Ext.form.field.Radio);return this.radioBtn$pr98}
function destroy(){var params=Array.prototype.slice.call(arguments);Ext.menu.Menu.prototype.destroy.call(this,params);this.personaPopupManagerInstance$pr98&&this.personaPopupManagerInstance$pr98.destroy()}return{extend:"Ext.menu.Menu",itemsContainer$pr98:null,radioBtn$pr98:null,contentType$pr98:null,defaultGroupHeaderLabel$pr98:null,initialSystemPaths$pr98:null,personaPopupManagerInstance$pr98:null,personaActivatorFn$pr98:null,contentValueExpression$pr98:null,constructor:PersonaSelectorMenuBase$,
super$pr98:function(){Ext.menu.Menu.prototype.constructor.apply(this,arguments)},collapseMenu:collapseMenu,onFocusLeave:onFocusLeave,menuActivated$pr98:menuActivated,fillMenu$pr98:fillMenu,onAfterLayout$pr98:onAfterLayout,addInitialSystemPathPersonas$pr98:addInitialSystemPathPersonas,addPluggedInSiteSpecificPersonas$pr98:addPluggedInSiteSpecificPersonas,addAllItemsFromSearchResult$pr98:addAllItemsFromSearchResult,addProfileMenuItem$pr98:addProfileMenuItem,getPersonaPopupManager:getPersonaPopupManager,
addGroupContainer$pr98:addGroupContainer,getNumericPreviewDocumentId$pr98:getNumericPreviewDocumentId,removeAllMenuItems$pr98:removeAllMenuItems,addAdditionalPath:addAdditionalPath,clearPaths:clearPaths,getItemsContainer$pr98:getItemsContainer,getNoPersonaRadioBtn$pr98:getNoPersonaRadioBtn,destroy:destroy,statics:{ITEMS_CONTAINER_ITEM_ID:"menuItems",GROUP_CONTAINER_ITEM_ID_PREFIX:"groupContainer-",NO_PERSONA_RADIO_BUTTON_ITEM_ID:"noPersonaRadioButton",transformToNumericId:transformToNumericId$static},
requires:["Ext.container.Container","Ext.form.field.Radio","Ext.menu.Menu","com.coremedia.cap.common.IdHelper","com.coremedia.cap.content.Content","com.coremedia.ui.data.RemoteBean","com.coremedia.ui.util.ExecuteEventually","com.coremedia.ui.util.IdUtil","com.coremedia.ui.util.createComponentSelector"],uses:["com.coremedia.personalization.ui.persona.popup.PersonaPopupManager","com.coremedia.personalization.ui.persona.selector.PersonaFolderObserver","com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase",
"com.coremedia.personalization.ui.persona.selector.PersonaSelectorGroupContainer","com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItem","com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaModel",function(PersonaModel){var STRUCT_PROPERTY_PROFILE_PICTURE$static="profileImage";var STRUCT_PROPERTY_PROFILE_EXPLICIT_INTEREST$static="explicit";var STRUCT_PROPERTY_PROFILE_IMPLICIT_INTEREST$static="subjectTaxonomies";var STRUCT_PROPERTY_PROFILE_IMPLICIT_INTEREST_VALUE$static="subjectTaxonomies_count";function PersonaModel$(content){this.super$fGnG();this.content$fGnG=content;com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,
"content",null,content);content.load(AS3.bind(this,"contentLoaded$fGnG"))}function getContent(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"content");return this.content$fGnG}function contentLoaded(){this.content$fGnG.addPropertyChangeListener(com.coremedia.cap.content.ContentPropertyNames.NAME,AS3.bind(this,"updateName$fGnG"));this.updateName$fGnG();this.profileExtensionRemoteBean$fGnG=AS3.as(this.content$fGnG.getProperties().get("profileExtensions"),com.coremedia.ui.data.RemoteBean);
this.profileExtensionRemoteBean$fGnG.load(AS3.bind(this,"profileExtensionsLoaded"))}function profileExtensionsLoaded(){this.profileExtensionRemoteBean$fGnG.addValueChangeListener(AS3.bind(this,"updateProfileExtensions"));this.updateProfileExtensions();var profileSettingsBlob=AS3.as(this.content$fGnG.getProperties().get("profileSettings"),com.coremedia.ui.data.Blob);if(profileSettingsBlob)profileSettingsBlob.loadData(AS3.bind(this,"profileSettingsBlobLoaded$fGnG"));else this.profileSettingsBlobLoaded$fGnG()}
function profileSettingsBlobLoaded(){this.profileSettingsDataValueExpression$fGnG=com.coremedia.ui.data.ValueExpressionFactory.create("profileSettings.data",this.content$fGnG.getProperties());this.profileSettingsDataValueExpression$fGnG.addChangeListener(AS3.bind(this,"updateProfileSettingsBlob"));this.updateProfileSettingsBlob();this.loaded$fGnG=true;com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"loaded",false,true)}function updateName(){this.setPersonaName$fGnG(this.content$fGnG.getName())}
function updateProfileExtensions(){if(this.profileExtensionRemoteBean$fGnG&&this.profileExtensionRemoteBean$fGnG.get("properties")){var properties=this.profileExtensionRemoteBean$fGnG.get("properties");this.updatePersonaImage$fGnG(properties.get(STRUCT_PROPERTY_PROFILE_PICTURE$static))}}function updateProfileSettingsBlob(){var profileSettings=this.profileSettingsDataValueExpression$fGnG.getValue();var oldPersonaProfileBean=this.personaProfileBean$fGnG;if(profileSettings){this.personaProfileBean$fGnG=
com.coremedia.personalization.ui.util.PersonaContextHelper.beanFromPropertiesString(profileSettings.toString());var oldProfileSettingsAsGroupArray=this.profileSettingsAsGroupArray$fGnG;this.profileSettingsAsGroupArray$fGnG=com.coremedia.personalization.ui.util.PersonaContextHelper.groupArrayFromPropertiesString(profileSettings);com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"profileSettingsAsGroupArray",oldProfileSettingsAsGroupArray,this.profileSettingsAsGroupArray$fGnG)}else this.personaProfileBean$fGnG=
com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean();this.setGivenName$fGnG(this.personaProfileBean$fGnG.get(PersonaModel.PROPERTY_PERSONAL_GIVENNAME));this.setFamilyName$fGnG(this.personaProfileBean$fGnG.get(PersonaModel.PROPERTY_PERSONAL_FAMILYNAME));this.setBirthdayFromString$fGnG(this.personaProfileBean$fGnG.get(PersonaModel.PROPERTY_PERSONAL_BIRTHDAY));this.setCityLocation$fGnG(this.personaProfileBean$fGnG.get(PersonaModel.PROPERTY_LOCATION_CITY));this.personaProfileBean$fGnG.set(PersonaModel.PROPERTY_DISPLAYNAME,
this.getDisplayName());this.personaProfileBean$fGnG.set(PersonaModel.PROPERTY_AGE,this.getAge());com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"personaProfileBean",oldPersonaProfileBean,this.personaProfileBean$fGnG)}function extendPersonaProfileBeanBy(propertyName,propertyValue){if(!this.personaProfileBean$fGnG){this.personaProfileBean$fGnG=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean();com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,
"personaProfileBean",undefined,this.personaProfileBean$fGnG)}this.personaProfileBean$fGnG.set(propertyName,propertyValue)}function load(callback){if(this.loaded$fGnG)callback();else this.on("loaded",callback,null,{single:true})}function getPersonaProfileBean(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"personaProfileBean");return this.personaProfileBean$fGnG}function getPersonaName(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"personaName");
return this.personaName$fGnG===null?undefined:this.personaName$fGnG}function setPersonaName(personaName){var oldPersonaName=this.personaName$fGnG;this.personaName$fGnG=personaName;com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"personaName",oldPersonaName,personaName)}function getGivenName(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"givenName");return this.givenName$fGnG===null?undefined:this.givenName$fGnG}function setGivenName(givenName){var oldGivenName=
this.givenName$fGnG;this.givenName$fGnG=givenName;com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"givenName",oldGivenName,givenName)}function getFamilyName(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"familyName");return this.familyName$fGnG===null?undefined:this.familyName$fGnG}function setFamilyName(familyName){var oldFamilyName=this.familyName$fGnG;this.familyName$fGnG=familyName;com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,
"familyName",oldFamilyName,familyName)}function getCityLocation(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"cityLocation");return this.location$fGnG===null?undefined:this.location$fGnG}function setCityLocation(location){var oldLocation=this.location$fGnG;this.location$fGnG=location;com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"cityLocation",oldLocation,location)}function getBirthday(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,
"birthday");return this.birthday$fGnG===null?undefined:this.birthday$fGnG}function setBirthdayFromString(birthdayString){if(birthdayString){var oldBirthday=this.birthday$fGnG;var oldAge=this.getAge();var a=birthdayString.split("T");var d=a[0].split("-");this.birthday$fGnG=new Date(d[0],d[1]-1,d[2]);com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"birthday",oldBirthday,this.birthday$fGnG);com.coremedia.ui.data.util.PropertyChangeEventUtil.fireEvent(this,"age",oldAge,AS3.bind(this,
"getAge"))}}function getAge(){com.coremedia.ui.data.dependencies.DependencyTracker.dependOnObservable(this,"birthday");if(this.birthday$fGnG)return Math.floor(((new Date).getTime()-this.birthday$fGnG.getTime())/1E3/(60*60*24)/365.25);else return undefined}function updatePersonaImage(personaImage){var this$=this;if(personaImage&&personaImage.length===1)AS3.as(personaImage[0],com.coremedia.cap.content.Content).load(function(bean){var imageBlob=bean.get("properties").get("data");imageBlob.loadData(function(blob){this$.getPersonaImageValueExpression().setValue(blob.getUri());
this$.extendPersonaProfileBeanBy$fGnG(PersonaModel.PROPERTY_PERSONA_IMAGE,blob.getUri())})});else this.extendPersonaProfileBeanBy$fGnG(PersonaModel.PROPERTY_PERSONA_IMAGE,undefined)}function computeExplicitInterest(){var currentContent=this.getContent$fGnG();if(!currentContent)return undefined;var contentProperties=this.content$fGnG.getProperties();if(!contentProperties)return undefined;var profileExtensionRemoteBean=AS3.as(contentProperties.get("profileExtensions"),com.coremedia.ui.data.RemoteBean);
if(!profileExtensionRemoteBean)return undefined;var properties=profileExtensionRemoteBean.get("properties");if(!properties)return undefined;var explicitInterests=properties.get(STRUCT_PROPERTY_PROFILE_EXPLICIT_INTEREST$static);if(!explicitInterests||explicitInterests.length===0)return undefined;var nameArray=[];var returnUndefined=false;for(var i=0;i<explicitInterests.length;i++){var bean=explicitInterests[i];var beanProperties=bean.get("properties");if(beanProperties)nameArray.push(beanProperties.get("value"));
else returnUndefined=true}return returnUndefined?undefined:nameArray.join(", ")}function computeImplicitInterest(){var currentContent=this.getContent$fGnG();if(!currentContent)return undefined;var contentProperties=this.content$fGnG.getProperties();if(!contentProperties)return undefined;var profileExtensionRemoteBean=AS3.as(contentProperties.get("profileExtensions"),com.coremedia.ui.data.RemoteBean);if(!profileExtensionRemoteBean)return undefined;var properties=profileExtensionRemoteBean.get("properties");
if(!properties)return undefined;var implicitInterests=properties.get(STRUCT_PROPERTY_PROFILE_IMPLICIT_INTEREST$static);if(!implicitInterests||implicitInterests.length===0)return undefined;var implicitInterestsValues=properties.get(STRUCT_PROPERTY_PROFILE_IMPLICIT_INTEREST_VALUE$static);var nameArray=[];var returnUndefined=false;for(var i=0;i<implicitInterests.length;i++){var bean=implicitInterests[i];var beanProperties=bean.get("properties");if(beanProperties)nameArray.push(beanProperties.get("value"));
else returnUndefined=true}return returnUndefined?undefined:new com.coremedia.personalization.ui.persona.helper.PersonaImplicitInterestHelper(nameArray,implicitInterestsValues)}function getPersonaImageValueExpression(){if(!this.personaImageValueExp$fGnG)this.personaImageValueExp$fGnG=com.coremedia.ui.data.ValueExpressionFactory.createFromValue(undefined);return this.personaImageValueExp$fGnG}function getExplicitInterestValueExpression(){if(!this.explicitInterestValueExp$fGnG)this.explicitInterestValueExp$fGnG=
com.coremedia.ui.data.ValueExpressionFactory.createFromFunction(AS3.bind(this,"computeExplicitInterest$fGnG"));return this.explicitInterestValueExp$fGnG}function getImplicitInterestValueExpression(){if(!this.implicitInterestValueExp$fGnG)this.implicitInterestValueExp$fGnG=com.coremedia.ui.data.ValueExpressionFactory.createFromFunction(AS3.bind(this,"computeImplicitInterest$fGnG"));return this.implicitInterestValueExp$fGnG}function getProfileSettingsAsGroupArray(){return this.profileSettingsAsGroupArray$fGnG}
function getDisplayName(){var fullName="";this.getGivenName()&&(fullName+=this.getGivenName()+" ");this.getFamilyName()&&(fullName+=this.getFamilyName());return fullName.length===0?this.getPersonaName():fullName}return{extend:"Ext.util.Observable",content$fGnG:null,profileSettingsDataValueExpression$fGnG:null,profileExtensionRemoteBean$fGnG:null,loaded$fGnG:false,personaName$fGnG:null,givenName$fGnG:null,familyName$fGnG:null,location$fGnG:null,birthday$fGnG:null,profileSettings$fGnG:null,profileSettingsAsGroupArray$fGnG:null,
personaImageValueExp$fGnG:null,explicitInterestValueExp$fGnG:null,implicitInterestValueExp$fGnG:null,personaProfileBean$fGnG:null,constructor:PersonaModel$,super$fGnG:function(){Ext.util.Observable.prototype.constructor.apply(this,arguments)},getContent$fGnG:getContent,contentLoaded$fGnG:contentLoaded,profileExtensionsLoaded:profileExtensionsLoaded,profileSettingsBlobLoaded$fGnG:profileSettingsBlobLoaded,updateName$fGnG:updateName,updateProfileExtensions:updateProfileExtensions,updateProfileSettingsBlob:updateProfileSettingsBlob,
extendPersonaProfileBeanBy$fGnG:extendPersonaProfileBeanBy,load:load,getPersonaProfileBean:getPersonaProfileBean,getPersonaName:getPersonaName,setPersonaName$fGnG:setPersonaName,getGivenName:getGivenName,setGivenName$fGnG:setGivenName,getFamilyName:getFamilyName,setFamilyName$fGnG:setFamilyName,getCityLocation:getCityLocation,setCityLocation$fGnG:setCityLocation,getBirthday:getBirthday,setBirthdayFromString$fGnG:setBirthdayFromString,getAge:getAge,updatePersonaImage$fGnG:updatePersonaImage,computeExplicitInterest$fGnG:computeExplicitInterest,
computeImplicitInterest$fGnG:computeImplicitInterest,getPersonaImageValueExpression:getPersonaImageValueExpression,getExplicitInterestValueExpression:getExplicitInterestValueExpression,getImplicitInterestValueExpression:getImplicitInterestValueExpression,getProfileSettingsAsGroupArray:getProfileSettingsAsGroupArray,getDisplayName:getDisplayName,statics:{PROPERTY_DISPLAYNAME:"displayName",PROPERTY_AGE:"age",PROPERTY_PERSONAL_GIVENNAME:"personal!givenname",PROPERTY_PERSONAL_FAMILYNAME:"personal!familyname",
PROPERTY_LOCATION_CITY:"location!city",PROPERTY_PERSONAL_BIRTHDAY:"personal!dateofbirth",PROPERTY_PERSONA_IMAGE:"image"},requires:["Ext.util.Observable","com.coremedia.cap.content.Content","com.coremedia.cap.content.ContentPropertyNames","com.coremedia.cms.editor.sdk.editorContext","com.coremedia.ui.data.Blob","com.coremedia.ui.data.RemoteBean","com.coremedia.ui.data.ValueExpressionFactory","com.coremedia.ui.data.dependencies.DependencyTracker","com.coremedia.ui.data.util.PropertyChangeEventUtil"],
uses:["com.coremedia.personalization.ui.persona.helper.PersonaImplicitInterestHelper","com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuItemBase",function(PersonaSelectorMenuItemBase){function PersonaSelectorMenuItemBase$(config){if(arguments.length<=0)config=null;this.personaContent$j_nx=AS3.getBindable(config,"personaContent");this.personaActivator$j_nx=AS3.getBindable(config,"personaActivator");this.super$j_nx(config);this.personaModel$j_nx=com.coremedia.personalization.ui.persona.selector.PersonaModels.forContent(this.personaContent$j_nx)}function initComponent(){var this$=
this;Ext.container.Container.prototype.initComponent.call(this);this.mon(this.getPersonaInfo$j_nx(),"afterrender",function(){this$.mon(this$.getPersonaInfo$j_nx().getEl(),"click",AS3.bind(this$,"selectRadioButton"))})}function afterRender(){var this$=this;Ext.container.Container.prototype.afterRender.call(this);this.getRadioBtn$j_nx().setValue(this.personaActivator$j_nx.isActive(this.personaContent$j_nx));if(this.getRadioBtn$j_nx().getValue())this.getRadioBtn$j_nx().focus();this.mon(this.getRadioBtn$j_nx(),
"focus",function(){this$.getRadioBtn$j_nx().setValue(true)});this.mon(this.getRadioBtn$j_nx(),"change",function(radio,newValue){if(newValue)this$.personaActivator$j_nx.setActive(this$.personaContent$j_nx)})}function getDisplayNameAndAgeValueExpression(config){if(!this.displayNameAndAgeValueExp$j_nx)this.displayNameAndAgeValueExp$j_nx=com.coremedia.ui.data.ValueExpressionFactory.createFromFunction(computeDisplayNameAndAge$static,AS3.getBindable(config,"personaContent"));return this.displayNameAndAgeValueExp$j_nx}
function computeDisplayNameAndAge$static(personaContent){var personaModel=com.coremedia.personalization.ui.persona.selector.PersonaModels.forContent(personaContent);var result=personaModel.getDisplayName();if(personaModel.getAge()!==undefined)result=result.concat(", "+personaModel.getAge());return result}function getRadioBtn(){if(!this.radioBtn$j_nx)this.radioBtn$j_nx=AS3.as(this.queryById(PersonaSelectorMenuItemBase.RADIO_BUTTON_ITEM_ID_PREFIX+AS3.as(this.personaContent$j_nx,Object).getNumericId()),
Ext.form.field.Radio);return this.radioBtn$j_nx}function getPersonaModel(){return this.personaModel$j_nx}function getParentMenu(){if(!this.parentMenu$j_nx)this.parentMenu$j_nx=AS3.as(this.findParentByType(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu.xtype),com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase);return this.parentMenu$j_nx}function getPersonaInfo(){if(!this.personaInfo$j_nx)this.personaInfo$j_nx=AS3.as(this.queryById(PersonaSelectorMenuItemBase.PERSONA_INFO_ITEM_ID),
Ext.container.Container);return this.personaInfo$j_nx}function selectRadioButton(){var radioButton=this.getRadioBtn$j_nx();radioButton.setValue(true);radioButton.focus()}return{extend:"Ext.container.Container",personaContent$j_nx:null,personaModel$j_nx:null,displayNameAndAgeValueExp$j_nx:null,radioBtn$j_nx:null,parentMenu$j_nx:null,personaActivator$j_nx:null,personaInfo$j_nx:null,constructor:PersonaSelectorMenuItemBase$,super$j_nx:function(){Ext.container.Container.prototype.constructor.apply(this,
arguments)},initComponent:initComponent,afterRender:afterRender,getDisplayNameAndAgeValueExpression:getDisplayNameAndAgeValueExpression,getRadioBtn$j_nx:getRadioBtn,getPersonaModel:getPersonaModel,getParentMenu:getParentMenu,getPersonaInfo$j_nx:getPersonaInfo,selectRadioButton:selectRadioButton,statics:{RADIO_BUTTON_NAME_SUFFIX:"-radioName",RADIO_BUTTON_VALUE_SUFFIX:"-radioValue",RADIO_BUTTON_ITEM_ID_PREFIX:"radioItem-",EMPTY_PERSONA_PIC_SRC:"persona_empty_icon_neutral_50.png",EMPTY_PERSONA_PIC_PACKAGE_NAME:"com.coremedia.personalization__cap-personalization-ui",
EDIT_BUTTON_ITEM_ID:"editButton",PERSONA_INFO_ITEM_ID:"personaInfo"},requires:["Ext.container.Container","Ext.form.field.Radio","com.coremedia.ui.data.ValueExpressionFactory"],uses:["com.coremedia.personalization.ui.persona.selector.PersonaModels","com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu","com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenuBase"]}});Ext.define("com.coremedia.personalization.ui.persona.selector.PersonaSelector",function(PersonaSelector){function PersonaSelector$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase,{});var defaults_$1=AS3.cast(PersonaSelector,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons",
"user")));config_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.WORKAREA.getSkin());AS3.setBindable(config_$1,"scale","medium");config_$1.ariaLabel=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_open_menu_button"));AS3.setBindable(config_$1,"tooltip",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_popup_open_menu_button"));config_$1.menuAlign=
"tr-br";var ui_BindPropertyPlugin_49_5_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_49_5_$1.componentProperty="disabled";ui_BindPropertyPlugin_49_5_$1.bindTo=this.getDisabledValueExpression();var editor_ReusabilityComponentStatePlugin_51_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.desktop.reusability.ReusabilityComponentStatePlugin,{});editor_ReusabilityComponentStatePlugin_51_5_$1.stateId=net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"itemId","DUMMY"));
editor_ReusabilityComponentStatePlugin_51_5_$1.bindTo=AS3.getBindable(config,"contentValueExpression");editor_ReusabilityComponentStatePlugin_51_5_$1.events=[com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase.PERSONA_CHANGED_EVENT];editor_ReusabilityComponentStatePlugin_51_5_$1.applyStateFn=AS3.bind(this,"applyReusabilityState");editor_ReusabilityComponentStatePlugin_51_5_$1.saveStateFn=AS3.bind(this,"saveReusabilityState");config_$1.plugins=[ui_BindPropertyPlugin_49_5_$1,editor_ReusabilityComponentStatePlugin_51_5_$1];
var perso_PersonaSelectorMenu_58_5_$1=AS3.cast(com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu,{});AS3.setBindable(perso_PersonaSelectorMenu_58_5_$1,"paths",AS3.getBindable(config,"paths")||["/System/personalization/profiles"]);AS3.setBindable(perso_PersonaSelectorMenu_58_5_$1,"defaultGroupHeaderLabel",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"defaultGroupHeaderLabel")));AS3.setBindable(perso_PersonaSelectorMenu_58_5_$1,"docType",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,
"docType")||"CMUserProfile"));AS3.setBindable(perso_PersonaSelectorMenu_58_5_$1,"personaActivatorFn",AS3.bind(this,"getPersonaActivator"));AS3.setBindable(perso_PersonaSelectorMenu_58_5_$1,"contentValueExpression",AS3.getBindable(config,"contentValueExpression"));config_$1.menu=perso_PersonaSelectorMenu_58_5_$1;net.jangaroo.ext.Exml.apply(config_$1,config);this.super$mFrO(config_$1)}return{extend:"com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase",alias:"widget.com.coremedia.personalization.ui.config.personaSelector",
constructor:PersonaSelector$,super$mFrO:function(){com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase.prototype.constructor.apply(this,arguments)},config:{contentValueExpression:null,docType:null,paths:null,defaultGroupHeaderLabel:null},requires:["com.coremedia.cms.editor.sdk.desktop.reusability.ReusabilityComponentStatePlugin","com.coremedia.icons.CoreIcons_properties","com.coremedia.personalization.ui.persona.selector.PersonaSelectorBase","com.coremedia.ui.plugins.BindPropertyPlugin",
"com.coremedia.ui.skins.ButtonSkin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.persona.selector.PersonaSelectorMenu"]}});Ext.define("com.coremedia.personalization.ui.persona.form.PersonaMainContainerBase",function(PersonaMainContainerBase){function PersonaMainContainerBase$(config){if(arguments.length<=0)config=null;if(!AS3.getBindable(config,"profileSettingsExpression"))throw new AS3.Error("Configuration parameter 'profileSettingsExpression' must be supplied");this.super$$_4R(config)}function transformer(personaProfileSettingsTextBlob){var newBean=com.coremedia.personalization.ui.util.PersonaContextHelper.beanFromPropertiesString(personaProfileSettingsTextBlob);
var oldBean=this.getValue();if(oldBean)com.coremedia.ui.util.ObjectUtils.getPropertyNames(oldBean.toObject()).forEach(function(propertyName){if(oldBean.get(propertyName)&&!newBean.get(propertyName))newBean.set(propertyName,"")});return newBean}function getLocalBean(){if(!this.localBean$$_4R)this.localBean$$_4R=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean();return this.localBean$$_4R}function updateModel(transformedValue){if(transformedValue)if(com.coremedia.ui.util.ObjectUtils.equal(transformedValue,
com.coremedia.personalization.ui.util.PersonaContextHelper.INVALID_VALUE)){if(joo.debug)AS3.trace("[WARN]: transformed blob data is invalid",transformedValue);this.getPersonaErrorScreen$$_4R().setVisible(true)}else{this.getLocalBean().updateProperties(transformedValue.toObject());this.getPersonaErrorScreen$$_4R().setVisible(false)}else this.getPersonaErrorScreen$$_4R().setVisible(false)}function getPersonaErrorScreen(){return AS3.as(this.query(com.coremedia.ui.util.createComponentSelector()._xtype(com.coremedia.personalization.ui.persona.form.PersonaErrorScreen.xtype).build())[0],
com.coremedia.personalization.ui.persona.form.PersonaErrorScreen)}function getValue(){return this.getLocalBean()}function setValue(transformedValue){var this$=this;this.updateInProgress$$_4R=true;if(transformedValue==null)transformedValue=this.transformer(null);this.updateModel$$_4R(transformedValue);if(this.localBean$$_4R.set(com.coremedia.personalization.ui.util.PersonaContextHelper.HIDDEN_PROPERTY_NAME,"true"))this.localBean$$_4R.addValueChangeListener(function(){if(!this$.updateInProgress$$_4R)this$.fireEvent("change")});
this.updateInProgress$$_4R=false}return{extend:"Ext.container.Container",localBean$$_4R:null,updateInProgress$$_4R:false,constructor:PersonaMainContainerBase$,super$$_4R:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},transformer:transformer,getLocalBean:getLocalBean,updateModel$$_4R:updateModel,getPersonaErrorScreen$$_4R:getPersonaErrorScreen,getValue:getValue,setValue:setValue,requires:["AS3.Error","AS3.trace","Ext.container.Container","com.coremedia.cms.editor.sdk.editorContext",
"com.coremedia.ui.util.ObjectUtils","com.coremedia.ui.util.createComponentSelector"],uses:["com.coremedia.personalization.ui.persona.form.PersonaErrorScreen","com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.PersonaMainContainer",function(PersonaMainContainer){function PersonaMainContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.persona.form.PersonaMainContainerBase,{});var defaults_$1=AS3.cast(PersonaMainContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var ui_BindBlobPropertyPlugin_41_5_$1=AS3.cast(com.coremedia.ui.plugins.BindBlobPropertyPlugin,{});AS3.setBindable(ui_BindBlobPropertyPlugin_41_5_$1,
"transformer",AS3.bind(this,"transformer"));AS3.setBindable(ui_BindBlobPropertyPlugin_41_5_$1,"reverseTransformer",com.coremedia.personalization.ui.util.PersonaContextHelper.propertiesStringFromBean);ui_BindBlobPropertyPlugin_41_5_$1.bindTo=AS3.getBindable(config,"profileSettingsExpression");AS3.setBindable(ui_BindBlobPropertyPlugin_41_5_$1,"mimeType","text/plain");var ui_VerticalSpacingPlugin_45_5_$1=AS3.cast(com.coremedia.ui.plugins.VerticalSpacingPlugin,{});AS3.setBindable(ui_VerticalSpacingPlugin_45_5_$1,
"modifier",com.coremedia.ui.bem.SpacingBEMEntities.VERTICAL_SPACING_MODIFIER_200);config_$1.plugins=[ui_BindBlobPropertyPlugin_41_5_$1,ui_VerticalSpacingPlugin_45_5_$1];var editor_PropertyField_48_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.PropertyField,{});editor_PropertyField_48_5_$1["contentBindTo"]=AS3.getBindable(config,"bindTo");AS3.setBindable(editor_PropertyField_48_5_$1,"forceReadOnlyValueExpression",AS3.getBindable(config,"forceReadOnlyValueExpression"));var ui_ValueExpression_51_9_$1=
AS3.cast(com.coremedia.ui.exml.ValueExpression,{});AS3.setBindable(ui_ValueExpression_51_9_$1,"context",this.getLocalBean());AS3.setBindable(editor_PropertyField_48_5_$1,"bindTo",new com.coremedia.ui.exml.ValueExpression(ui_ValueExpression_51_9_$1));config_$1["defaultType"]=editor_PropertyField_48_5_$1["xtype"];delete editor_PropertyField_48_5_$1["xtype"];delete editor_PropertyField_48_5_$1["xclass"];config_$1.defaults=editor_PropertyField_48_5_$1;net.jangaroo.ext.Exml.apply(config_$1,config);this.super$ZWig(config_$1)}
return{extend:"com.coremedia.personalization.ui.persona.form.PersonaMainContainerBase",alias:"widget.com.coremedia.personalization.ui.config.personaMainContainer",constructor:PersonaMainContainer$,super$ZWig:function(){com.coremedia.personalization.ui.persona.form.PersonaMainContainerBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,forceReadOnlyValueExpression:null,profileSettingsExpression:null},requires:["com.coremedia.cms.editor.sdk.premular.PropertyField","com.coremedia.personalization.ui.persona.form.PersonaMainContainerBase",
"com.coremedia.ui.bem.SpacingBEMEntities","com.coremedia.ui.exml.ValueExpression","com.coremedia.ui.plugins.BindBlobPropertyPlugin","com.coremedia.ui.plugins.VerticalSpacingPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.fields.PersonaNumberPropertyField",function(PersonaNumberPropertyField){function PersonaNumberPropertyField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(PersonaNumberPropertyField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"layout","hbox");var editor_PropertyField_39_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.PropertyField,
{});AS3.setBindable(editor_PropertyField_39_5_$1,"bindTo",AS3.getBindable(config,"bindTo"));config_$1["defaultType"]=editor_PropertyField_39_5_$1["xtype"];delete editor_PropertyField_39_5_$1["xtype"];delete editor_PropertyField_39_5_$1["xclass"];config_$1.defaults=editor_PropertyField_39_5_$1;var label_42_5_$1=AS3.cast(Ext.form.Label,{});AS3.setBindable(label_42_5_$1,"text",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"fieldLabel")));AS3.setBindable(label_42_5_$1,"width",150);var numberField_44_5_$1=
AS3.cast(Ext.form.field.Number,{});AS3.setBindable(numberField_44_5_$1,"width",100);var ui_BindPropertyPlugin_46_9_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_46_9_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy(AS3.getBindable(config,"propertyContext")+com.coremedia.personalization.ui.util.PersonaContextHelper.CONTEXT_NAME_SEPARATOR+AS3.getBindable(config,"propertyName"));ui_BindPropertyPlugin_46_9_$1.bidirectional=true;numberField_44_5_$1.plugins=[ui_BindPropertyPlugin_46_9_$1];
config_$1.items=[label_42_5_$1,numberField_44_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$OJQt(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.personaNumberPropertyField",constructor:PersonaNumberPropertyField$,super$OJQt:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{bindTo:null,fieldLabel:null,propertyContext:null,propertyName:null},requires:["Ext.container.Container","Ext.form.Label",
"Ext.form.field.Number","com.coremedia.cms.editor.sdk.premular.PropertyField","com.coremedia.ui.plugins.BindPropertyPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.fields.PersonaDateTimeProperty",function(PersonaDateTimeProperty){function PersonaDateTimeProperty$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.DateTimeContainer,{});var defaults_$1=AS3.cast(PersonaDateTimeProperty,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var ui_BindPropertyPlugin_17_5_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_17_5_$1.bindTo=
AS3.getBindable(config,"bindTo").extendBy(AS3.getBindable(config,"propertyContext")+com.coremedia.personalization.ui.util.PersonaContextHelper.CONTEXT_NAME_SEPARATOR+AS3.getBindable(config,"propertyName"));ui_BindPropertyPlugin_17_5_$1.bidirectional=true;ui_BindPropertyPlugin_17_5_$1.componentProperty="value";config_$1.plugins=[ui_BindPropertyPlugin_17_5_$1];config_$1["plugins$at"]=net.jangaroo.ext.Exml.APPEND;net.jangaroo.ext.Exml.apply(config_$1,config);this.super$n8aL(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.DateTimeContainer",
alias:"widget.com.coremedia.personalization.ui.config.personaDateTimeProperty",constructor:PersonaDateTimeProperty$,super$n8aL:function(){com.coremedia.personalization.ui.plugin.DateTimeContainer.prototype.constructor.apply(this,arguments)},requires:["com.coremedia.personalization.ui.plugin.DateTimeContainer","com.coremedia.ui.plugins.BindPropertyPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.fields.PersonaStringPropertyField",function(PersonaStringPropertyField){function PersonaStringPropertyField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.form.field.Text,{});var defaults_$1=AS3.cast(PersonaStringPropertyField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);config_$1.checkChangeBuffer=1E3;var ui_BindPropertyPlugin_33_5_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_33_5_$1.bindTo=
AS3.getBindable(config,"bindTo").extendBy(AS3.getBindable(config,"propertyContext")+com.coremedia.personalization.ui.util.PersonaContextHelper.CONTEXT_NAME_SEPARATOR+AS3.getBindable(config,"propertyName"));ui_BindPropertyPlugin_33_5_$1.bidirectional=true;config_$1.plugins=[ui_BindPropertyPlugin_33_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$eBRl(config_$1)}return{extend:"Ext.form.field.Text",alias:"widget.com.coremedia.personalization.ui.config.personaStringPropertyField",constructor:PersonaStringPropertyField$,
super$eBRl:function(){Ext.form.field.Text.prototype.constructor.apply(this,arguments)},config:{bindTo:null,propertyContext:null,propertyName:null},requires:["Ext.form.field.Text","com.coremedia.ui.plugins.BindPropertyPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.fields.PersonaTimePropertyField",function(PersonaTimePropertyField){function PersonaTimePropertyField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(PersonaTimePropertyField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"layout","hbox");var editor_PropertyField_36_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.PropertyField,
{});AS3.setBindable(editor_PropertyField_36_5_$1,"bindTo",AS3.getBindable(config,"bindTo"));config_$1["defaultType"]=editor_PropertyField_36_5_$1["xtype"];delete editor_PropertyField_36_5_$1["xtype"];delete editor_PropertyField_36_5_$1["xclass"];config_$1.defaults=editor_PropertyField_36_5_$1;var label_39_5_$1=AS3.cast(Ext.form.Label,{});AS3.setBindable(label_39_5_$1,"text",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"fieldLabel")));AS3.setBindable(label_39_5_$1,"width",150);var timeField_41_5_$1=
AS3.cast(Ext.form.field.Time,{});timeField_41_5_$1.format="g:i A";var ui_BindPropertyPlugin_43_9_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_43_9_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy(AS3.getBindable(config,"propertyContext")+com.coremedia.personalization.ui.util.PersonaContextHelper.CONTEXT_NAME_SEPARATOR+AS3.getBindable(config,"propertyName"));ui_BindPropertyPlugin_43_9_$1.bidirectional=true;timeField_41_5_$1.plugins=[ui_BindPropertyPlugin_43_9_$1];
config_$1.items=[label_39_5_$1,timeField_41_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$t31p(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.personaTimePropertyField",constructor:PersonaTimePropertyField$,super$t31p:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{bindTo:null,fieldLabel:null,propertyContext:null,propertyName:null},requires:["Ext.container.Container","Ext.form.Label",
"Ext.form.field.Time","com.coremedia.cms.editor.sdk.premular.PropertyField","com.coremedia.ui.plugins.BindPropertyPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.fields.PersonaDatePropertyField",function(PersonaDatePropertyField){function PersonaDatePropertyField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.DateFieldBase,{});var defaults_$1=AS3.cast(PersonaDatePropertyField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"width",95);config_$1.format=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_date_format"));config_$1.validateOnBlur=true;var ui_BindPropertyPlugin_40_5_$1=AS3.cast(com.coremedia.ui.plugins.BindPropertyPlugin,{});ui_BindPropertyPlugin_40_5_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy(AS3.getBindable(config,"propertyContext")+com.coremedia.personalization.ui.util.PersonaContextHelper.CONTEXT_NAME_SEPARATOR+AS3.getBindable(config,"propertyName"));ui_BindPropertyPlugin_40_5_$1.bidirectional=true;ui_BindPropertyPlugin_40_5_$1.componentProperty="value";ui_BindPropertyPlugin_40_5_$1.reverseTransformer=
function(date){return Ext.Date.format(date,"c")};ui_BindPropertyPlugin_40_5_$1.transformer=function(value){if(value){var cutoff;if(value.indexOf("Z")>=0)cutoff="Z";else if(value.indexOf("+")>=0)cutoff="+";if(cutoff)value=value.split(cutoff)[0]}return Ext.Date.parse(value,"c")};config_$1.plugins=[ui_BindPropertyPlugin_40_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$hqao(config_$1)}return{extend:"com.coremedia.personalization.ui.DateFieldBase",alias:"widget.com.coremedia.personalization.ui.config.personaDatePropertyField",
constructor:PersonaDatePropertyField$,super$hqao:function(){com.coremedia.personalization.ui.DateFieldBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,propertyContext:null,propertyName:null},requires:["Ext.Date","com.coremedia.personalization.ui.DateFieldBase","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.plugins.BindPropertyPlugin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.util.PersonaContextHelper"]}});Ext.define("com.coremedia.personalization.ui.persona.form.PersonaErrorScreen",function(PersonaErrorScreen){function PersonaErrorScreen$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(PersonaErrorScreen,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var editor_PropertyFieldGroup_23_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.PropertyFieldGroup,{});editor_PropertyFieldGroup_23_5_$1.itemId="errorScreen";AS3.setBindable(editor_PropertyFieldGroup_23_5_$1,
"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(editor_PropertyFieldGroup_23_5_$1,"title",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_error_screen_label"));var label_27_9_$1=AS3.cast(Ext.form.Label,{});AS3.setBindable(label_27_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_persona_error_screen_text")));var editor_TextBlobPropertyField_28_9_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.TextBlobPropertyField,
{});AS3.setBindable(editor_TextBlobPropertyField_28_9_$1,"height",300);editor_TextBlobPropertyField_28_9_$1.labelSeparator="";AS3.setBindable(editor_TextBlobPropertyField_28_9_$1,"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(editor_TextBlobPropertyField_28_9_$1,"propertyName","profileSettings");editor_TextBlobPropertyField_28_9_$1.hideLabel=true;editor_PropertyFieldGroup_23_5_$1.items=[label_27_9_$1,editor_TextBlobPropertyField_28_9_$1];config_$1.items=[editor_PropertyFieldGroup_23_5_$1];
net.jangaroo.ext.Exml.apply(config_$1,config);this.super$wirs(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.personaErrorScreen",constructor:PersonaErrorScreen$,super$wirs:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{bindTo:null},requires:["Ext.container.Container","Ext.form.Label","com.coremedia.cms.editor.sdk.premular.PropertyFieldGroup","com.coremedia.cms.editor.sdk.premular.fields.TextBlobPropertyField",
"com.coremedia.personalization.ui.Personalization_properties","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.form.PersonaUiContainer",function(PersonaUiContainer){function PersonaUiContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(PersonaUiContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var layout_Form_39_5_$1=AS3.cast(Ext.layout.container.Form,{});AS3.setBindable(config_$1,"layout",layout_Form_39_5_$1);var editor_PropertyField_42_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.PropertyField,
{});AS3.setBindable(editor_PropertyField_42_5_$1,"bindTo",AS3.getBindable(config,"bindTo"));editor_PropertyField_42_5_$1["contentBindTo"]=AS3.getBindable(config,"contentBindTo");AS3.setBindable(editor_PropertyField_42_5_$1,"forceReadOnlyValueExpression",AS3.getBindable(config,"forceReadOnlyValueExpression"));editor_PropertyField_42_5_$1.labelSeparator="";config_$1["defaultType"]=editor_PropertyField_42_5_$1["xtype"];delete editor_PropertyField_42_5_$1["xtype"];delete editor_PropertyField_42_5_$1["xclass"];
config_$1.defaults=editor_PropertyField_42_5_$1;net.jangaroo.ext.Exml.apply(config_$1,config);this.super$ftal(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.personaUiContainer",constructor:PersonaUiContainer$,super$ftal:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{bindTo:null,contentBindTo:null,forceReadOnlyValueExpression:null},requires:["Ext.container.Container","Ext.layout.container.Form","com.coremedia.cms.editor.sdk.premular.PropertyField",
"net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.form.PersonaGroupContainer",function(PersonaGroupContainer){function PersonaGroupContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(PersonaGroupContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var editor_PropertyField_26_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.PropertyField,{});AS3.setBindable(editor_PropertyField_26_5_$1,"bindTo",AS3.getBindable(config,
"bindTo"));config_$1["defaultType"]=editor_PropertyField_26_5_$1["xtype"];delete editor_PropertyField_26_5_$1["xtype"];delete editor_PropertyField_26_5_$1["xclass"];config_$1.defaults=editor_PropertyField_26_5_$1;net.jangaroo.ext.Exml.apply(config_$1,config);this.super$kPoW(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.personaGroupContainer",constructor:PersonaGroupContainer$,super$kPoW:function(){Ext.container.Container.prototype.constructor.apply(this,
arguments)},config:{bindTo:null},requires:["Ext.container.Container","com.coremedia.cms.editor.sdk.premular.PropertyField","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.persona.helper.PersonaImplicitInterestHelper",function(PersonaImplicitInterestHelper){function PersonaImplicitInterestHelper$(nameArray,valueArray){this.nameArray$vf45=nameArray;this.valueArray$vf45=valueArray}function getValueForName(name){var defaultValue=100;if(!this.valueArray$vf45)return defaultValue;else{var value=this.valueArray$vf45[this.nameArray$vf45.indexOf(name)];return value?value:defaultValue}}function getNameArray(){return this.nameArray$vf45}
return{nameArray$vf45:null,valueArray$vf45:null,constructor:PersonaImplicitInterestHelper$,getValueForName:getValueForName,getNameArray:getNameArray}});Ext.define("com.coremedia.personalization.ui.persona.helper.PersonaActivator",function(PersonaActivator){function PersonaActivator$(urlValueExpression,urlParameterBean){this.urlValueExpression$rIND=urlValueExpression;this.urlParameterBean$rIND=urlParameterBean;this.setNoPersonaActive()}function setActive(personaContent){this.urlParameterBean$rIND.set(PersonaActivator.P13N_TEST_PARAM,true);this.urlParameterBean$rIND.set(PersonaActivator.P13N_TESTCONTEXT_PARAM,getNumericIdFromContent$static(personaContent))}
function isActive(personaContent){var personaIdFromGivenContent=getNumericIdFromContent$static(personaContent);if(this.urlParameterBean$rIND.get(PersonaActivator.P13N_TEST_PARAM)){var currentActivePersonaId=this.urlParameterBean$rIND.get(PersonaActivator.P13N_TESTCONTEXT_PARAM);return personaIdFromGivenContent===currentActivePersonaId}return false}function isAnyPersonaActive(){if(this.urlParameterBean$rIND.get(PersonaActivator.P13N_TEST_PARAM)){var currentActivePersonaId=this.urlParameterBean$rIND.get(PersonaActivator.P13N_TESTCONTEXT_PARAM);
return currentActivePersonaId>PersonaActivator.NO_PERSONA_ID}return false}function setNoPersonaActive(){this.urlParameterBean$rIND.set(PersonaActivator.P13N_TEST_PARAM,true);this.urlParameterBean$rIND.set(PersonaActivator.P13N_TESTCONTEXT_PARAM,PersonaActivator.NO_PERSONA_ID)}function getUrlParameterBean(){return this.urlParameterBean$rIND}function getUrlValueExpression(){return this.urlValueExpression$rIND}function getNumericIdFromContent$static(content){return AS3.as(content,Object).getNumericId()}
return{urlValueExpression$rIND:null,urlParameterBean$rIND:null,constructor:PersonaActivator$,setActive:setActive,isActive:isActive,isAnyPersonaActive:isAnyPersonaActive,setNoPersonaActive:setNoPersonaActive,getUrlParameterBean:getUrlParameterBean,getUrlValueExpression:getUrlValueExpression,statics:{NO_PERSONA_ID:0,P13N_TEST_PARAM:"p13n_test",P13N_TESTCONTEXT_PARAM:"p13n_testcontext"}}});Ext.define("com.coremedia.personalization.ui.SelectionRulesField",function(SelectionRulesField){function SelectionRulesField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.SelectionRulesFieldBase,{});var defaults_$1=AS3.cast(SelectionRulesField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"defaultField",net.jangaroo.ext.Exml.asString(com.coremedia.ui.util.createComponentSelector().itemId(SelectionRulesField.RULE_LIST_EDITOR_ITEM_ID).build()));
var editor_SetPropertyLabelPlugin_63_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.plugins.SetPropertyLabelPlugin,{});editor_SetPropertyLabelPlugin_63_5_$1.bindTo=AS3.getBindable(config,"bindTo");AS3.setBindable(editor_SetPropertyLabelPlugin_63_5_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));var ui_BindBlobPropertyPlugin_65_5_$1=AS3.cast(com.coremedia.ui.plugins.BindBlobPropertyPlugin,{});ui_BindBlobPropertyPlugin_65_5_$1.bindTo=AS3.getBindable(config,
"bindTo").extendBy("properties",AS3.getBindable(config,"propertyName"));config_$1.plugins=[editor_SetPropertyLabelPlugin_63_5_$1,ui_BindBlobPropertyPlugin_65_5_$1];var container_68_5_$1=AS3.cast(Ext.container.Container,{});container_68_5_$1.itemId="buttons";AS3.setBindable(container_68_5_$1,"height",26);var button_71_9_$1=AS3.cast(Ext.button.Button,{});button_71_9_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.SelectionRulesFieldBase.EXPAND_ALL_BUTTON_ITEM_ID);button_71_9_$1.ui=
net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.LINK.getSkin());AS3.setBindable(button_71_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_expandAllButton")));AS3.setBindable(button_71_9_$1,"handler",AS3.bind(this,"expandConditionPanels"));var button_75_9_$1=AS3.cast(Ext.button.Button,{});button_75_9_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.SelectionRulesFieldBase.COLLAPSE_ALL_BUTTON_ITEM_ID);
button_75_9_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.LINK.getSkin());AS3.setBindable(button_75_9_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_collapseAllButton")));AS3.setBindable(button_75_9_$1,"handler",AS3.bind(this,"collapseConditionPanels"));container_68_5_$1.items=[button_71_9_$1,button_75_9_$1];var perso_RuleListEditor_81_5_$1=AS3.cast(com.coremedia.personalization.ui.editors.RuleListEditor,
{});perso_RuleListEditor_81_5_$1.itemId=net.jangaroo.ext.Exml.asString(SelectionRulesField.RULE_LIST_EDITOR_ITEM_ID);AS3.setBindable(perso_RuleListEditor_81_5_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));AS3.setBindable(perso_RuleListEditor_81_5_$1,"bindTo",AS3.getBindable(config,"bindTo"));AS3.setBindable(perso_RuleListEditor_81_5_$1,"forceReadOnlyValueExpression",AS3.getBindable(config,"forceReadOnlyValueExpression"));AS3.setBindable(perso_RuleListEditor_81_5_$1,
"allowedContentType",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"allowedContentType")));AS3.setBindable(perso_RuleListEditor_81_5_$1,"showThumbnails",AS3.getBindable(config,"showThumbnails"));AS3.setBindable(perso_RuleListEditor_81_5_$1,"conditionItems",this.getConditionItems());config_$1.items=[container_68_5_$1,perso_RuleListEditor_81_5_$1];var layout_Anchor_90_5_$1=AS3.cast(Ext.layout.container.Anchor,{});AS3.setBindable(config_$1,"layout",layout_Anchor_90_5_$1);net.jangaroo.ext.Exml.apply(config_$1,
config);this.super$ql2r(config_$1)}return{extend:"com.coremedia.personalization.ui.SelectionRulesFieldBase",alias:"widget.com.coremedia.personalization.ui.config.selectionRulesField",constructor:SelectionRulesField$,super$ql2r:function(){com.coremedia.personalization.ui.SelectionRulesFieldBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,forceReadOnlyValueExpression:null,showThumbnails:false,propertyName:null,allowedContentType:null,conditionItems:null},statics:{RULE_LIST_EDITOR_ITEM_ID:"ruleListEditor"},
requires:["Ext.button.Button","Ext.container.Container","Ext.layout.container.Anchor","com.coremedia.cms.editor.sdk.premular.fields.plugins.SetPropertyLabelPlugin","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.personalization.ui.SelectionRulesFieldBase","com.coremedia.ui.plugins.BindBlobPropertyPlugin","com.coremedia.ui.skins.ButtonSkin","com.coremedia.ui.util.createComponentSelector","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.editors.RuleListEditor"]}});Ext.define("com.coremedia.personalization.ui.plugin.Addconditionitems",function(Addconditionitems){function Addconditionitems$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.AddConditionItemsPlugin,{});var defaults_$1=AS3.cast(Addconditionitems,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$EjWb(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.AddConditionItemsPlugin",
constructor:Addconditionitems$,super$EjWb:function(){com.coremedia.personalization.ui.plugin.AddConditionItemsPlugin.prototype.constructor.apply(this,arguments)},config:{items:null},requires:["com.coremedia.personalization.ui.plugin.AddConditionItemsPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.plugin.Addpathfromhomefolder",function(Addpathfromhomefolder){function Addpathfromhomefolder$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.AddPathFromHomeFolderPlugin,{});var defaults_$1=AS3.cast(Addpathfromhomefolder,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$aeqy(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.AddPathFromHomeFolderPlugin",
constructor:Addpathfromhomefolder$,super$aeqy:function(){com.coremedia.personalization.ui.plugin.AddPathFromHomeFolderPlugin.prototype.constructor.apply(this,arguments)},config:{relativePath:null,labelSuffix:null},requires:["com.coremedia.personalization.ui.plugin.AddPathFromHomeFolderPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.plugin.AddConditionItemsPlugin",function(AddConditionItemsPlugin){function AddConditionItemsPlugin$(config){if(arguments.length<=0)config=null;this.items$sf_u=com.coremedia.ui.util.ArrayUtils.asArray(AS3.getBindable(config,"items"))}function init(component){if(AS3.is(component,com.coremedia.personalization.ui.SelectionRulesField)||AS3.is(component,com.coremedia.personalization.ui.ConditionsField))component["addConditionItems"](this.items$sf_u);else throw new AS3.Error("plugin is application only to components of type SelectionRulesField or ConditionsField");
}return{mixins:["ext.Plugin"],items$sf_u:null,constructor:AddConditionItemsPlugin$,init:init,requires:["AS3.Error","com.coremedia.ui.util.ArrayUtils","ext.Plugin"],uses:["com.coremedia.personalization.ui.ConditionsField","com.coremedia.personalization.ui.SelectionRulesField"]}});Ext.define("com.coremedia.personalization.ui.plugin.ContextLocalizationSupport",function(ContextLocalizationSupport){var PROPERTY_PREFIX$static="p13n_context_";function ContextLocalizationSupport$(){}function localizeContextName$static(contextName){var localizedName=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.PersonalizationContextNames",PROPERTY_PREFIX$static+propertyEncode$static(contextName));return localizedName!==undefined&&localizedName!==null?localizedName:
contextName}function localizePropertyKey$static(contextName,propertyKey){var computedKey=PROPERTY_PREFIX$static+propertyEncode$static(contextName+"_"+propertyKey);var localizedName=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.PersonalizationContextNames",computedKey);return localizedName!==undefined&&localizedName!==null?localizedName:propertyKey}function localizePropertyValue$static(contextName,propertyKey,propertyValue){if(ContextLocalizationSupport.isTime(propertyValue))return ContextLocalizationSupport.localizeTime(propertyValue);
if(ContextLocalizationSupport.isDate(propertyValue))return ContextLocalizationSupport.localizeDate(propertyValue);if(ContextLocalizationSupport.isDateTime(propertyValue))return ContextLocalizationSupport.localizeDateTime(propertyValue);var computedKey=PROPERTY_PREFIX$static+propertyEncode$static(contextName+"_"+propertyKey+"_"+propertyValue);var localizedName=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.PersonalizationContextNames",computedKey);return localizedName!==
undefined&&localizedName!==null?localizedName:propertyValue}function propertyEncode$static(value){return value.replace(/\W/g,"")}function isTime$static(value){return Ext.Date.parse(value,"H:i:s")!=null}function localizeTime$static(value){var d=Ext.Date.parse(value,"H:i:s");var df=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_time_format");if(d!=null&&df!=null)return Ext.Date.format(d,df);else{if(joo.debug)AS3.trace("supplied value is not in the correct format 'H:i:s':"+
value);return value}}function isDate$static(value){return Ext.Date.parse(value,"Y-m-d")!=null}function localizeDate$static(value){var d=Ext.Date.parse(value,"Y-m-d");var df=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_date_format");if(d!=null&&df!=null)return Ext.Date.format(d,df);else{if(joo.debug)AS3.trace("supplied value is not in the correct format 'Y-m-d':"+value);return value}}function isDateTime$static(value){return Ext.Date.parse(value,
"Y-m-d\\TH:i:s")!=null}function localizeDateTime$static(value){var d=Ext.Date.parse(value,"Y-m-d\\TH:i:s");var df=mx.resources.ResourceManager.getInstance().getString("com.coremedia.personalization.ui.Personalization","p13n_date_time_format");if(d!=null&&df!=null)return Ext.Date.format(d,df);else{if(joo.debug)AS3.trace("supplied value is not in the correct format 'Y-m-d\\TH:i:s':"+value);return value}}return{constructor:ContextLocalizationSupport$,statics:{localizeContextName:localizeContextName$static,
localizePropertyKey:localizePropertyKey$static,localizePropertyValue:localizePropertyValue$static,isTime:isTime$static,localizeTime:localizeTime$static,isDate:isDate$static,localizeDate:localizeDate$static,isDateTime:isDateTime$static,localizeDateTime:localizeDateTime$static},requires:["AS3.trace","Ext.Date","com.coremedia.personalization.ui.PersonalizationContextNames_properties","com.coremedia.personalization.ui.Personalization_properties","mx.resources.ResourceManager"]}});Ext.define("com.coremedia.personalization.ui.plugin.Addpath",function(Addpath){function Addpath$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.AddPathPlugin,{});var defaults_$1=AS3.cast(Addpath,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$en35(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.AddPathPlugin",constructor:Addpath$,super$en35:function(){com.coremedia.personalization.ui.plugin.AddPathPlugin.prototype.constructor.apply(this,
arguments)},config:{path:null,labelSuffix:null},requires:["com.coremedia.personalization.ui.plugin.AddPathPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.plugin.DateTimeContainer",function(DateTimeContainer){function DateTimeContainer$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.DateTimeContainerBase,{});var defaults_$1=AS3.cast(DateTimeContainer,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var ui_StatefulDateField_34_5_$1=AS3.cast(com.coremedia.ui.components.StatefulDateField,{});ui_StatefulDateField_34_5_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.plugin.DateTimeContainerBase.dateFieldItemId);
ui_StatefulDateField_34_5_$1.ariaLabel=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.cms.editor.Editor","Date_property_field"));ui_StatefulDateField_34_5_$1.format=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_date_format"));ui_StatefulDateField_34_5_$1.validator=AS3.bind(this,"validateDate");ui_StatefulDateField_34_5_$1.allowBlank=true;AS3.setBindable(ui_StatefulDateField_34_5_$1,"emptyText",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.cms.editor.Editor",
"DateTimePropertyField_emptyDate")));var editor_ShowIssuesPlugin_41_9_$1=AS3.cast(com.coremedia.cms.editor.sdk.validation.ShowIssuesPlugin,{});editor_ShowIssuesPlugin_41_9_$1.bindTo=AS3.getBindable(config,"bindTo");AS3.setBindable(editor_ShowIssuesPlugin_41_9_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));ui_StatefulDateField_34_5_$1.plugins=[editor_ShowIssuesPlugin_41_9_$1];var ui_StatefulTimeField_46_5_$1=AS3.cast(com.coremedia.ui.components.StatefulTimeField,
{});ui_StatefulTimeField_46_5_$1.itemId=net.jangaroo.ext.Exml.asString(com.coremedia.personalization.ui.plugin.DateTimeContainerBase.timeFieldItemId);AS3.setBindable(ui_StatefulTimeField_46_5_$1,"minValue",Ext.Date.parse("0:00 AM","g:i A"));AS3.setBindable(ui_StatefulTimeField_46_5_$1,"maxValue",Ext.Date.parse("11:59 PM","g:i A"));ui_StatefulTimeField_46_5_$1.increment=30;ui_StatefulTimeField_46_5_$1.ariaLabel=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.cms.editor.Editor",
"Time_property_field"));ui_StatefulTimeField_46_5_$1.format=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_time_format"));ui_StatefulTimeField_46_5_$1.validator=AS3.bind(this,"validateTime");ui_StatefulTimeField_46_5_$1.enableKeyEvents=true;ui_StatefulTimeField_46_5_$1.allowBlank=true;AS3.setBindable(ui_StatefulTimeField_46_5_$1,"emptyText",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.cms.editor.Editor",
"DateTimePropertyField_emptyTime")));var editor_ShowIssuesPlugin_57_9_$1=AS3.cast(com.coremedia.cms.editor.sdk.validation.ShowIssuesPlugin,{});editor_ShowIssuesPlugin_57_9_$1.bindTo=AS3.getBindable(config,"bindTo");AS3.setBindable(editor_ShowIssuesPlugin_57_9_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));ui_StatefulTimeField_46_5_$1.plugins=[editor_ShowIssuesPlugin_57_9_$1];config_$1.items=[ui_StatefulDateField_34_5_$1,ui_StatefulTimeField_46_5_$1];var ui_HorizontalSpacingPlugin_63_5_$1=
AS3.cast(com.coremedia.ui.plugins.HorizontalSpacingPlugin,{});AS3.setBindable(ui_HorizontalSpacingPlugin_63_5_$1,"modifier",com.coremedia.ui.bem.SpacingBEMEntities.HORIZONTAL_SPACING_MODIFIER_200);config_$1.plugins=[ui_HorizontalSpacingPlugin_63_5_$1];var layout_HBox_66_5_$1=AS3.cast(Ext.layout.container.HBox,{});AS3.setBindable(config_$1,"layout",layout_HBox_66_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$dhJb(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.DateTimeContainerBase",
alias:"widget.com.coremedia.personalization.ui.config.dateTimeContainer",constructor:DateTimeContainer$,super$dhJb:function(){com.coremedia.personalization.ui.plugin.DateTimeContainerBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,propertyContext:null,propertyName:null},requires:["Ext.Date","Ext.layout.container.HBox","com.coremedia.cms.editor.sdk.validation.ShowIssuesPlugin","com.coremedia.personalization.ui.plugin.DateTimeContainerBase","com.coremedia.ui.bem.SpacingBEMEntities",
"com.coremedia.ui.components.StatefulDateField","com.coremedia.ui.components.StatefulTimeField","com.coremedia.ui.plugins.HorizontalSpacingPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.plugin.RepositoryPathObserverManager",function(RepositoryPathObserverManager){var instances$static;function instances$static_(){instances$static={}}var counter$static;function counter$static_(){counter$static={}}function getInstance$static(path,contentType,pollingInterval){var instanceKey=createKey$static(path,contentType,pollingInterval);var instance=instances$static[instanceKey];if(!instance){instance=new com.coremedia.personalization.ui.plugin.RepositoryPathObserver(path,
contentType,pollingInterval);instances$static[instanceKey]=instance;counter$static[instanceKey]=1}else counter$static[instanceKey]++;if(joo.debug)AS3.trace("[INFO] "+counter$static[instanceKey]+" references to repository path observer for instanceKey "+instanceKey+" recorded");return instance}function createKey$static(path,contentType,pollingInterval){return path+"#"+contentType+"#"+pollingInterval}function releaseInstance$static(path,documentType,pollingInterval){var key=createKey$static(path,documentType,
pollingInterval);var count=counter$static[key];if(count>1){counter$static[key]--;if(joo.debug)AS3.trace("[INFO] unregistered instance for key "+key+" ("+counter$static[key]+" instances remaining)")}else{var inst=instances$static[key];if(inst)inst.clearInterval();clearReferences$static(key);if(joo.debug)AS3.trace("[INFO] destroyed repository path observer for key "+key)}}function clearReferences$static(key){delete counter$static[key];delete instances$static[key];if(joo.debug)AS3.trace("[INFO] cleared repository path observer references for key "+
key)}function RepositoryPathObserverManager$(){}return{constructor:RepositoryPathObserverManager$,statics:{instances:undefined,counter:undefined,getInstance:getInstance$static,releaseInstance:releaseInstance$static,__initStatics__:function(){instances$static_();counter$static_()}},requires:["AS3.trace"],uses:["com.coremedia.personalization.ui.plugin.RepositoryPathObserver"]}});Ext.define("com.coremedia.personalization.ui.plugin.MultipleRepositoryPathsObserver",function(MultipleRepositoryPathsObserver){var DEFAULT_POLLING_INTERVAL$static=2E4;function folderContents_(){this.folderContents$EeO9=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean({VALUE_PROPERTY_NAME:[]})}function pathObservers_(){this.pathObservers$EeO9={}}function idToPathTable_(){this.idToPathTable$EeO9={}}function MultipleRepositoryPathsObserver$(documentType,pollingInterval){this.super$EeO9();
folderContents_.call(this);pathObservers_.call(this);idToPathTable_.call(this);this.documentType$EeO9=documentType;this.pollingInterval$EeO9=pollingInterval||DEFAULT_POLLING_INTERVAL$static;this.folderContents$EeO9.addPropertyChangeListener(MultipleRepositoryPathsObserver.VALUE_PROPERTY_NAME,AS3.bind(this,"valueChanged$EeO9"))}function valueChanged(ev){this.fireEvent(MultipleRepositoryPathsObserver.VALUE_PROPERTY_NAME,Ext.applyIf({bean:this},ev))}function getValue(){return this.folderContents$EeO9.get(MultipleRepositoryPathsObserver.VALUE_PROPERTY_NAME)}
function getPathOf(cmId){return this.idToPathTable$EeO9[cmId]}function addPath(path){if(!this.pathObservers$EeO9[path]){this.pathObservers$EeO9[path]=com.coremedia.personalization.ui.plugin.RepositoryPathObserverManager.getInstance(path,this.documentType$EeO9,this.pollingInterval$EeO9);this.pathObservers$EeO9[path].addListener(com.coremedia.personalization.ui.plugin.RepositoryPathObserver.VALUE_PROPERTY_NAME,AS3.bind(this,"onObservedFolderContentsChanged$EeO9"));this.onObservedFolderContentsChanged$EeO9()}}
function removePath(path){if(this.removePathObserver$EeO9(path))this.onObservedFolderContentsChanged$EeO9()}function removePathObserver(path){var pathObserver=this.pathObservers$EeO9[path];if(pathObserver){pathObserver.removeListener(com.coremedia.personalization.ui.plugin.RepositoryPathObserver.VALUE_PROPERTY_NAME,AS3.bind(this,"onObservedFolderContentsChanged$EeO9"),this);com.coremedia.personalization.ui.plugin.RepositoryPathObserverManager.releaseInstance(path,this.documentType$EeO9,this.pollingInterval$EeO9);
this.pathObservers$EeO9[path]=undefined;delete this.pathObservers$EeO9[path];return true}else return false}function clearPaths(){for(var path in this.pathObservers$EeO9)this.removePathObserver$EeO9(path);this.onObservedFolderContentsChanged$EeO9()}function onObservedFolderContentsChanged(){var combinedValues=[];this.idToPathTable$EeO9={};for(var path in this.pathObservers$EeO9)if(this.pathObservers$EeO9[path]){var v=this.pathObservers$EeO9[path].getValue();combinedValues=combinedValues.concat(v);
for(var i=0;i<v.length;++i)this.idToPathTable$EeO9[AS3.as(v[i],com.coremedia.cap.content.Content).getId()]=path}this.folderContents$EeO9.set(MultipleRepositoryPathsObserver.VALUE_PROPERTY_NAME,combinedValues)}return{extend:"Ext.util.Observable",documentType$EeO9:null,pollingInterval$EeO9:0,constructor:MultipleRepositoryPathsObserver$,super$EeO9:function(){Ext.util.Observable.prototype.constructor.apply(this,arguments)},valueChanged$EeO9:valueChanged,getValue:getValue,getPathOf:getPathOf,addPath:addPath,
removePath:removePath,removePathObserver$EeO9:removePathObserver,clearPaths:clearPaths,onObservedFolderContentsChanged$EeO9:onObservedFolderContentsChanged,statics:{VALUE_PROPERTY_NAME:"value"},requires:["Ext","Ext.util.Observable","com.coremedia.cap.content.Content","com.coremedia.cms.editor.sdk.editorContext"],uses:["com.coremedia.personalization.ui.plugin.RepositoryPathObserver","com.coremedia.personalization.ui.plugin.RepositoryPathObserverManager"]}});Ext.define("com.coremedia.personalization.ui.plugin.ContentSelectorBase",function(ContentSelectorBase){function ContentSelectorBase$(config){if(arguments.length<=0)config=null;if(!AS3.getBindable(config,"docType"))throw new AS3.Error("config property 'docType' has to be supplied");this.pathSuffixes$HwXe={};this.internalAddPaths$HwXe(AS3.getBindable(config,"paths"));config.valueField="id";AS3.setBindable(config,"displayField","suffixedName");this.super$HwXe(config);this.addListener("beforedestroy",
AS3.bind(this,"clearPaths"));this.getStore().addListener("add",AS3.bind(this,"resetSelection$HwXe"));this.getStore().addListener("update",AS3.bind(this,"resetSelection$HwXe"));this.getStore().addListener("datachanged",AS3.bind(this,"resetSelection$HwXe"))}function getBindTo(config){return com.coremedia.ui.data.ValueExpressionFactory.create(com.coremedia.personalization.ui.plugin.MultipleRepositoryPathsObserver.VALUE_PROPERTY_NAME,this.getPathsObserver(config))}function resetSelection(){var v=this.getValue();
if(v&&this.getStore().findExact(this.valueField,v)>=0)this.setValue(v)}function internalAddPaths(paths){if(paths){paths=com.coremedia.ui.util.ArrayUtils.asArray(paths);for(var i=0;i<paths.length;++i)this.addPath(paths[i])}}function addSuffixToName(name,content){var suffix=this.pathSuffixes$HwXe[this.pathsObserver$HwXe.getPathOf(content.getId())];return name+(suffix?suffix:"")}function suffixedNameSortType(value){switch(value){case "DEFAULT":return"";default:return Ext.data.SortTypes.asUCString(value)}}
function addPath(path,labelSuffix){if(arguments.length<=1)labelSuffix="";if(!this.pathSuffixes$HwXe[path]){this.pathSuffixes$HwXe[path]=labelSuffix;this.pathsObserver$HwXe.addPath(path)}}function removePath(path){if(this.pathSuffixes$HwXe[path]){this.pathSuffixes$HwXe[path]=undefined;this.pathsObserver$HwXe.removePath(path)}}function clearPaths(){this.pathSuffixes$HwXe={};this.pathsObserver$HwXe.clearPaths()}function getPathsObserver(config){if(arguments.length<=0)config=null;if(!this.pathsObserver$HwXe&&
config)this.pathsObserver$HwXe=new com.coremedia.personalization.ui.plugin.MultipleRepositoryPathsObserver(AS3.getBindable(config,"docType"),AS3.getBindable(config,"pollingInterval"));return this.pathsObserver$HwXe}return{extend:"com.coremedia.ui.components.StatefulComboBox",pathsObserver$HwXe:null,pathSuffixes$HwXe:null,constructor:ContentSelectorBase$,super$HwXe:function(){com.coremedia.ui.components.StatefulComboBox.prototype.constructor.apply(this,arguments)},getBindTo:getBindTo,resetSelection$HwXe:resetSelection,
internalAddPaths$HwXe:internalAddPaths,addSuffixToName:addSuffixToName,suffixedNameSortType:suffixedNameSortType,addPath:addPath,removePath:removePath,clearPaths:clearPaths,getPathsObserver:getPathsObserver,requires:["AS3.Error","Ext.data.SortTypes","com.coremedia.ui.components.StatefulComboBox","com.coremedia.ui.data.ValueExpressionFactory","com.coremedia.ui.util.ArrayUtils"],uses:["com.coremedia.personalization.ui.plugin.MultipleRepositoryPathsObserver"]}});Ext.define("com.coremedia.personalization.ui.plugin.ContentSelector",function(ContentSelector){function ContentSelector$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.ContentSelectorBase,{});var defaults_$1=AS3.cast(ContentSelector,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);var ui_BindListPlugin_36_5_$1=AS3.cast(com.coremedia.ui.plugins.BindListPlugin,{});AS3.setBindable(ui_BindListPlugin_36_5_$1,"bindTo",this.getBindTo(config));
AS3.setBindable(ui_BindListPlugin_36_5_$1,"sortField","suffixedName");var ui_DataField_38_9_$1=AS3.cast(com.coremedia.ui.store.DataField,{});ui_DataField_38_9_$1.name="name";var ui_DataField_39_9_$1=AS3.cast(com.coremedia.ui.store.DataField,{});ui_DataField_39_9_$1.name="id";var ui_DataField_40_9_$1=AS3.cast(com.coremedia.ui.store.DataField,{});ui_DataField_40_9_$1.name="suffixedName";ui_DataField_40_9_$1.mapping="name";ui_DataField_40_9_$1["convert"]=AS3.bind(this,"addSuffixToName");ui_DataField_40_9_$1.sortType=
AS3.bind(this,"suffixedNameSortType");AS3.setBindable(ui_BindListPlugin_36_5_$1,"fields",[ui_DataField_38_9_$1,ui_DataField_39_9_$1,ui_DataField_40_9_$1]);config_$1.plugins=[ui_BindListPlugin_36_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$Ju3t(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.ContentSelectorBase",alias:"widget.com.coremedia.personalization.ui.config.contentSelector",constructor:ContentSelector$,super$Ju3t:function(){com.coremedia.personalization.ui.plugin.ContentSelectorBase.prototype.constructor.apply(this,
arguments)},config:{paths:null,docType:null,pollingInterval:0},requires:["com.coremedia.personalization.ui.plugin.ContentSelectorBase","com.coremedia.ui.plugins.BindListPlugin","com.coremedia.ui.store.DataField","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.plugin.DateTimeContainerBase",function(DateTimeContainerBase){function DateTimeContainerBase$(config){var this$=this;if(arguments.length<=0)config=null;this.super$tpLM(config);this.dateField$tpLM=this.getDateField$tpLM();this.timeField$tpLM=this.getTimeField$tpLM();var path=AS3.getBindable(config,"propertyContext")+"!"+AS3.getBindable(config,"propertyName");this.ppe$tpLM=AS3.getBindable(config,"bindTo").extendBy(path);this.ppe$tpLM.loadValue(function(){this$.date$tpLM=
Ext.Date.parse(this$.ppe$tpLM.getValue(),"Y-m-d\\TH:i:sP");if(this$.date$tpLM==null)this$.date$tpLM=Ext.Date.parse(this$.ppe$tpLM.getValue(),"Y-m-d\\TH:i:sO");if(this$.date$tpLM!=null){this$.dateField$tpLM.setValue(this$.date$tpLM);this$.timeField$tpLM.setValue(this$.date$tpLM)}else this$.setDisabled(true)})}function validateDate(value){if(!value&&AS3.getBindable(this.getTimeField$tpLM(),"value","DUMMY"))return mx.resources.ResourceManager.getInstance().getString("com.coremedia.cms.editor.sdk.validation.Validators",
"Validator_NotEmptyValidator_text");return true}function validateTime(value){if(!value&&AS3.getBindable(this.getDateField$tpLM(),"value","DUMMY"))return mx.resources.ResourceManager.getInstance().getString("com.coremedia.cms.editor.sdk.validation.Validators","Validator_NotEmptyValidator_text");return true}function afterRender(){var this$=this;Ext.form.FieldContainer.prototype.afterRender.call(this);this.dateField$tpLM.addListener("select",function(){this$.modified$tpLM()});this.dateField$tpLM.addListener("change",
function(){this$.modified$tpLM()});this.timeField$tpLM.addListener("keyup",function(){this$.timeField$tpLM.fireEvent("change");this$.modified$tpLM()});this.timeField$tpLM.addListener("change",function(){this$.modified$tpLM()});this.timeField$tpLM.addListener("select",function(){this$.modified$tpLM()})}function getDateField(){return AS3.as(this.queryById(DateTimeContainerBase.dateFieldItemId),com.coremedia.ui.components.StatefulDateField)}function getTimeField(){return AS3.as(this.queryById(DateTimeContainerBase.timeFieldItemId),
com.coremedia.ui.components.StatefulTimeField)}function getPropertyValue(){var d;var t;if(!this.timeField$tpLM.validate()||!this.dateField$tpLM.validate())return null;d=this.dateField$tpLM.getValue();t=this.timeField$tpLM.getValue();d=Ext.Date.add(Ext.Date.add(d,Ext.Date.HOUR,t.getHours()),Ext.Date.MINUTE,t.getMinutes());return Ext.Date.format(d,"Y-m-d\\TH:i:sP")}function modified(){var propertyValue=this.getPropertyValue$tpLM();if(propertyValue!=null)this.ppe$tpLM.setValue(propertyValue)}return{extend:"Ext.form.FieldContainer",
timeField$tpLM:null,dateField$tpLM:null,date$tpLM:null,ppe$tpLM:null,constructor:DateTimeContainerBase$,super$tpLM:function(){Ext.form.FieldContainer.prototype.constructor.apply(this,arguments)},validateDate:validateDate,validateTime:validateTime,afterRender:afterRender,getDateField$tpLM:getDateField,getTimeField$tpLM:getTimeField,getPropertyValue$tpLM:getPropertyValue,modified$tpLM:modified,statics:{dateFieldItemId:"dateTimeContainerDatefield",timeFieldItemId:"dateTimeContainerTimefield"},requires:["Ext.Date",
"Ext.form.FieldContainer","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.components.StatefulDateField","com.coremedia.ui.components.StatefulTimeField","mx.resources.ResourceManager"]}});Ext.define("com.coremedia.personalization.ui.plugin.Disablefortypes",function(Disablefortypes){function Disablefortypes$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.plugin.DisableForTypesPlugin,{});var defaults_$1=AS3.cast(Disablefortypes,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$uvct(config_$1)}return{extend:"com.coremedia.personalization.ui.plugin.DisableForTypesPlugin",
constructor:Disablefortypes$,super$uvct:function(){com.coremedia.personalization.ui.plugin.DisableForTypesPlugin.prototype.constructor.apply(this,arguments)},config:{types:null},requires:["com.coremedia.personalization.ui.plugin.DisableForTypesPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.plugin.DisableForTypesPlugin",function(DisableForTypesPlugin){function disabledTypes_(){this.disabledTypes$$WFA=[]}function DisableForTypesPlugin$(config){disabledTypes_.call(this);if(arguments.length<=0)config=null;this.disabledTypes$$WFA=com.coremedia.ui.util.ArrayUtils.asArray(config["types"])}function isComponentDisabledForType(type){for(var i=0;i<this.disabledTypes$$WFA.length;i++){var disType=this.disabledTypes$$WFA[i];if(type.isSubtypeOf(disType))return true}return false}
function init(component){var this$=this;var valueExpression=com.coremedia.cms.editor.sdk.desktop.WorkArea.ACTIVE_CONTENT_VALUE_EXPRESSION.extendBy("type");var handler=function(){valueExpression.loadValue(function(value){var documentType=AS3.as(value,com.coremedia.cap.content.ContentType);component.setDisabled(this$.isComponentDisabledForType$$WFA(documentType))})};valueExpression.addChangeListener(handler);handler();component.addListener("beforedestroy",function(){valueExpression.removeChangeListener(handler)})}
return{mixins:["ext.Plugin"],constructor:DisableForTypesPlugin$,isComponentDisabledForType$$WFA:isComponentDisabledForType,init:init,requires:["com.coremedia.cap.content.ContentType","com.coremedia.cms.editor.sdk.desktop.WorkArea","com.coremedia.ui.util.ArrayUtils","ext.Plugin"]}});Ext.define("com.coremedia.personalization.ui.plugin.AddPathFromHomeFolderPlugin",function(AddPathFromHomeFolderPlugin){function AddPathFromHomeFolderPlugin$(config){if(arguments.length<=0)config=null;this.pathInHomeFolder$UVmF=config["relativePath"];this.labelSuffix$UVmF=config["labelSuffix"]}function init(component){var this$=this;if(!AS3.is(component,com.coremedia.personalization.ui.plugin.ContentSelector))throw AS3.cast(AS3.Error,"plugin is only applicable to components of type 'TestProfileSelectorBase'");
var testProfileSelector=AS3.as(component,com.coremedia.personalization.ui.plugin.ContentSelector);var homeFolderPathExpr=com.coremedia.ui.data.ValueExpressionFactory.create("homeFolder.path",com.coremedia.cap.common.SESSION.getUser());homeFolderPathExpr.loadValue(function(path){var personaPath=path+"/"+this$.pathInHomeFolder$UVmF;testProfileSelector.addPath(personaPath,this$.labelSuffix$UVmF)})}return{mixins:["ext.Plugin"],pathInHomeFolder$UVmF:null,labelSuffix$UVmF:null,constructor:AddPathFromHomeFolderPlugin$,
init:init,requires:["AS3.Error","com.coremedia.cap.common.SESSION","com.coremedia.ui.data.ValueExpressionFactory","ext.Plugin"],uses:["com.coremedia.personalization.ui.plugin.ContentSelector"]}});Ext.define("com.coremedia.personalization.ui.plugin.AddPathPlugin",function(AddPathPlugin){function AddPathPlugin$(config){if(arguments.length<=0)config=null;this.pathToAdd$mE1u=AS3.getBindable(config,"path");this.labelSuffix$mE1u=AS3.getBindable(config,"labelSuffix")}function init(component){if(!AS3.is(component,com.coremedia.personalization.ui.plugin.ContentSelector)&&!AS3.is(component,com.coremedia.personalization.ui.condition.SegmentCondition))throw AS3.cast(AS3.Error,"plugin is only applicable to components of type 'ContentSelector' or 'SegmentCondition'");
component["addPath"](this.pathToAdd$mE1u,this.labelSuffix$mE1u||"")}return{mixins:["ext.Plugin"],pathToAdd$mE1u:null,labelSuffix$mE1u:null,constructor:AddPathPlugin$,init:init,requires:["AS3.Error","ext.Plugin"],uses:["com.coremedia.personalization.ui.condition.SegmentCondition","com.coremedia.personalization.ui.plugin.ContentSelector"]}});Ext.define("com.coremedia.personalization.ui.plugin.Activatetestcontextonselect",function(Activatetestcontextonselect){function Activatetestcontextonselect$(config){this.super$hLga();if(arguments.length<=0)config=null}return{extend:"com.coremedia.personalization.ui.plugin.ActivateTestContextOnSelectPlugin",constructor:Activatetestcontextonselect$,super$hLga:function(){com.coremedia.personalization.ui.plugin.ActivateTestContextOnSelectPlugin.prototype.constructor.apply(this,arguments)},requires:["com.coremedia.personalization.ui.plugin.ActivateTestContextOnSelectPlugin"]}});Ext.define("com.coremedia.personalization.ui.plugin.ActivateTestContextOnSelectPlugin",function(ActivateTestContextOnSelectPlugin){function init(component){var this$=this;var box=AS3.as(component,Ext.form.field.ComboBox);if(!box)throw AS3.cast(AS3.Error,"plugin is applicable only to components of type ComboBox");var preview=AS3.as(box.findParentByType(com.coremedia.cms.editor.sdk.preview.PreviewPanel.xtype),com.coremedia.cms.editor.sdk.preview.PreviewPanelBase);if(!preview)throw new AS3.Error("plugin can only be applied to a component that has a PreviewPanel as its parent");
box.addListener("select",function(){this$.activateTestContext$rVht(box.getValue(),preview)});this.activateTestContext$rVht(box.getValue(),preview)}function activateTestContext(cmId,previewPanel){if(cmId){var params=previewPanel.getUrlParameterBean();params.set("p13n_test","true");params.set("p13n_testcontext",com.coremedia.ui.util.IdUtil.parseContentId(cmId))}}function ActivateTestContextOnSelectPlugin$(){}return{mixins:["ext.Plugin"],init:init,activateTestContext$rVht:activateTestContext,constructor:ActivateTestContextOnSelectPlugin$,
requires:["AS3.Error","Ext.form.field.ComboBox","com.coremedia.cms.editor.sdk.preview.PreviewPanel","com.coremedia.cms.editor.sdk.preview.PreviewPanelBase","com.coremedia.ui.util.IdUtil","ext.Plugin"]}});Ext.define("com.coremedia.personalization.ui.plugin.RepositoryPathObserver",function(RepositoryPathObserver){var intervalHandles$static;function intervalHandles$static_(){intervalHandles$static={}}function static$0(){com.coremedia.cms.editor.sdk.editorContext.getRemoteErrorRegistry().registerErrorHandler(function(error,source){if(error.status===403||error.status===500){if(joo.debug)AS3.trace("[ERROR] handling error "+error+" raised by "+source);for(var key in intervalHandles$static)intervalHandles$static[key].destroy()}})}
function RepositoryPathObserver$(path,contentType,pollingInterval){var this$=this;this.super$0jmc();this.folderContents$0jmc=com.coremedia.cms.editor.sdk.editorContext.getBeanFactory().createLocalBean({value:[]});this.folderContents$0jmc.addPropertyChangeListener(RepositoryPathObserver.VALUE_PROPERTY_NAME,AS3.bind(this,"valueChanged$0jmc"));com.coremedia.cap.common.SESSION.getConnection().getContentRepository().getChild(path,function observeFolder(c,absolutePath,error){if(this$.folder$0jmc==null&&
c!=null){this$.folder$0jmc=c;if(joo.debug)AS3.trace("[INFO] starting to observe CMS folder at '"+this$.folder$0jmc.getPath()+"'");var searchParams=AS3.cast(com.coremedia.cap.content.search.SearchParameters,{});searchParams.folder=this$.folder$0jmc.getUriPath();searchParams["includeSubfolders"]=false;searchParams.contentType=[contentType];searchParams.filterQuery=["isdeleted:false"];var searchService=this$.folder$0jmc.getRepository().getSearchService();var searchFunc=function(){var searchResult=searchService.search(searchParams);
searchResult.load(AS3.bind(this$,"setValue"))};this$.intervalHandle$0jmc=window.setInterval(searchFunc,pollingInterval);this$.registerInstance$0jmc();searchFunc()}if(error&&error.status===403)error.setHandled(true)})}function registerInstance(){intervalHandles$static[this.intervalHandle$0jmc]=this;if(joo.debug)AS3.trace("[INFO] "+RepositoryPathObserver+" intervalHandles: "+intervalHandles$static)}function valueChanged(ev){this.fireEvent(RepositoryPathObserver.VALUE_PROPERTY_NAME,Ext.applyIf({bean:this},
ev))}function setValue(result){this.folderContents$0jmc.set(RepositoryPathObserver.VALUE_PROPERTY_NAME,result.getHits())}function getValue(){return this.folderContents$0jmc.get(RepositoryPathObserver.VALUE_PROPERTY_NAME)}function clearInterval(){if(this.intervalHandle$0jmc){if(joo.debug)AS3.trace("[INFO] unregistering repository path observer for path '"+this.folder$0jmc.getPath()+"'");window.clearInterval(this.intervalHandle$0jmc)}delete intervalHandles$static[this.intervalHandle$0jmc]}return{extend:"Ext.util.Observable",
folderContents$0jmc:null,folder$0jmc:null,intervalHandle$0jmc:null,constructor:RepositoryPathObserver$,super$0jmc:function(){Ext.util.Observable.prototype.constructor.apply(this,arguments)},registerInstance$0jmc:registerInstance,valueChanged$0jmc:valueChanged,setValue:setValue,getValue:getValue,clearInterval:clearInterval,statics:{VALUE_PROPERTY_NAME:"value",intervalHandles:undefined,__initStatics__:function(){intervalHandles$static_();static$0()}},requires:["AS3.trace","Ext","Ext.util.Observable",
"com.coremedia.cap.common.SESSION","com.coremedia.cap.content.search.SearchParameters","com.coremedia.cms.editor.sdk.editorContext"]}});Ext.define("com.coremedia.personalization.ui.SelectionRulesFieldBase",function(SelectionRulesFieldBase){function SelectionRulesFieldBase$(config){if(arguments.length<=0)config=null;this.addConditionItems(AS3.getBindable(config,"conditionItems"));this.super$yGac(config)}function getConditionItems(){if(!this.conditionItems$yGac)this.conditionItems$yGac=[];return this.conditionItems$yGac}function afterRender(){com.coremedia.ui.components.AdvancedFieldContainer.prototype.afterRender.call(this);this.collapseConditionPanels()}
function addConditionItems(items){if(items)for(var i=0;i<items.length;i++)this.getConditionItems().push(items[i])}function collapseConditionPanels(){var panels=this.query(com.coremedia.ui.util.createComponentSelector()._xtype(com.coremedia.personalization.ui.editors.RulePanel.xtype).build());Ext.each(panels,function(p){p.collapseConditionsPanel()},null);this.toggleButtons$yGac(true)}function expandConditionPanels(){var panels=this.query(com.coremedia.ui.util.createComponentSelector()._xtype(com.coremedia.personalization.ui.editors.RulePanel.xtype).build());
Ext.each(panels,function(p){p.expandConditionsPanel()},null);this.toggleButtons$yGac(false)}function initializedAndRendered(value){this["setValue"]=function(){if(joo.debug)AS3.trace('[INFO] setValue is not supported after initialization (Blob is only observed to hide "loadingInfo" panel)',SelectionRulesFieldBase)};this["getValue"]=function(){if(joo.debug)AS3.trace('[INFO] getValue is not supported after initialization (Blob is only observed to hide "loadingInfo" panel)',SelectionRulesFieldBase)};
var array=this.query(com.coremedia.ui.util.createComponentSelector().itemId("loadingInfo").build());if(array.length==1)array[0].hide();else if(joo.debug)AS3.trace("[WARN]: unexpected number of 'loadingInfo' components found",array.length);var rules=com.coremedia.personalization.ui.util.RuleXMLCoDec.rulesFromXML(value);var array2=this.query(com.coremedia.ui.util.createComponentSelector().itemId("ruleListDropBox").build());if(array2.length==1){var comp=array2[0];comp.setVisible(!rules||com.coremedia.personalization.ui.util.SelectionRuleHelper.isValidRuleList(rules))}else if(joo.debug)AS3.trace("[WARN]: unexpected number of 'ruleListDropBox' components found",
array2.length)}function getValue(){var componentId=this.getId();if(joo.debug)AS3.trace(componentId,"doesn't support #getValue");return componentId}function setValue(value){var this$=this;if(this.rendered)this.initializedAndRendered$yGac(value);else{var handler=function(){this$.removeListener("afterrender",handler);this$.initializedAndRendered$yGac(value)};this.addListener("afterrender",handler)}}function toggleButtons(expandVisible){this.getExpandAllButton$yGac().setVisible(expandVisible);this.getCollapseAllButton$yGac().setVisible(!expandVisible)}
function getExpandAllButton(){if(!this.expandButton$yGac)this.expandButton$yGac=AS3.as(this.queryById(SelectionRulesFieldBase.EXPAND_ALL_BUTTON_ITEM_ID),Ext.button.Button);return this.expandButton$yGac}function getCollapseAllButton(){if(!this.collapseButton$yGac)this.collapseButton$yGac=AS3.as(this.queryById(SelectionRulesFieldBase.COLLAPSE_ALL_BUTTON_ITEM_ID),Ext.button.Button);return this.collapseButton$yGac}return{extend:"com.coremedia.ui.components.AdvancedFieldContainer",conditionItems$yGac:null,
expandButton$yGac:null,collapseButton$yGac:null,constructor:SelectionRulesFieldBase$,super$yGac:function(){com.coremedia.ui.components.AdvancedFieldContainer.prototype.constructor.apply(this,arguments)},getConditionItems:getConditionItems,afterRender:afterRender,addConditionItems:addConditionItems,collapseConditionPanels:collapseConditionPanels,expandConditionPanels:expandConditionPanels,initializedAndRendered$yGac:initializedAndRendered,getValue:getValue,setValue:setValue,toggleButtons$yGac:toggleButtons,
getExpandAllButton$yGac:getExpandAllButton,getCollapseAllButton$yGac:getCollapseAllButton,statics:{EXPAND_ALL_BUTTON_ITEM_ID:"expandAllButton",COLLAPSE_ALL_BUTTON_ITEM_ID:"collapseAllButton"},requires:["AS3.trace","Ext","Ext.button.Button","com.coremedia.ui.components.AdvancedFieldContainer","com.coremedia.ui.util.createComponentSelector"],uses:["com.coremedia.personalization.ui.editors.RulePanel","com.coremedia.personalization.ui.util.RuleXMLCoDec","com.coremedia.personalization.ui.util.SelectionRuleHelper"]}});Ext.define("com.coremedia.personalization.ui.SearchQueryHelperWindow",function(SearchQueryHelperWindow){function SearchQueryHelperWindow$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.ui.components.HelperWindow,{});var defaults_$1=AS3.cast(SearchQueryHelperWindow,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"title",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_searchQueryHelper_window_title"));
AS3.setBindable(config_$1,"helpTextUrl",net.jangaroo.ext.Exml.asString(Ext.manifest.globalResources[this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_searchQueryHelper_window_html_content_key")]));var button_26_5_$1=AS3.cast(Ext.button.Button,{});button_26_5_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.FOOTER_SECONDARY.getSkin());AS3.setBindable(button_26_5_$1,"scale","small");AS3.setBindable(button_26_5_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization",
"p13n_dialog_defaultCloseButton_text")));AS3.setBindable(button_26_5_$1,"handler",AS3.bind(this,"close"));config_$1.buttons=[button_26_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$Eg8a(config_$1)}return{extend:"com.coremedia.ui.components.HelperWindow",alias:"widget.com.coremedia.personalization.ui.config.searchQueryHelperWindow",constructor:SearchQueryHelperWindow$,super$Eg8a:function(){com.coremedia.ui.components.HelperWindow.prototype.constructor.apply(this,arguments)},requires:["Ext",
"Ext.button.Button","com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.components.HelperWindow","com.coremedia.ui.skins.ButtonSkin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.DateFieldBaseBase",function(DateFieldBaseBase){function DateFieldBaseBase$(config){var this$=this;if(arguments.length<=0)config=null;this.super$axYK(config);this.addListener("select",function(){this$.fireEvent("change")});this.addListener("valid",function(){this$.fireEvent("change")})}return{extend:"com.coremedia.ui.components.StatefulDateField",constructor:DateFieldBaseBase$,super$axYK:function(){com.coremedia.ui.components.StatefulDateField.prototype.constructor.apply(this,
arguments)},requires:["com.coremedia.ui.components.StatefulDateField"]}});Ext.define("com.coremedia.personalization.ui.SearchQueryHelper",function(SearchQueryHelper){function SearchQueryHelper$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(Ext.container.Container,{});var defaults_$1=AS3.cast(SearchQueryHelper,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"layout","column");var button_33_5_$1=AS3.cast(Ext.button.Button,{});button_33_5_$1.itemId="btnHelp";button_33_5_$1.ui=net.jangaroo.ext.Exml.asString(com.coremedia.ui.skins.ButtonSkin.SIMPLE.getSkin());
AS3.setBindable(button_33_5_$1,"text",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_searchQueryHelper_button_text")));button_33_5_$1.ariaLabel=net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_searchQueryHelper_button_text"));AS3.setBindable(button_33_5_$1,"iconCls",net.jangaroo.ext.Exml.asString(this.resourceManager.getString("com.coremedia.icons.CoreIcons",
"help")));var editor_OpenReferenceWindowAction_39_9_$1=AS3.cast(com.coremedia.cms.editor.sdk.actions.OpenReferenceWindowAction,{});var perso_SearchQueryHelperWindow_41_13_$1=AS3.cast(com.coremedia.personalization.ui.SearchQueryHelperWindow,{});AS3.setBindable(editor_OpenReferenceWindowAction_39_9_$1,"dialog",perso_SearchQueryHelperWindow_41_13_$1);button_33_5_$1.baseAction=new com.coremedia.cms.editor.sdk.actions.OpenReferenceWindowAction(editor_OpenReferenceWindowAction_39_9_$1);config_$1.items=
[button_33_5_$1];net.jangaroo.ext.Exml.apply(config_$1,config);this.super$Q$aK(config_$1)}return{extend:"Ext.container.Container",alias:"widget.com.coremedia.personalization.ui.config.searchQueryHelper",constructor:SearchQueryHelper$,super$Q$aK:function(){Ext.container.Container.prototype.constructor.apply(this,arguments)},config:{clickHandler:null},requires:["Ext.button.Button","Ext.container.Container","com.coremedia.cms.editor.sdk.actions.OpenReferenceWindowAction","com.coremedia.icons.CoreIcons_properties",
"com.coremedia.personalization.ui.Personalization_properties","com.coremedia.ui.skins.ButtonSkin","net.jangaroo.ext.Exml"],uses:["com.coremedia.personalization.ui.SearchQueryHelperWindow"]}});Ext.define("com.coremedia.personalization.ui.ConditionsField",function(ConditionsField){function ConditionsField$(config){if(arguments.length<=0)config=null;var config_$1=AS3.cast(com.coremedia.personalization.ui.editors.ConditionsEditorBase,{});var defaults_$1=AS3.cast(ConditionsField,{});config=net.jangaroo.ext.Exml.apply(defaults_$1,config);AS3.setBindable(config_$1,"conditionItems",AS3.getBindable(config,"conditionItems"));var editor_SetPropertyLabelPlugin_44_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.plugins.SetPropertyLabelPlugin,
{});editor_SetPropertyLabelPlugin_44_5_$1.bindTo=AS3.getBindable(config,"bindTo");AS3.setBindable(editor_SetPropertyLabelPlugin_44_5_$1,"propertyName",net.jangaroo.ext.Exml.asString(AS3.getBindable(config,"propertyName")));var editor_BindDisablePlugin_46_5_$1=AS3.cast(com.coremedia.cms.editor.sdk.premular.fields.plugins.BindDisablePlugin,{});editor_BindDisablePlugin_46_5_$1.bindTo=AS3.getBindable(config,"bindTo");var ui_BindBlobPropertyPlugin_47_5_$1=AS3.cast(com.coremedia.ui.plugins.BindBlobPropertyPlugin,
{});ui_BindBlobPropertyPlugin_47_5_$1.bindTo=AS3.getBindable(config,"bindTo").extendBy("properties",AS3.getBindable(config,"propertyName"));config_$1.plugins=[editor_SetPropertyLabelPlugin_44_5_$1,editor_BindDisablePlugin_46_5_$1,ui_BindBlobPropertyPlugin_47_5_$1];var panel_50_5_$1=AS3.cast(Ext.panel.Panel,{});panel_50_5_$1.itemId="loadingInfo";AS3.setBindable(panel_50_5_$1,"layout","anchor");panel_50_5_$1.hideMode="display";var displayField_54_9_$1=AS3.cast(Ext.form.field.Display,{});AS3.setBindable(displayField_54_9_$1,
"value",this.resourceManager.getString("com.coremedia.personalization.ui.Personalization","p13n_loadingInfo"));panel_50_5_$1.items=[displayField_54_9_$1];config_$1.items=[panel_50_5_$1];var layout_Anchor_60_5_$1=AS3.cast(Ext.layout.container.Anchor,{});layout_Anchor_60_5_$1.anchor="100%";AS3.setBindable(config_$1,"layout",layout_Anchor_60_5_$1);net.jangaroo.ext.Exml.apply(config_$1,config);this.super$MtVe(config_$1)}return{extend:"com.coremedia.personalization.ui.editors.ConditionsEditorBase",alias:"widget.com.coremedia.personalization.ui.config.conditionsField",
constructor:ConditionsField$,super$MtVe:function(){com.coremedia.personalization.ui.editors.ConditionsEditorBase.prototype.constructor.apply(this,arguments)},config:{bindTo:null,propertyName:null,conditionItems:null},requires:["Ext.form.field.Display","Ext.layout.container.Anchor","Ext.panel.Panel","com.coremedia.cms.editor.sdk.premular.fields.plugins.BindDisablePlugin","com.coremedia.cms.editor.sdk.premular.fields.plugins.SetPropertyLabelPlugin","com.coremedia.personalization.ui.Personalization_properties",
"com.coremedia.personalization.ui.editors.ConditionsEditorBase","com.coremedia.ui.plugins.BindBlobPropertyPlugin","net.jangaroo.ext.Exml"]}});Ext.define("com.coremedia.personalization.ui.PersonalizationContextNames_properties",{},function(){com.coremedia.personalization.ui.PersonalizationContextNames_properties.INSTANCE=new com.coremedia.personalization.ui.PersonalizationContextNames_properties});Ext.define("com.coremedia.personalization.ui.Personalization_properties",{requires:["com.coremedia.icons.CoreIcons_properties"],"p13n_date_format":"m/d/Y","p13n_time_format":"g:i A","p13n_hour_format":"g","p13n_date_time_format":"m/d/Y g:i A","p13n_confirm_yes":"Yes","p13n_confirm_no":"No","p13n_conditions_and":"and","p13n_conditions_or":"or","p13n_conditions_conjunction_and":"and","p13n_conditions_conjunction_or":"or","p13n_addCondition":"Add Condition","p13n_deleteCondition_tooltip":"Delete the condition",
"p13n_selectionRuleList_description":"Content selected by matching conditions","p13n_newRule":"Add New Rule","p13n_save":"Save","p13n_deleteRule":"Delete This Rule","p13n_confirmDeleteRule":"Do you really want to delete this rule?","p13n_ruleDragDrop_tooltip":"Drag and drop this rule","p13n_selectContent_tooltip":"Select content for this rule","p13n_moveRuleUp_tooltip":"Move this rule upwards","p13n_moveRuleDown_tooltip":"Move this rule downwards","p13n_noRulesAvailable":"You haven't defined any conditions yet",
"p13n_emptyContent":"Please select a content","p13n_dropZone":"Drag a content item here from the Library.","p13n_loadingInfo":"Loading data...","p13n_expandAllButton":"Show All Conditions","p13n_collapseAllButton":"Hide All Conditions","p13n_op_less":"less","p13n_op_less_equal":"less or equal","p13n_op_equal":"equal","p13n_op_not_equal":"not equal","p13n_op_greater_equal":"greater or equal","p13n_op_greater":"greater","p13n_op_contains":"contains","p13n_op_contains_not":"contains not","p13n_op_time_less":"before",
"p13n_op_time_equal":"at","p13n_op_date_time_equal":"on","p13n_op_time_greater":"after","p13n_op_invalid":"Please choose a valid operator","p13n_op_segment_is":"is","p13n_op_segment_is_not":"is not","p13n_op_keyword":"Keyword","p13n_op_operator":"Operator","p13n_op_value":"Value","p13n_op_booleanProperties_is":"is","p13n_op_booleanProperties_isnot":"is not","p13n_Action_deleteContentFromRule_text":"remove","p13n_Action_deleteContentFromRule_tooltip":"Clear the rule's content slot","p13n_ruleContentField_emptyText":"Drag a content item here from the Library.",
"p13n_rulePanel_collapse":"Hide Conditions","p13n_rulePanel_expand":"Show Conditions","p13n_rulePanel_deleteRule":"Delete This Rule","p13n_profileDebugger_title":"Context Information","p13n_profileDebugger_nodata":"no context data available","p13n_profileDebugger_property_title":"Property","p13n_profileDebugger_value_title":"Value","p13n_searchQueryHelper_button_text":"Display Search Query Help","p13n_searchQueryHelper_window_title":"Search Query Help","p13n_searchQueryHelper_mouseover_text":'Here you can perform a personalized search query. The search query can be stated by standard search parameter (e.g. "keyword:sport") as well as by personalized search function (e.g. containsKeywords()). Search combinations with operators like "AND/"OR" or bracketing are possible\x3cbr\x3e\x3cb\x3eFor further information please click the link with help text below the search query field\x3c/b\x3e',
"p13n_searchQueryHelper_window_html_content_key":"p13n_searchQueryHelper-help-en","p13n_dialog_defaultCloseButton_text":"Close","p13n_warning_invalid_properties":"WARNING: invalid property prefix","p13n_warning_invalid_properties_expected":"expected","p13n_warning_invalid_removed":"Cannot find segment","p13n_invalidConditions":"Invalid Conditions","p13n_invalidConditions_help":"Some Conditions contain invalid or missing data, please make sure that you've filled in all fields of each condition.","p13n_ruleParsingError":"The selected rule can't be properly represented. You can use the editor to modify it.",
"p13n_rulePropertyMissing":"There is no property for storing rules in the document you've selected.","p13n_error_beanValueExpression":"requires config.bindTo to be set to reference the bean containing the rules to be edited","p13n_error_propertyName":"requires config.propertyName to be set to the name of the property (without the 'properties.' prefix) containing the rules to be edited","p13n_error_conditionItems":"requires config.conditionItems to be supplied","p13n_error_percentage_value":"Invalid value. Please provide a numeric value between 0 and 100.",
"p13n_error_keywordText":"Invalid keyword. Please use only alphanumeric characters.","p13n_error_valueText":"Invalid value. Please provide a number.","p13n_error_valueText_int":"Invalid value. Please provide a integer number.","p13n_error_propertyPrefix":"config.propertyPrefix must not be null","p13n_error_EnumCondition_configValue":"supplied config.value must not be null","p13n_error_EnumCondition_validValue":"Please choose a valid value.","p13n_error_booleanProperties_validValue":"Please choose a valid value.",
"p13n_error_ConditionSwitch_editor":"No suitable condition-editor found.","p13n_error_ConditionSwitch_property":"No suitable editor found for property.","p13n_error_ConditionsPanel_item":"ConditionsPanel requires conditionItems to be supplied.","p13n_error_ConditionsPanel_dirtyFlag":"ConditionsPanel requires dirtyFlagExpr to be supplied.","p13n_error_ConditionFrame_item":"supplied conditionItems must not be null or empty.","p13n_error_ConditionsFrame_dirtyFlag":"supplied dirtyFlagExpr must not be null.",
"p13n_error_ConditionsFrame_confInstance":"cannot create object instances from configuration.","p13n_error_ConditionsFrame_confInstance_xtype":"Is the xtype property correct?","p13n_error_ConditionsFrame_itemConditionName":"itemConditionName property is required in","p13n_error_ConditionsFrame_itemPropertyPrefix":"either itemConditionPattern or itemConditionProperty is required in","p13n_persona_popup_open_menu_button":"Open Persona Menu","p13n_persona_error_screen_label":"Context-Error","p13n_persona_error_screen_text":"The context data cannot be display due to syntactic error. You can use the textfield below to edit the data.",
"p13n_persona_selector_nothing_selected_label":"No Persona","p13n_persona_selector_close_button_text":"Close","p13n_persona_selector_close_button_tooltip":"Close the persona selector","p13n_persona_selector_open_info_button_tooltip":"Open persona info for {0}","p13n_persona_selector_group_button_tooltip":"Show {0} persona in Library","p13n_persona_popup_info_tab_label":"Overview","p13n_persona_popup_settings_tab_label":"Details","p13n_persona_popup_age":"Age {0}","p13n_persona_popup_implicit_interest_label":"Implicit Interests",
"p13n_persona_popup_explicit_interest_label":"Explicit Interests","p13n_persona_popup_empty_age":"Age undefined","p13n_persona_popup_empty_implicit":"Implicit interests undefined","p13n_persona_popup_empty_explicit":"Explicit interests undefined","p13n_persona_popup_empty_location":"Location undefined","p13n_persona_popup_grid_grouping_title":"Category","p13n_persona_popup_grid_nodata":"No context data available","p13n_persona_popup_grid_property_title":"Property","p13n_persona_popup_grid_value_title":"Value",
"p13n_persona_popup_edit_button_text":"Open in Tab","p13n_persona_popup_use_in_preview_button_text":"Activate Persona","p13n_persona_popup_active_tooltip":"This Persona is currently active","p13n_persona_popup_inactive_tooltip":"This Persona is currently inactive"},function(){this.prototype["p13n_conditions_and_icon"]=com.coremedia.icons.CoreIcons_properties.INSTANCE.add_special_size;this.prototype["p13n_conditions_or_icon"]=com.coremedia.icons.CoreIcons_properties.INSTANCE.add_special_size;this.prototype["p13n_deleteCondition_icon"]=
com.coremedia.icons.CoreIcons_properties.INSTANCE.remove;this.prototype["p13n_dropZone_icon"]=com.coremedia.icons.CoreIcons_properties.INSTANCE.create_content;this.prototype["p13n_Action_deleteContentFromRule_icon"]=com.coremedia.icons.CoreIcons_properties.INSTANCE.remove;com.coremedia.personalization.ui.Personalization_properties.INSTANCE=new com.coremedia.personalization.ui.Personalization_properties});
//# sourceMappingURL=com.coremedia.personalization__cap-personalization-ui.js.map
